webpackJsonp([1],{"1/mu":function(t,e){},"1/oy":function(t,e){},"1Z70":function(t,e){},"2/BE":function(t,e){},"2BCl":function(t,e){},"2OQm":function(t,e){},"2w18":function(t,e){},"90jw":function(t,e){},"9M+g":function(t,e){},BWj6:function(t,e){},CLg2:function(t,e){},EWIx:function(t,e){},GfHa:function(t,e){},GqpO:function(t,e){},Gv4G:function(t,e){},Id91:function(t,e){},Jmt5:function(t,e){},MdlM:function(t,e){},MobZ:function(t,e){},NHnr:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=o("7+uW"),r={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var n=o("VU/8")({name:"App"},r,!1,function(t){o("o8nZ")},null,null).exports,i=o("/ocq"),s=o("Dd8w"),c=o.n(s),l={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("b-navbar",{attrs:{toggleable:"md",type:"dark",variant:"info"}},[o("b-navbar-toggle",{attrs:{target:"nav_collapse"}}),t._v(" "),o("b-navbar-brand",{attrs:{href:"#"}},[t._v("NavBar")]),t._v(" "),o("b-collapse",{attrs:{"is-nav":"",id:"nav_collapse"}},[o("b-navbar-nav",[o("b-nav-item",{attrs:{href:"#"}},[t._v("Inicio")]),t._v(" "),o("b-nav-item",{attrs:{href:"#",disabled:""}},[t._v("Disabled")]),t._v(" "),o("b-nav-item-dropdown",{attrs:{text:"Lang",right:""}},[o("b-dropdown-item",{attrs:{href:"#"}},[t._v("EN")]),t._v(" "),o("b-dropdown-item",{attrs:{href:"#"}},[t._v("ES")]),t._v(" "),o("b-dropdown-item",{attrs:{href:"#"}},[t._v("RU")]),t._v(" "),o("b-dropdown-item",{attrs:{href:"#"}},[t._v("FA")])],1)],1),t._v(" "),o("b-navbar-nav",{staticClass:"ml-auto"},[o("b-nav-item-dropdown",{attrs:{right:""}},[o("template",{slot:"button-content"},[o("em",[t._v("User")])]),t._v(" "),o("b-dropdown-item",{attrs:{href:"#"}},[t._v("Profile")]),t._v(" "),o("b-dropdown-item",{attrs:{href:"#"}},[t._v("Signout")])],2)],1)],1)],1)},staticRenderFns:[]};var u=o("VU/8")({},l,!1,function(t){o("2w18")},null,null).exports,d=o("NYxO"),p=o("UdTa"),v=o.n(p),m=o("bOdI"),f=o.n(m),h={data:function(){return f()({API:v.a.API,show:!1,categoria:{}},"show",!1)},props:["showButton","cbGuardar"],methods:{guardarCategoria:function(){var t=this;this.categoria.ProductoCategoria&&(this.categoria.ProductoCategoria=this.categoria.ProductoCategoria.toUpperCase(),this.axios.post(this.API+"categorias",this.categoria).then(function(e){t.$toasted.show("Categoría guardada correctamente"),t.cbGuardar&&t.cbGuardar({IdProductoCategoria:e.data.insertId,ProductoCategoria:e.data.ProductoCategoria}),t.categoria.ProductoCategoria=""}).catch(function(e){console.log(e),t.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")}))}}},b={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[t.showButton?o("b-btn",{attrs:{id:"popoverCategoriaForm",variant:"primary"}},[o("b",[t._v("+")])]):t._e(),t._v(" "),o("b-popover",{ref:"popover",attrs:{target:"popoverCategoriaForm",triggers:"focus",title:"Nueva Categoría"}},[o("b-form-group",[o("label",[t._v("Categoria:")]),t._v(" "),o("b-form-input",{staticClass:"upper",attrs:{type:"text",value:""},nativeOn:{keydown:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.guardarCategoria(e):null}},model:{value:t.categoria.ProductoCategoria,callback:function(e){t.$set(t.categoria,"ProductoCategoria",e)},expression:"categoria.ProductoCategoria"}})],1),t._v(" "),o("b-btn",{attrs:{size:"sm",variant:"success"},on:{click:t.guardarCategoria}},[t._v("Guardar")])],1)],1)},staticRenderFns:[]};var _={data:function(){return f()({API:v.a.API,show:!1,marca:{}},"show",!1)},props:["showButton","cbGuardar"],methods:{guardarMarca:function(){var t=this;this.marca.ProductoMarca&&(this.marca.ProductoMarca=this.marca.ProductoMarca.toUpperCase(),this.axios.post(this.API+"marcas",this.marca).then(function(e){t.$toasted.show("Marca guardada correctamente"),t.cbGuardar&&t.cbGuardar({IdProductoMarca:e.data.insertId,ProductoMarca:e.data.ProductoMarca}),t.marca.ProductoMarca=""}).catch(function(e){console.log(e),t.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")}))}}},g={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[t.showButton?o("b-btn",{attrs:{id:"popoverMarcaForm",variant:"primary"}},[o("b",[t._v("+")])]):t._e(),t._v(" "),o("b-popover",{ref:"popover",attrs:{target:"popoverMarcaForm",triggers:"focus",title:"Nueva Marca"}},[o("b-form-group",[o("label",[t._v("Marca:")]),t._v(" "),o("b-form-input",{staticClass:"upper",attrs:{type:"text",value:""},nativeOn:{keydown:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.guardarMarca(e):null}},model:{value:t.marca.ProductoMarca,callback:function(e){t.$set(t.marca,"ProductoMarca",e)},expression:"marca.ProductoMarca"}})],1),t._v(" "),o("b-btn",{attrs:{size:"sm",variant:"success"},on:{click:t.guardarMarca}},[t._v("Guardar")])],1)],1)},staticRenderFns:[]};var P={mounted:function(){this.getProductosDet()},data:function(){return{show:!1,API:v.a.API,productos:[]}},props:["idProducto"],methods:{emitUpdate:function(){this.$emit("onUpdateProductos",this.productos)},getProductosDet:function(){var t=this;this.idProducto&&this.axios.get(this.API+"productosdet",{params:{idProducto:this.idProducto}}).then(function(e){t.productos=e.data}).catch(function(t){console.log(t)})},renderChild:function(t){return"\n        <b>"+t.IdProducto+" - "+t.Producto+" - "+t.CodigoBarra+"</b>\n      "},addProducto:function(t){var e=this;this.productos.findIndex(function(e){return e.IdProductoDet==t.IdProducto})>=0?this.$toasted.show("El producto ya está agregado"):this.idProducto!=t.IdProducto?this.axios.get(this.API+"productos/espadre",{params:{idProducto:t.IdProducto}}).then(function(o){o.data.esPadre?e.$toasted.show("No puede agregar un producto padre"):(t.IdProductoDet=t.IdProducto,e.productos.push(t),e.emitUpdate())}):this.$toasted.show("No puede agregar el mismo producto que esta editando")},quitarProducto:function(t){var e=this.productos.findIndex(function(e){return e.IdProductoDet==t.IdProductoDet});this.productos.splice(e,1),this.emitUpdate()},focusAutocomplete:function(t){this.$refs[t].handleDoubleClick()}}},C={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.show?o("div",[o("b-form-group",[o("label",[t._v("Agrega Subproductos:")]),t._v(" "),o("b-input-group",[o("autocomplete",{ref:"inputProducto",attrs:{url:t.API+"productos",anchor:"Producto",onShouldRenderChild:t.renderChild,label:"writer",placeholder:"Seleccionar Producto","on-select":t.addProducto,onFocus:t.focusAutocomplete.bind(null,"inputProducto"),classes:{input:"form-control upper"}}})],1)],1),t._v(" "),o("table",{staticClass:"table b-table table-sm"},[t._m(0),t._v(" "),o("tbody",t._l(t.productos,function(e,a){return o("tr",{key:a},[o("td",[t._v(t._s(e.IdProductoDet))]),t._v(" "),o("td",[t._v(t._s(e.Producto))]),t._v(" "),o("td",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.Cantidad,expression:"prod.Cantidad"}],staticClass:"form-control",attrs:{type:"number",requiredv:""},domProps:{value:e.Cantidad},on:{input:[function(o){o.target.composing||t.$set(e,"Cantidad",o.target.value)},t.emitUpdate]}})]),t._v(" "),o("td",{staticClass:"text-center"},[o("b-button",{attrs:{variant:"danger",size:"sm"},on:{click:function(o){t.quitarProducto(e)}}},[t._v("X")])],1)])}))])],1):t._e()},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Id")]),this._v(" "),e("th",[this._v("Producto")]),this._v(" "),e("th",[this._v("Cantidad")]),this._v(" "),e("th",{staticClass:"text-center"},[this._v("Quitar")])])])}]};var I={data:function(){return{showProductoDet:!0,cantidadCodigoBarra:1,title:"Nuevo Producto",API:v.a.API,show:!1,producto:{},productosDet:[],file:""}},beforeMount:function(){this.initForm()},props:["showButton","productoUpdate","cbGuardar"],watch:{show:function(t){var e=this,o=this.productoUpdate||{};o.IdProducto?(this.initForm(),this.title="Editar Producto << "+o.CodigoBarra+" >>",this.producto.categoria={IdProductoCategoria:o.IdProductoCategoria,ProductoCategoria:o.ProductoCategoria},this.producto.marca={IdProductoMarca:o.IdProductoMarca,ProductoMarca:o.ProductoMarca},this.producto.medicion={IdProductoMedicion:o.IdProductoMedicion,ProductoMedicion:o.ProductoMedicion},this.$refs.inputCategoria.setValue(o.ProductoCategoria),this.$refs.inputMarca.setValue(o.ProductoMarca),this.$refs.inputMedicion.setValue(o.ProductoMedicion),this.$refs.inputPresentacion.setValue(o.ProductoPresentacion),this.producto.Producto=o.Producto,this.producto.IdProducto=o.IdProducto,this.producto.EsPadre=o.EsPadre,Vue.nextTick(function(){e.$refs.productoDet&&(e.$refs.productoDet.show=parseInt(o.EsPadre))}),this.producto.PorcentajeUtilidad=o.PorcentajeUtilidad,this.producto.PrecioPorMayor=o.PrecioPorMayor,this.producto.StockMinimo=o.StockMinimo,this.producto.CodigoBarra=o.CodigoBarra,this.producto.ProductoPresentacion=o.ProductoPresentacion,this.producto.PrecioCosto=o.PrecioCosto,this.producto.PrecioContado=o.PrecioContado,this.producto.precioConvenio=o.precioConvenio,this.producto.EsHabitacion=o.EsHabitacion,this.producto.Piso=o.Piso,this.producto.ControlaStock=o.ControlaStock,this.producto.Imagen=o.Imagen,o.PreciosPorProducto&&(this.producto.precios=JSON.parse(o.PreciosPorProducto))):(this.title="Nuevo Producto",this.clearForm(),this.$refs.inputCodigoBarra.$el.disabled=!1)}},methods:{handleFileUpload:function(){this.file=this.$refs.file.files[0]},calcularPreciosPaquete:function(t){var e=0,o=0;t.forEach(function(t){t.Cantidad&&(e+=t.PrecioCosto*t.Cantidad,o+=t.PrecioContado*t.Cantidad)}),e=this.$options.filters.redondear(e),o=this.$options.filters.redondear(o),Vue.set(this.producto,"PrecioCosto",e),Vue.set(this.producto,"PrecioContado",o),this.actualizarPorcentajeUtilidad()},eliminarProducto:function(t){var e=this;confirm("¿Esta seguro de Anular este producto?")&&this.axios.post(this.API+"productos/delete",{id:t.IdProducto}).then(function(t){t.data.updated&&(e.$toasted.success("El producto con código "+t.data.IdProducto+" ha sido anulado"),e.cbGuardar&&e.cbGuardar(),e.$refs.productoForm.hide())})},actualizarPrecioContado:function(){var t=this.producto.PrecioCosto/(1-this.producto.PorcentajeUtilidad/100);this.producto.precioContadoNormal=t,this.producto.PrecioContado=this.$options.filters.redondear(t,1)},actualizarPorcentajeUtilidad:function(){var t=this.producto.PrecioContado,e=this.producto.PrecioCosto;this.producto.PorcentajeUtilidad=this.$options.filters.redondear(100*(1-e/t))},setCategoria:function(t){this.producto.categoria=t,this.$refs.inputCategoria.setValue(t.ProductoCategoria)},setMedicion:function(t){this.producto.medicion=t},setMarca:function(t){this.producto.marca=t,this.$refs.inputMarca.setValue(t.ProductoMarca)},clearForm:function(){this.$refs.inputCategoria.setValue(""),this.$refs.inputMarca.setValue(""),this.$refs.inputMedicion.setValue("UNIDAD"),this.$refs.inputPresentacion.setValue(""),this.initForm()},initForm:function(){this.producto={EsPadre:0,Anulado:0,EsHabitacion:0,Piso:1,IdProductoMarca:null,IdProductoMedicion:null,IdProductoCategoria:null,Producto:"",CodigoBarra:"",PorcentajeUtilidad:"",StockMinimo:0,PrecioContado:"",PrecioPorMayor:0,precioConvenio:0,categoria:{},marca:{},medicion:{IdProductoMedicion:6,ProductoMedicion:"UNIDAD"},Imagen:null,precios:[{nombre:"ph",cantidad:0,precio:0},{nombre:"pp",cantidad:0,precio:0},{nombre:"pt",cantidad:0,precio:0},{nombre:"pd",cantidad:0,precio:0}]}},guardarProducto:function(t){var e=this;t.preventDefault(),this.showProductoDet&&(this.producto.productosDet=this.$refs.productoDet.productos),this.axios.post(this.API+"productos",c()({},this.producto,{PreciosPorProducto:this.producto.precios})).then(function(t){if(e.cbGuardar&&e.cbGuardar(t.data.insertId),t.data.error)e.$toasted.show(t.data.error+" - "+t.data.codigoBarra);else{e.$toasted.show("Producto guardado correctamente");var o=new FormData;o.append("imagen",e.file),e.axios({method:"post",url:e.API+"producto/imagen/"+t.data.insertId,data:o,headers:{"Content-Type":"multipart/form-data"}}).then(function(t){}),e.$refs.productoForm.hide()}}).catch(function(t){console.log(t),e.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})},focusAutocomplete:function(t){this.$refs[t].handleDoubleClick()},crearCategoria:function(){var t=this;if(this.$refs.inputCategoria.type){var e={};e.ProductoCategoria=this.$refs.inputCategoria.type.toUpperCase(),this.axios.post(this.API+"categorias",e).then(function(e){t.$toasted.show("Categoría guardada correctamente"),t.setCategoria({IdProductoCategoria:e.data.insertId,ProductoCategoria:e.data.ProductoCategoria})}).catch(function(e){console.log(e),t.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})}},crearMarca:function(){var t=this;if(this.$refs.inputMarca.type){var e={};e.ProductoMarca=this.$refs.inputMarca.type.toUpperCase(),this.axios.post(this.API+"marcas",e).then(function(e){t.$toasted.show("Marca guardada correctamente"),t.setMarca({IdProductoMarca:e.data.insertId,ProductoMarca:e.data.ProductoMarca})}).catch(function(e){console.log(e),t.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})}},crearTalla:function(){var t=this;if(this.$refs.inputTalla.type){var e={};e.ProductoTalla=this.$refs.inputTalla.type.toUpperCase(),this.axios.post(this.API+"tallas",e).then(function(e){t.$toasted.show("Talla guardada correctamente"),t.setTalla({IdProductoTalla:e.data.insertId,ProductoTalla:e.data.ProductoTalla})}).catch(function(e){console.log(e),t.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})}},checkIsHijo:function(t){var e=this;t&&this.producto.IdProducto?this.axios.get(this.API+"productos/eshijo",{params:{idProducto:this.producto.IdProducto}}).then(function(t){t.data.esHijo?(e.$toasted.show("Este producto no puede contener productos ya que es un producto hijo"),e.producto.EsPadre=!1):e.$refs.productoDet.show=parseInt(e.producto.EsPadre)}):this.$refs.productoDet&&(this.$refs.productoDet.show=parseInt(this.producto.EsPadre))}},computed:{},components:{CategoriaForm:o("VU/8")(h,b,!1,function(t){o("XZXq")},null,null).exports,MarcaForm:o("VU/8")(_,g,!1,function(t){o("Gv4G")},null,null).exports,ProductoFormDet:o("VU/8")(P,C,!1,function(t){o("Sxdx")},null,null).exports}},A={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[t.showButton?o("b-btn",{directives:[{name:"b-modal",rawName:"v-b-modal.modalProducto",modifiers:{modalProducto:!0}}],attrs:{variant:"primary"}},[t._v("Nuevo")]):t._e(),t._v(" "),o("b-form",{on:{submit:t.guardarProducto,keydown:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()}}},[o("b-modal",{ref:"productoForm",attrs:{"no-close-on-esc":!0,"no-close-on-backdrop":"",id:"modalProducto",title:t.title,size:"lg"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("b-row",[o("b-col",{attrs:{md:"6"}},[o("b-form-group",[o("label",[t._v("Código barra:")]),t._v(" "),o("b-form-input",{ref:"inputCodigoBarra",staticClass:"form-control upper",attrs:{type:"text"},on:{input:function(e){return t.producto.CodigoBarra=e&&e.toUpperCase()}},model:{value:t.producto.CodigoBarra,callback:function(e){t.$set(t.producto,"CodigoBarra",e)},expression:"producto.CodigoBarra"}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Categoría:")]),t._v(" "),o("b-input-group",[o("autocomplete",{ref:"inputCategoria",attrs:{required:"required",url:t.API+"categorias",anchor:"ProductoCategoria",label:"writer",placeholder:t.producto.categoria.ProductoCategoria,"on-select":t.setCategoria,onFocus:t.focusAutocomplete.bind(null,"inputCategoria"),classes:{input:"form-control upper"}}}),t._v(" "),o("b-input-group-append",[o("b-btn",{attrs:{variant:"primary"},on:{click:t.crearCategoria}},[o("b",[t._v("Guardar")])])],1)],1)],1),t._v(" "),o("b-form-group",[o("label",[t._v("Marca:")]),t._v(" "),o("b-input-group",[o("autocomplete",{ref:"inputMarca",attrs:{required:"required",url:t.API+"marcas",anchor:"ProductoMarca",label:"writer",placeholder:t.producto.marca.ProductoMarca,"on-select":t.setMarca,onFocus:t.focusAutocomplete.bind(null,"inputMarca"),classes:{input:"form-control upper"}},on:{"update:placeholder":function(e){t.$set(t.producto.marca,"ProductoMarca",e)}}}),t._v(" "),o("b-input-group-append",[o("b-btn",{attrs:{variant:"primary"},on:{click:t.crearMarca}},[o("b",[t._v("Guardar")])])],1)],1)],1),t._v(" "),o("b-form-group",[o("label",[t._v("Artículo:")]),t._v(" "),o("b-form-input",{ref:"inputProducto",attrs:{required:"required",type:"text",value:t.producto.Producto},on:{input:function(e){return t.producto.Producto=e&&e.toUpperCase()}},model:{value:t.producto.Producto,callback:function(e){t.$set(t.producto,"Producto",e)},expression:"producto.Producto"}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Presentación:")]),t._v(" "),o("autocomplete",{ref:"inputPresentacion",attrs:{url:t.API+"productos/presentaciones",anchor:"ProductoPresentacion",label:"writer",placeholder:t.producto.ProductoPresentacion,"on-select":function(e){return t.producto.ProductoPresentacion=e.ProductoPresentacion&&e.ProductoPresentacion.toUpperCase()},onInput:function(e){return t.producto.ProductoPresentacion=e&&e.toUpperCase()},onFocus:t.focusAutocomplete.bind(null,"inputPresentacion"),classes:{input:"form-control upper"}},on:{"update:placeholder":function(e){t.$set(t.producto,"ProductoPresentacion",e)}}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Imagen:")]),t._v(" "),o("b-img",{attrs:{src:"/resources/images/productos/"+t.producto.Imagen,fluid:"",alt:""}}),t._v(" "),o("input",{ref:"file",attrs:{type:"file",id:"file"},on:{change:function(e){t.handleFileUpload()}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"6"}},[o("b-form-group",[o("label",[t._v("Medición:")]),t._v(" "),o("autocomplete",{ref:"inputMedicion",attrs:{required:"required",url:t.API+"mediciones",initValue:"UNIDAD",anchor:"ProductoMedicion",label:"writer",placeholder:t.producto.medicion.ProductoMedicion,"on-select":t.setMedicion,onFocus:t.focusAutocomplete.bind(null,"inputMedicion"),classes:{input:"form-control"}},on:{"update:placeholder":function(e){t.$set(t.producto.medicion,"ProductoMedicion",e)}}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Porcentaje Utilidad:")]),t._v(" "),o("b-form-input",{attrs:{required:"required",type:"number",min:"0",step:"0.0001"},nativeOn:{input:function(e){return t.actualizarPrecioContado(e)}},model:{value:t.producto.PorcentajeUtilidad,callback:function(e){t.$set(t.producto,"PorcentajeUtilidad",e)},expression:"producto.PorcentajeUtilidad"}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Precio X Mayor:")]),t._v(" "),o("b-form-input",{attrs:{type:"number",min:"0",step:"0.0001"},model:{value:t.producto.PrecioPorMayor,callback:function(e){t.$set(t.producto,"PrecioPorMayor",e)},expression:"producto.PrecioPorMayor"}})],1),t._v(" "),t.producto.EsPadre?t._e():o("b-form-group",[o("label",[t._v("Stock Minimo:")]),t._v(" "),o("b-form-input",{attrs:{required:"required",type:"number"},model:{value:t.producto.StockMinimo,callback:function(e){t.$set(t.producto,"StockMinimo",e)},expression:"producto.StockMinimo"}})],1),t._v(" "),o("b-form-group",[o("b-form-checkbox",{attrs:{value:1,"unchecked-value":0},model:{value:t.producto.ControlaStock,callback:function(e){t.$set(t.producto,"ControlaStock",e)},expression:"producto.ControlaStock"}},[t._v("\n            Controla Stock\n          ")])],1),t._v(" "),o("b-form-group",[o("label",[t._v("Activar SubProductos:")]),t._v(" "),o("b-form-checkbox",{attrs:{value:1,"unchecked-value":0},on:{input:t.checkIsHijo},model:{value:t.producto.EsPadre,callback:function(e){t.$set(t.producto,"EsPadre",e)},expression:"producto.EsPadre"}},[t._v("\n            Seleccione esta opción si el producto contiene mas productos\n          ")])],1),t._v(" "),o("b-form-group",[o("label",[t._v("Activar Proyecto:")]),t._v(" "),o("b-form-checkbox",{attrs:{value:1,"unchecked-value":0},model:{value:t.producto.EsHabitacion,callback:function(e){t.$set(t.producto,"EsHabitacion",e)},expression:"producto.EsHabitacion"}},[t._v("\n            Seleccione esta opción si es un proyecto\n          ")])],1),t._v(" "),t.producto.EsHabitacion?o("b-form-group",[o("label",[t._v("Lugar:")]),t._v(" "),o("b-form-select",{staticClass:"mb-3",attrs:{required:"required",options:[{value:1,text:"Huánuco"},{value:2,text:"Pucallpa"}]},model:{value:t.producto.Piso,callback:function(e){t.$set(t.producto,"Piso",e)},expression:"producto.Piso"}})],1):t._e()],1)],1),t._v(" "),t.producto.IdProducto||t.producto.EsPadre?o("hr"):t._e(),t._v(" "),t.producto.IdProducto||t.producto.EsPadre?o("b-row",[o("b-col",{attrs:{md:"6"}},[o("b-form-group",[o("label",[t._v("Precio de Costo:")]),t._v(" "),o("b-form-input",{attrs:{readonly:"readonly",type:"number"},model:{value:t.producto.PrecioCosto,callback:function(e){t.$set(t.producto,"PrecioCosto",e)},expression:"producto.PrecioCosto"}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"6"}},[o("b-form-group",[o("label",[t._v("Precio de Venta:")]),t._v(" "),o("b-form-input",{attrs:{type:"number"},nativeOn:{input:function(e){return t.actualizarPorcentajeUtilidad(e)}},model:{value:t.producto.PrecioContado,callback:function(e){t.$set(t.producto,"PrecioContado",e)},expression:"producto.PrecioContado"}}),t._v(" "),t.producto.precioContadoNormal?o("b-form-text",[t._v("\n              Original - "+t._s(t._f("redondear")(t.producto.precioContadoNormal))+"\n            ")]):t._e()],1)],1),t._v(" "),o("b-col",{attrs:{md:"6"}},[o("b-form-group",[o("label",[t._v("Precio Convenio:")]),t._v(" "),o("b-form-input",{attrs:{type:"number"},model:{value:t.producto.precioConvenio,callback:function(e){t.$set(t.producto,"precioConvenio",e)},expression:"producto.precioConvenio"}})],1)],1)],1):t._e(),t._v(" "),o("hr"),t._v(" "),o("b-row",t._l(4,function(e){return o("b-col",{key:e.id,attrs:{md:"3"}},[o("b-card",{staticClass:"text-center",attrs:{"border-variant":"light",header:t.producto.precios[e-1].nombre}},[o("b-form-group",[o("label",[t._v("Cantidad:")]),t._v(" "),o("b-form-input",{attrs:{type:"number"},model:{value:t.producto.precios[e-1].cantidad,callback:function(o){t.$set(t.producto.precios[e-1],"cantidad",o)},expression:"producto.precios[i-1].cantidad"}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Precio:")]),t._v(" "),o("b-form-input",{attrs:{type:"number"},model:{value:t.producto.precios[e-1].precio,callback:function(o){t.$set(t.producto.precios[e-1],"precio",o)},expression:"producto.precios[i-1].precio"}})],1)],1)],1)})),t._v(" "),o("hr"),t._v(" "),o("b-row",[o("b-col",[t.showProductoDet&&t.show?o("producto-form-det",{ref:"productoDet",attrs:{"id-producto":t.producto.IdProducto},on:{onUpdateProductos:t.calcularPreciosPaquete}}):t._e()],1)],1),t._v(" "),o("div",{attrs:{slot:"modal-footer"},slot:"modal-footer"},[t.producto.IdProducto?o("div",{staticStyle:{left:"1rem",position:"absolute"}},[o("b-input-group",[o("b-form-input",{staticStyle:{width:"80px"},attrs:{type:"number"},model:{value:t.cantidadCodigoBarra,callback:function(e){t.cantidadCodigoBarra=e},expression:"cantidadCodigoBarra"}}),t._v(" "),o("b-input-group-append",[o("b-btn",{attrs:{variant:"info",target:"_blank",href:"/views/codigoBarra.php?idProducto="+t.producto.IdProducto+"&cantidad="+t.cantidadCodigoBarra}},[t._v("Código de barra")])],1)],1)],1):t._e(),t._v(" "),t.producto.IdProducto?o("b-btn",{attrs:{variant:"danger"},on:{click:function(e){t.eliminarProducto(t.producto)}}},[t._v("\n        Anular\n      ")]):t._e(),t._v(" "),t.producto.IdProducto?t._e():o("b-btn",{attrs:{variant:"warning"},on:{click:t.clearForm}},[t._v("\n        Limpiar\n      ")]),t._v(" "),o("b-btn",{attrs:{variant:"primary",type:"submit"}},[t._v("\n         Guardar\n       ")]),t._v(" "),o("b-btn",{attrs:{variant:"secondary"},on:{click:function(e){t.show=!1}}},[t._v("\n         Close\n       ")])],1)],1)],1)],1)},staticRenderFns:[]};var x=o("VU/8")(I,A,!1,function(t){o("rPld")},null,null).exports,y={mounted:function(){},data:function(){return{API:v.a.API,loadCode:"",pasteCode:!1,producto:{},items:[],handleKeyDown:!1,vuelto:0,pagocon:0,cliente:{},preciosProd:[],objProd:{},cant:0}},watch:{sumatoriaTotal:function(t){this.asignarVuelto()},productos:function(t){var e=this.productos.findIndex(function(t){return"MANODEOBRA"===t.CodigoBarra});e>=0&&!this.productos[e].precioBruta&&(this.productos[e].precioBruta=this.productos[e].precio)}},props:{isVentas:Boolean,setPrecio:Boolean,tipoCambio:Number,igvTotal:Boolean,idAlmacen:Number,onSetProducto:{type:Function,default:function(t){return t}},showButton:{default:!0,type:Boolean},fields:{default:function(){return[{key:"stock",label:"Stock",variant:"info",class:"text-center"},{key:"CodigoBarra",label:"Código"},{key:"Producto",label:"Artículo"},{key:"Descripcion",label:"Descripción"},{key:"ProductoMarca",label:"Marca"},{key:"ProductoPresentacion",label:"Present."},{key:"cantidad"},{key:"precio",label:"P/U"},{key:"subtotal",label:"SubTotal",variant:"success"},{key:"igv",label:"IGV"},{key:"precioVenta",label:"Precio venta (S/)"},{key:"total",label:"Total",variant:"danger"},{key:"acciones",label:""}]},type:Array}},computed:c()({},Object(d.c)({productos:function(t){return t.cart.productos},filtrados:function(t){return t.cart.productosFiltrados}}),{APIProductos:function(){return this.idAlmacen?this.API+"productos/stock/"+this.idAlmacen:this.API+"productos"},sumatoriaSubTotal:function(){var t=0;return this.igvTotal?t=this.sumatoriaTotal/1.18:this.productos.map(function(e){t+=parseFloat(e.subtotal),e.descuento&&(t-=e.descuento)}),this.$options.filters.redondear(t)},sumatoriaTotal:function(){var t=0;return this.productos.map(function(e){t+=parseFloat(e.total)}),this.actualizarTotal(t),this.$options.filters.redondear(t)},sumatoriaIgv:function(){var t=0;return this.igvTotal?(t=this.sumatoriaTotal,t-=t/1.18):this.productos.map(function(e){t+=parseFloat(e.igv)}),this.$options.filters.redondear(t)},sumatoriaDescuento:function(){var t=0;return this.productos.map(function(e){t+=parseFloat(e.descuento||0)}),this.$options.filters.redondear(t)}}),methods:c()({},Object(d.b)({add:"agregarProducto",buscar:"buscarProductos",eliminar:"eliminarProducto",actualizarTotal:"actualizarTotalCart",actualizarProd:"actualizarProducto"}),{changeCant:function(t,e){var o=this;t&&(e.cantidad=e.cantidadPres,e.cantidad*=t),this.$nextTick(function(){o.actualizarProd(e)})},cambiarPrecio:function(t,e){var o=this.productos[t].PrecioCosto*(this.productos[t].PorcentajeUtilidad/100);this.productos[t].precio=Math.ceil(this.productos[t].PrecioCosto+o)},addManoDeObra:function(t,e){var o=this.productos.findIndex(function(t){return"MANODEOBRA"===t.CodigoBarra});if(o<0)return this.$toasted.error("Primero seleccione el producto MANODEOBRA"),void(this.productos[t].EsManoDeObra=0);this.productos[t].EsManoDeObra?(e.target.parentNode.parentNode.style.backgroundColor="#e7c4ff",this.productos[o].precio=parseFloat(this.productos[o].precio)-parseFloat(this.productos[t].precio)*parseFloat(this.productos[t].cantidad),this.productos[t].disabled=!0):(e.target.parentNode.parentNode.removeAttribute("style"),this.productos[o].precio=parseFloat(this.productos[o].precio)+parseFloat(this.productos[t].precio)*parseFloat(this.productos[t].cantidad),this.productos[t].disabled=!1)},updateManoDeObraNeta:function(t){var e=this.productos.find(function(t){return"MANODEOBRA"===t.CodigoBarra}),o=e?e.precioBruta:0;this.productos.filter(function(t){return t.EsManoDeObra}).map(function(t){o-=parseFloat(t.precio)*parseFloat(t.cantidad)});var a=this.productos.findIndex(function(t){return"MANODEOBRA"===t.CodigoBarra});a>=0&&t!==a&&(this.productos[a].precio=o)},asignarVuelto:function(){this.vuelto=this.pagocon-this.sumatoriaTotal},loadBarcode:function(t){var e=this;t.preventDefault();var o=this.loadCode;if(o){var a={codigoBarra:o};this.axios.get(this.API+"productos/id/"+o,{params:a}).then(function(t){t.data.IdProducto?e.setProducto(t.data):(e.loadCode="",e.$toasted.show("No se encontró ningun producto"))})}},focusAutocomplete:function(t){this.$refs[t].type="",this.$refs[t].handleDoubleClick()},setProducto:function(t){this.loadCode="",this.preciosProd=[],this.objProd={},this.isVentas||(t.PreciosPorProducto=""),t.PreciosPorProducto?(this.$refs.modalCant.show(),this.preciosProd=JSON.parse(t.PreciosPorProducto),this.objProd=t):this.setProductoUni(t)},setProductoUni:function(t){var e=this;this.objProd.cantxPrecio=1,this.$refs.autocompleteProducto.setValue(""),t.precio=0,t.cantidad=0,t.descuento=0,t.nuevoPrecioContado=0,t=this.onSetProducto(t),this.add([t,function(){e.$emit("onAddProducto",t),e.$toasted.success("Producto añadido correctamente")},!1,!1,this.cliente.EsVIP]),this.$refs.modalCant.hide(),t.cantidadPres=t.cantidad,this.actualizarProd(t)},setProductoCant:function(t){var e=this;this.objProd.cantxPrecio=1,this.cant=t.cantidad;var o=this.objProd;this.$refs.autocompleteProducto.setValue(""),o.precio=0,o.cantidad=0,o.descuento=0,o.nuevoPrecioContado=0,o=this.onSetProducto(o,t.cantidad),this.add([o,function(){e.$emit("onAddProducto",o),e.$toasted.success("Producto añadido correctamente")},!1,!1,this.cliente.EsVIP]),this.$refs.modalCant.hide(),o.cantidadPres=this.cant,this.actualizarProd(o)},showPresentacion:function(t){if(""!==!t.PreciosPorProducto)return this.preciosProd=t.PreciosPorProducto?JSON.parse(t.PreciosPorProducto):[],this.objProd=t,void this.$refs.modalCant.show()},renderChild:function(t){return"\n        <b>"+t.Producto+" - "+t.CodigoBarra+"</b> / "+t.ProductoCategoria+" / "+t.ProductoMarca+" / "+t.ProductoPresentacion+" / "+t.ProductoMedicion+" / Stock: "+t.stock+"\n      "},setNuevoPrecioContado:function(t){var e=parseFloat(this.productos[t].precio);this.productos[t].TieneIgv&&(e+=.18*e),e+=e*(this.productos[t].PorcentajeUtilidad/100);var o=this.$options.filters.redondear(e),a=this.$options.filters.redondear(e,1);this.tipoCambio>0&&(o*=this.tipoCambio,a*=this.tipoCambio),Vue.set(this.productos[t],"normalPrecioContado",parseFloat(o).toFixed(2)),Vue.set(this.productos[t],"nuevoPrecioContado",Math.ceil(a)),this.getSubtotal(t),this.updateManoDeObraNeta(t)},getSubtotal:function(t){var e=this.$options.filters.redondear(this.productos[t].cantidad*this.productos[t].precio);return Vue.set(this.productos[t],"subtotal",e),e},getIgv:function(t){var e=0;return this.productos[t].TieneIgv&&(e=this.$options.filters.redondear(.18*this.productos[t].subtotal)),Vue.set(this.productos[t],"igv",e),e},getTotal:function(t){var e=parseFloat(this.productos[t].subtotal);return this.productos[t].FLETE&&(e+=parseFloat(this.productos[t].FLETE)),this.productos[t].TieneIgv&&(e+=parseFloat(this.productos[t].igv)),this.productos[t].descuento&&(e-=parseFloat(this.productos[t].descuento)),e=this.$options.filters.redondear(e),Vue.set(this.productos[t],"total",e),e},getData:function(t){this.buscar(t)},quitarProducto:function(t){this.eliminar(t),this.$emit("onRemoveProducto",t),this.$toasted.show("Producto quitado del listado")},formatFecha:function(t){return t?this.$moment(t,"YYYY-MM-DD hh:mm:ss").format("YYYY-MM-DD"):""}}),components:{ProductoForm:x}},k={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("b-row",[o("b-col",{attrs:{md:"12"}},[o("b-form-group",[o("label",[t._v("Agregar Productos:")]),t._v(" "),o("b-input-group",[o("autocomplete",{ref:"autocompleteProducto",attrs:{url:t.APIProductos,customParams:{limit:"25"},onShouldRenderChild:t.renderChild,anchor:"Producto",label:"writer",placeholder:"Agregar Producto","on-select":t.setProducto,onFocus:t.focusAutocomplete.bind(null,"autocompleteProducto"),classes:{input:"form-control"}}}),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.loadCode,expression:"loadCode"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Codigo de Barra"},domProps:{value:t.loadCode},on:{keydown:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?(e.preventDefault(),t.loadBarcode(e)):null},input:function(e){e.target.composing||(t.loadCode=e.target.value)}}}),t._v(" "),o("b-input-group-append",[o("producto-form",{attrs:{showButton:t.showButton,cbGuardar:function(e){return t.add([e])}}})],1)],1)],1),t._v(" "),o("b-modal",{ref:"modalCant",attrs:{"hide-footer":"","hide-header":""}},[o("div",{staticClass:"d-block text-center"},[o("h3",[t._v("PRESENTACIONES")])]),t._v(" "),o("b-row",[o("b-col",{attrs:{cols:"6"}},[o("b-card",{staticClass:"mb-3 contentCard",attrs:{align:"center"},on:{click:function(e){t.setProductoUni(t.objProd)}}},[o("b",[t._v("1 - UNIDAD")])])],1),t._v(" "),t._l(t.preciosProd,function(e){return o("b-col",{key:e.id,attrs:{cols:"6"}},[o("b-card",{staticClass:"mb-3 contentCard",class:{disabledMouse:!parseFloat(e.cantidad)},attrs:{align:"center"},on:{click:function(){parseFloat(e.cantidad)&&t.setProductoCant(e)}}},[t._v("\n            "+t._s(e.cantidad)+" - "+t._s(e.nombre)+"\n          ")])],1)})],2)],1),t._v(" "),o("b-table",{ref:"tablaCarrito",attrs:{small:"",responsive:"",striped:"",hover:"",items:t.productos,fields:t.fields},scopedSlots:t._u([{key:"eventPres",fn:function(e){return t.productos[e.index].PreciosPorProducto?[o("b-button",{attrs:{size:"sm",variant:"info"},on:{click:function(o){t.showPresentacion(t.productos[e.index])}}},[o("i",{staticClass:"fas fa-pencil-alt"})])]:void 0}},{key:"cantxPrecio",fn:function(e){return t.productos[e.index].PreciosPorProducto?[o("b-form-input",{staticStyle:{width:"75px"},attrs:{type:"number",step:"0.001",min:"0",placeholder:"Cantidad"},on:{input:function(o){return t.changeCant(o,t.productos[e.index])}},model:{value:t.productos[e.index].cantxPrecio,callback:function(o){t.$set(t.productos[e.index],"cantxPrecio",o)},expression:"productos[data.index].cantxPrecio"}}),t._v(" "),o("span",[t._v("x"+t._s(t.productos[e.index].cantidadPres))])]:void 0}},{key:"cantidad",fn:function(e){return[o("b-form-input",{staticStyle:{width:"75px"},attrs:{disabled:t.productos[e.index].disabled,type:"number",min:"0",placeholder:"Cantidad"},on:{input:function(o){if(t.$emit("onInputCantidad",o),t.productos[e.index].PreciosPorProducto){var a=JSON.parse(t.productos[e.index].PreciosPorProducto).find(function(o){return o.cantidad===t.productos[e.index].cantidadPres});a&&a.cantidad?t.productos[e.index].precio=a.precio:t.productos[e.index].precio=t.productos[e.index].PrecioContado}else t.productos[e.index].precio=t.productos[e.index].StockPorMayor&&o>=t.productos[e.index].StockPorMayor?t.productos[e.index].PrecioPorMayor:t.productos[e.index].PrecioContado}},model:{value:t.productos[e.index].cantidad,callback:function(o){t.$set(t.productos[e.index],"cantidad",o)},expression:"productos[data.index].cantidad"}})]}},{key:"precio",fn:function(e){return[o("b-form-input",{staticStyle:{width:"75px"},attrs:{disabled:t.productos[e.index].disabled,type:"number",min:"0",step:"0.00001",placeholder:"Precio"},on:{input:function(o){t.setNuevoPrecioContado(e.index)}},model:{value:t.productos[e.index].precio,callback:function(o){t.$set(t.productos[e.index],"precio",o)},expression:"productos[data.index].precio"}})]}},{key:"subtotal",fn:function(e){return[t._v("\n        "+t._s(t.getSubtotal(e.index))+"\n      ")]}},{key:"igv",fn:function(e){return[o("b-form-checkbox",{attrs:{value:1,"unchecked-value":0},on:{input:function(o){t.setNuevoPrecioContado(e.index)}},model:{value:t.productos[e.index].TieneIgv,callback:function(o){t.$set(t.productos[e.index],"TieneIgv",o)},expression:"productos[data.index].TieneIgv"}},[o("div",[t._v(t._s(t.getIgv(e.index)))])])]}},{key:"manoobra",fn:function(e){return["MANODEOBRA"!=t.productos[e.index].CodigoBarra?o("input",{directives:[{name:"model",rawName:"v-model",value:t.productos[e.index].EsManoDeObra,expression:"productos[data.index].EsManoDeObra"}],staticClass:"form-check-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.productos[e.index].EsManoDeObra)?t._i(t.productos[e.index].EsManoDeObra,null)>-1:t.productos[e.index].EsManoDeObra},on:{change:[function(o){var a=t.productos[e.index].EsManoDeObra,r=o.target,n=!!r.checked;if(Array.isArray(a)){var i=t._i(a,null);r.checked?i<0&&t.$set(t.productos[e.index],"EsManoDeObra",a.concat([null])):i>-1&&t.$set(t.productos[e.index],"EsManoDeObra",a.slice(0,i).concat(a.slice(i+1)))}else t.$set(t.productos[e.index],"EsManoDeObra",n)},function(o){return t.addManoDeObra(e.index,o)}]}}):t._e()]}},{key:"precioVenta",fn:function(e){return[o("b-form-input",{staticStyle:{width:"80px"},attrs:{type:"number",min:"0",step:"0.01",placeholder:"Precio Venta"},model:{value:t.productos[e.index].nuevoPrecioContado,callback:function(o){t.$set(t.productos[e.index],"nuevoPrecioContado",o)},expression:"productos[data.index].nuevoPrecioContado"}}),t._v(" "),o("b-form-text",[o("strike",[t._v(" "+t._s(t.productos[e.index].normalPrecioContado)+" ")])],1)]}},{key:"utilidad",fn:function(e){return[o("input",{directives:[{name:"model",rawName:"v-model",value:t.productos[e.index].PorcentajeUtilidad,expression:"productos[data.index].PorcentajeUtilidad"}],staticClass:"form-control",staticStyle:{width:"80px"},attrs:{type:"number",step:"0.01"},domProps:{value:t.productos[e.index].PorcentajeUtilidad},on:{input:[function(o){o.target.composing||t.$set(t.productos[e.index],"PorcentajeUtilidad",o.target.value)},function(o){t.cambiarPrecio(e.index,t.productos[e.index])}],mouseup:function(o){t.cambiarPrecio(e.index,t.productos[e.index])}}}),t._v(" "),o("small",[t._v("ganancia: "+t._s(t._f("redondear")(t.productos[e.index].precio-t.productos[e.index].PrecioCosto)))])]}},{key:"descuento",fn:function(e){return[o("b-form-input",{attrs:{type:"number",min:"0",step:"0.01",value:0},model:{value:t.productos[e.index].descuento,callback:function(o){t.$set(t.productos[e.index],"descuento",o)},expression:"productos[data.index].descuento"}}),t._v(" "),o("b-form-text")]}},{key:"FechaAlquiler",fn:function(e){return[o("b-form-input",{attrs:{type:"date",placeholder:"Fecha Fin",value:t.formatFecha(e.item.FechaAlquiler)},model:{value:t.productos[e.index].FechaAlquiler,callback:function(o){t.$set(t.productos[e.index],"FechaAlquiler",o)},expression:"productos[data.index].FechaAlquiler"}})]}},{key:"FechaAlquilerFin",fn:function(e){return[o("b-form-input",{attrs:{type:"date",placeholder:"Fecha Fin",value:t.formatFecha(e.item.FechaAlquilerFin)},model:{value:t.productos[e.index].FechaAlquilerFin,callback:function(o){t.$set(t.productos[e.index],"FechaAlquilerFin",o)},expression:"productos[data.index].FechaAlquilerFin"}})]}},{key:"Descripcion",fn:function(e){return[o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.productos[e.index].Descripcion,expression:"productos[data.index].Descripcion"}],staticClass:"form-control",attrs:{placeholder:"Descripción",cols:"9",rows:"3"},domProps:{value:t.productos[e.index].Descripcion},on:{input:function(o){o.target.composing||t.$set(t.productos[e.index],"Descripcion",o.target.value)}}})]}},{key:"total",fn:function(e){return[t._v("\n        "+t._s(t.getTotal(e.index))+"\n      ")]}},{key:"acciones",fn:function(e){return[o("b-button",{attrs:{variant:"danger",size:"sm"},on:{click:function(o){t.quitarProducto(e.index)}}},[t._v("X")])]}},{key:"show_details",fn:function(e){return[o("b-button",{attrs:{size:"sm",variant:"info"},on:{click:function(t){return t.stopPropagation(),e.toggleDetails(t)}}},[t._v(">")])]}},{key:"row-details",fn:function(t){}},{key:"stock",fn:function(e){return[e.item.EsPadre?o("img",{staticStyle:{width:"24px"},attrs:{src:"static/box.png"}}):t._e(),t._v(" "),e.item.EsPadre?t._e():o("div",[t._v(t._s(e.item.stock))])]}}])})],1),t._v(" "),o("b-col",{attrs:{md:"3"}},[t._t("operaciones")],2),t._v(" "),o("b-col",{attrs:{md:"4"}},[t._t("metodopago")],2),t._v(" "),o("b-col",{attrs:{md:"2"}},[t._t("adicional")],2),t._v(" "),o("b-col",{attrs:{md:"3"}},[o("table",{staticClass:"table b-table border table-footer"},[o("tbody",[t.sumatoriaDescuento>0?o("tr",[o("td",{staticClass:"table-success"},[t._v("SubTotal")]),t._v(" "),o("td",{staticClass:"table-success"},[t._v(t._s(t._f("redondear")(parseFloat(t.sumatoriaSubTotal)+parseFloat(t.sumatoriaDescuento))))])]):t._e(),t._v(" "),t.sumatoriaDescuento>0?o("tr",[o("td",{staticClass:"table-danger"},[t._v("Descuento")]),t._v(" "),o("td",{staticClass:"table-danger"},[t._v("- "+t._s(t.sumatoriaDescuento))])]):t._e(),t._v(" "),o("tr",[o("td",[o("b",[t._v("SubTotal")])]),t._v(" "),o("td",{staticClass:"table-danger"},[t._v(t._s(t.sumatoriaSubTotal))])]),t._v(" "),t.sumatoriaIgv>0?o("tr",[o("td",[o("b",[t._v("IGV")])]),t._v(" "),o("td",{staticClass:"table-danger"},[t._v(t._s(t.sumatoriaIgv))])]):t._e(),t._v(" "),o("tr",[o("td",[o("b",[t._v("TOTAL")])]),t._v(" "),o("td",{staticClass:"table-danger"},[t._v(t._s(t.sumatoriaTotal))])]),t._v(" "),o("tr",[o("td",{attrs:{colspan:"2"}},[o("label",[t._v("pagó con:")]),t._v(" "),o("b-form-input",{attrs:{type:"text",placeholder:"Pagó con"},on:{input:t.asignarVuelto},model:{value:t.pagocon,callback:function(e){t.pagocon=e},expression:"pagocon"}}),o("br"),t._v(" "),o("label",[t._v("Vuelto:")]),t._v(" "),o("b",[t._v("S/  "+t._s(t._f("redondear")(t.vuelto)))])],1)])])])]),t._v(" "),o("br"),o("br")],1)},staticRenderFns:[]};var w=o("VU/8")(y,k,!1,function(t){o("BWj6")},null,null).exports,D={data:function(){return{API:v.a.API,show:!1,proveedor:{Proveedor:"",Ruc:"",Direccion:"",Observacion:"",FechaReg:null}}},props:["newRuc"],methods:{shownProveedorForm:function(){this.proveedor.Ruc=this.$parent.$parent.newRuc,this.proveedor.Direccion="",this.proveedor.Proveedor=""},consultarRUC:function(){var t=this;this.axios.get(this.API+"consultarRUC",{params:{type:"RUC",numero:this.proveedor.Ruc}}).then(function(e){t.$toasted.show("Proveedor encontrado, se llenarán sus datos");var o=e.data;t.proveedor.Proveedor=o.razonSocial,t.proveedor.Direccion=o.direccion}).catch(function(e){t.$toasted.show("No se encontró el RUC"),console.log(e)})},guardarProveedor:function(){var t=this;this.axios.post(this.API+"proveedores",this.proveedor).then(function(e){t.$toasted.show("Proveedor guardado correctamente"),t.$refs.proveedorForm.hide()}).catch(function(e){t.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})}}},V={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-btn",{directives:[{name:"b-modal",rawName:"v-b-modal.modal1",modifiers:{modal1:!0}}],attrs:{variant:"primary"}},[t._v("Nuevo")]),t._v(" "),o("b-modal",{ref:"proveedorForm",attrs:{id:"modal1",title:"Nuevo Proveedor",size:"lg"},on:{shown:t.shownProveedorForm},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("b-row",[o("b-col",{attrs:{md:"12"}},[o("b-form-group",[o("label",[t._v("RUC:")]),t._v(" "),o("b-input-group",[o("b-form-input",{model:{value:t.proveedor.Ruc,callback:function(e){t.$set(t.proveedor,"Ruc",e)},expression:"proveedor.Ruc"}}),t._v(" "),o("b-input-group-append",[o("b-btn",{attrs:{variant:"info"},on:{click:t.consultarRUC}},[t._v("Buscar RUC")])],1)],1)],1),t._v(" "),o("b-form-group",[o("label",[t._v("Nombre del Proveedor:")]),t._v(" "),o("b-form-input",{attrs:{type:"text"},model:{value:t.proveedor.Proveedor,callback:function(e){t.$set(t.proveedor,"Proveedor",e)},expression:"proveedor.Proveedor"}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Dirección:")]),t._v(" "),o("b-form-input",{attrs:{type:"text"},model:{value:t.proveedor.Direccion,callback:function(e){t.$set(t.proveedor,"Direccion",e)},expression:"proveedor.Direccion"}})],1)],1)],1),t._v(" "),o("div",{attrs:{slot:"modal-footer"},slot:"modal-footer"},[o("b-btn",{attrs:{variant:"primary"},on:{click:t.guardarProveedor}},[t._v("\n         Guardar\n       ")]),t._v(" "),o("b-btn",{attrs:{variant:"secondary"},on:{click:function(e){t.show=!1}}},[t._v("\n         Close\n       ")])],1)],1)],1)},staticRenderFns:[]};var $=o("VU/8")(D,V,!1,function(t){o("VK8q")},null,null).exports,S={mounted:function(){},data:function(){return{inProgress:!1,newRuc:"",API:v.a.API,ultimoMovimiento:"",movimiento:this.initMovimiento()}},computed:c()({},Object(d.c)({proveedoresFiltrados:function(t){return t.proveedoresFiltrados},almacenes:function(t){return t.almacenesFiltrados},productos:function(t){return t.cart.productos}})),methods:c()({},Object(d.b)({buscarProveedores:"buscarProveedores",buscarAlmacenes:"buscarAlmacenes",limpiar:"limpiarCarrito",obtenerStok:"obtenerStock"}),{onAddProducto:function(t){this.obtenerStok({IdAlmacen:this.movimiento.almacenDestino.IdAlmacen>0?this.movimiento.almacenDestino.IdAlmacen:1})},afe:function(t){return!1},cargarNumero:function(){var t=this;this.axios.get(this.API+"movimientos/numero",{params:{serie:this.movimiento.Serie,idMovimientoTipo:this.movimiento.movimientoTipo.IdMovimientoTipo}}).then(function(e){Vue.set(t.movimiento,"Numero",e.data.NuevoNumero||"0001")}).catch(function(t){console.log(t)})},initMovimiento:function(){var t=this.$moment().month()+1;return t=t<10?"0"+t:t,{EsCredito:0,alterarProductos:1,FechaVenCredito:"",Moneda:"PEN",FechaPeriodoTributario:this.$moment().year()+""+t,MovimientoFecha:"chrome"==this.$browser.name?this.$moment().format("YYYY-MM-DDThh:mm:ss"):this.$moment().format("YYYY-MM-DD hh:mm:ss"),FechaStock:this.$moment().format("YYYY-MM-DD"),TipoCambio:1,proveedor:{IdProveedor:0},movimientoTipo:{},almacenOrigen:{IdAlmacen:-1},almacenDestino:{IdAlmacen:-1}}},onReset:function(t){t.preventDefault()},setTipoMovimiento:function(t){0==t.Tipo?(this.movimiento.almacenOrigen={IdAlmacen:-1},this.movimiento.almacenDestino={IdAlmacen:1}):1==t.Tipo?(this.movimiento.almacenDestino={IdAlmacen:-1},this.movimiento.almacenOrigen={IdAlmacen:1}):(this.movimiento.almacenDestino={IdAlmacen:1},this.movimiento.almacenOrigen={IdAlmacen:1}),this.movimiento.movimientoTipo=t,this.cargarNumero()},setProveedor:function(t){this.movimiento.proveedor=t},setAlmacenOrigen:function(t){this.movimiento.almacenOrigen=t},setAlmacenDestino:function(t){this.movimiento.almacenDestino=t,this.obtenerStok({IdAlmacen:this.movimiento.almacenDestino.IdAlmacen>0?this.movimiento.almacenDestino.IdAlmacen:1})},setMoneda:function(t){this.movimiento.Moneda=t.Moneda,"USD"===t.Moneda?this.movimiento.TipoCambio=3.7:this.movimiento.TipoCambio=1},getProveedores:function(t){this.buscarProveedores(t)},getAlmacenes:function(t){this.buscarAlmacenes(t)},guardarMovimiento:function(t){var e=this;if(t.preventDefault(),this.inProgress=!0,!this.movimiento.proveedor.IdProveedor)return this.$toasted.show("Por favor seleccione un proveedor"),void(this.inProgress=!1);if(!this.productos.length)return this.$toasted.show("No ha seleccionado ningun producto"),void(this.inProgress=!1);var o=!1;if(this.productos.forEach(function(t,e){t.total<=0&&(o=!0)}),o&&this.movimiento.alterarProductos)return this.$toasted.show("Falta llenar cantidad / precio"),void(this.inProgress=!1);this.axios.post(this.API+"movimientos",{movimiento:this.movimiento,productos:this.productos}).then(function(t){t.data.error?e.$toasted.show(t.data.error):(e.ultimoMovimiento=t.data.hash,e.movimiento=e.initMovimiento(),e.limpiar(),e.$refs.inputMovimiento.setValue(""),e.$refs.inputProveedor.setValue(""),e.$toasted.show("Movimiento guardado correctamente ")),e.inProgress=!1}).catch(function(t){e.$toasted.show("Ha ocurrido un error, vuelva a intentarlo"),e.inProgress=!1})},focusAutocomplete:function(t){this.$refs[t].handleDoubleClick()}}),components:{Menu:u,ProductosCarrito:w,ProveedoresForm:$}},F={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[t._e(),t._v(" "),o("br"),t._v(" "),o("b-form",{attrs:{validated:""},on:{submit:t.guardarMovimiento,reset:t.onReset,keyup:t.afe}},[o("b-container",{staticClass:"bv-example-row"},[o("b-row",[o("b-col",{attrs:{md:"8"}},[o("b-row",[o("b-col",{attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Tipo de Movimiento:")]),t._v(" "),o("autocomplete",{ref:"inputMovimiento",attrs:{required:"required",url:t.API+"movimientos/tipos",anchor:"TipoMovimiento",label:"writer",placeholder:"","on-select":t.setTipoMovimiento,onFocus:t.focusAutocomplete.bind(null,"inputMovimiento"),classes:{input:"form-control"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"8"}},[o("b-form-group",[o("label",[t._v("Proveedor:")]),t._v(" "),o("b-input-group",[o("autocomplete",{ref:"inputProveedor",attrs:{required:"required",url:t.API+"proveedores",anchor:"ProveedorRuc",label:"writer",placeholder:"",onInput:function(e){return t.newRuc=e},"on-select":t.setProveedor,onFocus:t.focusAutocomplete.bind(null,"inputProveedor"),classes:{input:"form-control"}}}),t._v(" "),o("b-input-group-append",[o("proveedores-form",{attrs:{ruc:t.newRuc}})],1)],1)],1)],1)],1),t._v(" "),o("b-row",[o("b-col",{attrs:{md:"3"}},[o("b-form-group",[o("label",[t._v("Periodo Tributario:")]),t._v(" "),o("b-form-input",{attrs:{type:"text",readonly:"readonly",placeholder:"Periodo Tributario"},model:{value:t.movimiento.FechaPeriodoTributario,callback:function(e){t.$set(t.movimiento,"FechaPeriodoTributario",e)},expression:"movimiento.FechaPeriodoTributario"}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"3"}},[1==t.movimiento.movimientoTipo.Tipo||2==t.movimiento.movimientoTipo.Tipo?o("b-form-group",[o("label",[t._v("Almacen Origen:")]),t._v(" "),o("autocomplete",{ref:"inputAlmacenOrigen",attrs:{required:"required",initValue:"HUANUCO",url:t.API+"almacenes",anchor:"Almacen",label:"writer",placeholder:"","on-select":t.setAlmacenOrigen,onFocus:t.focusAutocomplete.bind(null,"inputAlmacenOrigen"),classes:{input:"form-control"}}})],1):t._e()],1),t._v(" "),o("b-col",{attrs:{md:"3"}},[0==t.movimiento.movimientoTipo.Tipo||2==t.movimiento.movimientoTipo.Tipo?o("b-form-group",[o("label",[t._v("Almacen Destino:")]),t._v(" "),o("autocomplete",{ref:"inputAlmacenDestino",attrs:{required:"required",initValue:"HUANUCO",url:t.API+"almacenes",anchor:"Almacen",label:"writer",placeholder:"","on-select":t.setAlmacenDestino,onFocus:t.focusAutocomplete.bind(null,"inputAlmacenDestino"),classes:{input:"form-control"}}})],1):t._e()],1),t._v(" "),o("b-col",{attrs:{md:"3"}},[o("b-form-group",{attrs:{label:"Credito: "}},[o("b-form-checkbox",{attrs:{value:1,"unchecked-value":0},model:{value:t.movimiento.EsCredito,callback:function(e){t.$set(t.movimiento,"EsCredito",e)},expression:"movimiento.EsCredito"}},[t._v("\n                      Pago pendiente\n                    ")]),t._v(" "),t.movimiento.EsCredito?o("b-form-input",{attrs:{type:"date",placeholder:"Fecha Vencimiento"},model:{value:t.movimiento.FechaVenCredito,callback:function(e){t.$set(t.movimiento,"FechaVenCredito",e)},expression:"movimiento.FechaVenCredito"}}):t._e()],1)],1)],1),t._v(" "),o("b-row",[o("b-col",{attrs:{md:"6"}},[o("b-form-group",[o("b-form-checkbox",{attrs:{id:"alterar-productos",value:1,"unchecked-value":0},model:{value:t.movimiento.alterarProductos,callback:function(e){t.$set(t.movimiento,"alterarProductos",e)},expression:"movimiento.alterarProductos"}},[t._v("\n                      Alterar precio productos\n                    ")])],1)],1)],1)],1),t._v(" "),o("b-col",{attrs:{md:"4"}},[o("b-row",[o("b-col",{attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Serie:")]),t._v(" "),o("b-form-input",{attrs:{required:"required",type:"text",placeholder:""},on:{input:t.cargarNumero},model:{value:t.movimiento.Serie,callback:function(e){t.$set(t.movimiento,"Serie",e)},expression:"movimiento.Serie"}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Número:")]),t._v(" "),o("b-form-input",{attrs:{required:"required",type:"text",placeholder:""},model:{value:t.movimiento.Numero,callback:function(e){t.$set(t.movimiento,"Numero",e)},expression:"movimiento.Numero"}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Moneda:")]),t._v(" "),o("autocomplete",{attrs:{url:t.API+"monedas",initValue:"PEN",anchor:"Moneda",label:"writer",placeholder:"Moneda","on-select":t.setMoneda,classes:{input:"form-control"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"8"}},[o("b-form-group",[o("label",[t._v("Fecha Contable:")]),t._v(" "),o("b-form-input",{attrs:{type:"datetime-local",step:"1",placeholder:"Fecha Contable"},model:{value:t.movimiento.MovimientoFecha,callback:function(e){t.$set(t.movimiento,"MovimientoFecha",e)},expression:"movimiento.MovimientoFecha"}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Fecha Stock:")]),t._v(" "),o("b-form-input",{attrs:{type:"date",placeholder:"Fecha Stock"},model:{value:t.movimiento.FechaStock,callback:function(e){t.$set(t.movimiento,"FechaStock",e)},expression:"movimiento.FechaStock"}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Tipo de cambio:")]),t._v(" "),o("b-form-input",{attrs:{type:"number",placeholder:"Tipo de cambio"},model:{value:t.movimiento.TipoCambio,callback:function(e){t.$set(t.movimiento,"TipoCambio",t._n(e))},expression:"movimiento.TipoCambio"}})],1)],1)],1)],1)],1),t._v(" "),o("b-row",[o("b-col",[o("productos-carrito",{ref:"carrito",attrs:{tipoCambio:t.movimiento.TipoCambio},on:{onAddProducto:t.onAddProducto}})],1)],1),t._v(" "),o("b-row",{staticClass:"text-center",attrs:{"align-h":"center"}},[o("b-col",{attrs:{cols:"4"}},[o("b-button",{attrs:{variant:"success",size:"lg",type:"submit",disabled:t.inProgress}},[t._v("Guardar")]),t._v(" "),t.ultimoMovimiento?o("b-button",{attrs:{target:"_blank",variant:"info",size:"lg",href:"/views/codigoBarra.php?hash="+t.ultimoMovimiento}},[t._v("Código de Barra")]):t._e()],1)],1)],1),t._v(" "),o("br"),o("br")],1)],1)},staticRenderFns:[]};var T=o("VU/8")(S,F,!1,function(t){o("U+Ev")},null,null).exports,E={mounted:function(){var t=this;this.axios.get(this.API+"productos/count").then(function(e){t.totalRows=e.data.total})},data:function(){return{API:v.a.API,pageOptions:[5,10,15,50,100],filter:null,sortBy:"IdProducto",sortDesc:!1,productoSelect:{},items:[],isBusy:!1,fields:[{key:"CodigoBarra",label:"Codigo",sortable:!0},{key:"Producto",sortable:!0},{key:"ProductoCategoria",label:"Categoría",sortable:!0},{key:"ProductoMarca",label:"Marca",sortable:!0},{key:"ProductoMedicion",label:"Medición",sortable:!0},{key:"ProductoPresentacion",label:"Presentación",sortable:!0}],totalRows:50,perPage:10,currentPage:1}},methods:{rowClick:function(t,e){this.productoSelect=t,this.$refs.productoForm.show=!0},actualizarTabla:function(){this.$refs.tablaProductos.refresh()},nuevoProducto:function(){this.productoSelect={},this.$refs.productoForm.show=!0},myProvider:function(t){var e=this,o=this.API+"productos?limit="+t.perPage+"&page="+t.currentPage+"&filter="+(t.filter||"")+"&sortBy="+t.sortBy;return o+="&sortDesc="+(t.sortDesc?1:0),this.axios.get(o).then(function(t){return e.items=t.data,e.items}).catch(function(t){return[]})}},components:{ProductoForm:x}},M={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-container",{staticClass:"bv-example-row"},[o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"6"}},[o("b-form-group",{staticClass:"mb-0",attrs:{horizontal:"",label:"Buscar"}},[o("b-input-group",[o("b-form-input",{attrs:{placeholder:"Buscar"},on:{input:function(e){t.currentPage=1}},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),t._v(" "),o("b-input-group-append",[o("b-btn",{attrs:{disabled:!t.filter},on:{click:function(e){t.filter=""}}},[t._v("Limpiar")])],1)],1)],1),t._v(" "),o("br")],1),t._v(" "),o("b-col",{staticClass:"my-1",attrs:{md:"6"}},[o("b-row",[o("b-col",{attrs:{md:"8"}},[o("b-form-group",{staticClass:"mb-0",attrs:{horizontal:"",label:"Mostrar"}},[o("b-form-select",{attrs:{options:t.pageOptions},on:{input:function(e){t.currentPage=1}},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"4"}},[o("p",{staticStyle:{"margin-top":"6px"}},[t._v("de "),o("b",{staticClass:"text-success"},[t._v(t._s(this.totalRows))]),t._v(" Artículos")])])],1)],1),t._v(" "),o("b-table",{ref:"tablaProductos",attrs:{small:"",filter:t.filter,"sort-by":t.sortBy,"sort-desc":t.sortDesc,striped:"",hover:"",id:"my-table",busy:t.isBusy,items:t.myProvider,fields:t.fields,"per-page":t.perPage,"current-page":t.currentPage},on:{"update:sortBy":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"row-clicked":t.rowClick,"update:busy":function(e){t.isBusy=e}}}),t._v(" "),o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"6"}},[o("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)],1),t._v(" "),o("producto-form",{ref:"productoForm",attrs:{"producto-update":t.productoSelect,cbGuardar:t.actualizarTabla}}),t._v(" "),o("br"),t._v(" "),o("b-row",{staticClass:"text-center",attrs:{"align-h":"center"}},[o("b-col",{attrs:{cols:"4"}},[o("b-button",{attrs:{variant:"success",size:"lg"},on:{click:t.nuevoProducto}},[t._v("Nuevo")])],1)],1),t._v(" "),o("br"),o("br")],1)],1)},staticRenderFns:[]};var R=o("VU/8")(E,M,!1,function(t){o("2BCl")},null,null).exports,O=o("fZjL"),B=o.n(O),N={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"table-responsive"},[o("table",{staticClass:"table b-table table-sm"},[t._m(0),t._v(" "),o("tbody",t._l(t.kardexSaldo,function(e,a){return o("tr",{key:a},[o("td",[t._v(t._s(e.Fecha))]),t._v(" "),o("td",[t._v(t._s(e.Detalle)+" - "+t._s(e.Serie)+" - "+t._s(e.Numero))]),t._v(" "),o("td",[t._v(t._s(e.Nombres))]),t._v(" "),o("td",{class:{"table-warning":e.IngresoCantidad>0}},[t._v(t._s(e.IngresoCantidad))]),t._v(" "),o("td",{class:{"table-warning":e.IngresoPrecio>0}},[o("b",[t._v(t._s(e.IngresoPrecio>0?e.Moneda:""))]),t._v(" "+t._s(t._f("redondear")(e.IngresoPrecio)))]),t._v(" "),o("td",{class:{"table-warning":e.SalidaCantidad>0}},[t._v(t._s(e.SalidaCantidad))]),t._v(" "),o("td",{class:{"table-warning":e.SalidaPrecio>0}},[o("b",[t._v(t._s(e.SalidaPrecio>0?e.Moneda:""))]),t._v(" "+t._s(t._f("redondear")(e.SalidaPrecio)))]),t._v(" "),o("td",{staticClass:"table-danger"},[t._v(t._s(e.saldo))])])}))])])},staticRenderFns:[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("thead",[o("tr",[o("th",{attrs:{rowspan:"2"}},[t._v("FECHA")]),t._v(" "),o("th",{attrs:{rowspan:"2"}},[t._v("COMPROBANTE")]),t._v(" "),o("th",{attrs:{rowspan:"2"}},[t._v("PROVEEDOR/CLIENTE")]),t._v(" "),o("th",{attrs:{colspan:"2"}},[t._v("INGRESOS")]),t._v(" "),o("th",{attrs:{colspan:"2"}},[t._v("SALIDAS")]),t._v(" "),o("th",{staticClass:"table-danger",attrs:{rowspan:"2"}},[t._v("SALDO")])]),t._v(" "),o("tr",[o("th",[t._v("Cant.")]),t._v(" "),o("th",[t._v("Precio.")]),t._v(" "),o("th",[t._v("Cant.")]),t._v(" "),o("th",[t._v("Precio.")])])])}]};var j=o("VU/8")({mounted:function(){},data:function(){return{saldo:0}},props:["producto","kardex"],methods:{getSaldo:function(t){var e=0;return e+10}},computed:{kardexSaldo:function(){var t=0;return this.kardex.map(function(e){return t+=e.IngresoCantidad-e.SalidaCantidad,e.saldo=t,e})}}},N,!1,function(t){o("p3am")},"data-v-76963bb9",null).exports,U={mounted:function(){var t=this;this.axios.get(this.API+"productos/count").then(function(e){t.totalRows=e.data.total})},data:function(){return{API:v.a.API,sumaStock:"...",sumaValorizado:"...",sumaValorizadoSin:"...",APISTOCK:"productos",tipoStock:"",showKardex:!1,almacen:{IdAlmacen:1,Almacen:"PRINCIPAL"},pageOptions:[5,10,15,50,100],filters:{},filter:"",sortBy:"IdProducto",sortDesc:!1,productoSelect:{},kardexSelect:[],items:[],itemsStock:[],isBusy:!1,fields:[{key:"CodigoBarra",label:"Código",sortable:!0},{key:"ProductoCategoria",label:"Categoría",sortable:!0},{key:"Producto",sortable:!0},{key:"ProductoMarca",label:"Marca",sortable:!0},{key:"stock",sortable:!1,variant:"",class:"text-center"}],totalRows:50,perPage:10,currentPage:1,idPerfil:sessionStorage.getItem("IdPerfil"),verValorizado:!1}},watch:{items:function(t){var e=this;this.axios.get(this.API+"productos/stock",{params:{idProductos:t.map(function(t){return t.IdProducto}),idAlmacen:this.almacen.IdAlmacen,limit:t.length}}).then(function(t){e.itemsStock=t.data}).catch(function(t){console.log(t)}),this.getSumaStock(),this.getSumaValorizado(),this.getSumaValorizadoSin()}},computed:{titleKardex:function(){return"KARDEX - / "+this.productoSelect.CodigoBarra+" / "+this.productoSelect.Producto+" / "+this.productoSelect.ProductoMarca+" / "+this.productoSelect.ProductoFormaFarmaceutica}},methods:{clickVerValorizado:function(){var t=this,e=window.prompt("Escriba su contraseña");e&&this.axios.post(this.API+"login",{user:sessionStorage.getItem("User"),password:e}).then(function(e){e.data&&(t.verValorizado=!0)})},getSumaValorizado:function(){var t=this;this.axios.get(this.API+"productos/stock?controlaStock=1&idAlmacen="+this.almacen.IdAlmacen+"&filter="+(this.filter||"")+"&filter[stock]=mayor&sumaValorizado=1").then(function(e){t.sumaValorizado=e.data[0].sumaValorizado})},getSumaValorizadoSin:function(){var t=this;this.axios.get(this.API+"productos/stock?controlaStock=1&idAlmacen="+this.almacen.IdAlmacen+"&filter="+(this.filter||"")+"&filter[stock]=mayor&sumaValorizadoSin=1").then(function(e){t.sumaValorizadoSin=e.data[0].sumaValorizadoSin})},getSumaStock:function(){var t=this;this.axios.get(this.API+"productos/stock?controlaStock=1&idAlmacen="+this.almacen.IdAlmacen+"&filter="+(this.filter||"")+"&filter[stock]=mayor&sumaStock=1").then(function(e){t.sumaStock=e.data[0].sumaStock})},getStock:function(t){var e=this.itemsStock.findIndex(function(e){return e.IdProducto==t});return this.itemsStock[e]&&this.itemsStock[e].stock},focusAutocomplete:function(t){this.$refs[t].handleDoubleClick()},limpiarClassRows:function(){var t=this.$refs.tablaProductos.$el.rows;B()(t).forEach(function(e){t[e].classList.remove("table-info")})},setAlmacen:function(t){var e=this;console.log(t),this.almacen=t,this.limpiarFiltros(),console.log(this.filter),Vue.nextTick(function(){return e.$refs.tablaProductos.refresh()})},rowClick:function(t,e,o){this.limpiarClassRows(),o.target.parentNode.classList.add("table-info"),this.productoSelect=t},rowDblClick:function(t){var e=this;this.productoSelect=t,this.showKardex=!0,this.axios.get(this.API+"productos/kardex/"+this.productoSelect.IdProducto+"?limit=0",{params:{idAlmacen:this.almacen.IdAlmacen,fechaHasta:this.$moment().format("YYYY-MM-DDTH:mm:ss")}}).then(function(t){e.kardexSelect=t.data})},actualizarTabla:function(){this.$refs.tablaProductos.refresh()},myProvider:function(t){var e=this,o=this.API+this.APISTOCK+"?controlaStock=1&idAlmacen="+this.almacen.IdAlmacen+"&limit="+t.perPage+"&page="+t.currentPage+"&filter="+(t.filter||"")+"&sortBy="+t.sortBy;return console.log(o),o+="&sortDesc="+(t.sortDesc?1:0),this.axios.get(o).then(function(t){return e.items=t.data,e.items}).catch(function(t){return[]})},limpiarFiltros:function(){this.APISTOCK="productos",this.tipoStock="",this.filters={},this.filter="",this.$refs.inputCategoria.setValue(""),this.$refs.inputProducto.setValue(""),this.$refs.inputMarca.setValue(""),this.productoSelect={},this.limpiarClassRows(),console.log(this.filter)},generateFilter:function(t,e){this.filters[t]=e;var o="";for(var t in this.filters)o+="&filter["+t+"]="+this.filters[t],"stock"!=t&&"minimo"!=t||(this.APISTOCK="productos/stock");this.filter=o},exportarProductos:function(){}},components:{ProductoKardex:j}},z={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-container",{staticClass:"bv-example-row",attrs:{fluid:""}},[o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"12"}},[o("b-row",[o("b-col",{attrs:{md:"2"}},[o("div",{staticClass:"suma-stock text-center"},[o("b",[t._v("Stock "),o("br"),t._v(" Valorizado")]),t._v(" "),o("br"),t._v(" "),o("div",[t._v(" S/. "+t._s(t._f("moneda")(t.sumaValorizado))+" ")])])]),t._v(" "),o("b-col",{attrs:{md:"2"}},[o("div",{staticClass:"suma-stock text-center"},[o("b",[t._v("Stock Valorizado"),o("br"),t._v(" Sin Utilidad")]),t._v(" "),o("br"),t._v(" "),o("div",[t._v(" S/. "+t._s(t._f("moneda")(t.sumaValorizadoSin))+" ")])])]),t._v(" "),o("b-col",{attrs:{md:"2"}},[o("div",{staticClass:"suma-stock text-center"},[o("b",[t._v("Stock "),o("br"),t._v("General")]),t._v(" "),o("div",[t._v(" "+t._s(t.sumaStock)+" ")])])]),t._v(" "),o("b-col",{attrs:{md:"2"}},[o("b-form-group",[o("label",[t._v("Almacen:")]),t._v(" "),o("autocomplete",{ref:"inputAlmacen",attrs:{required:"required",url:t.API+"almacenes",anchor:"Almacen",initValue:"PRINCIPAL",label:"writer",placeholder:"","on-select":t.setAlmacen,onFocus:t.focusAutocomplete.bind(null,"inputAlmacen"),classes:{input:"form-control"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"2"}},[o("b-form-group",{attrs:{label:"Tipo de Muestra"}},[o("b-form-radio-group",{attrs:{"button-variant":"primary",buttons:"",name:"butons1",options:[{text:"Stock > 0",value:"mayor"},{text:"Stock <= 0",value:"menor"}]},on:{change:function(e){return t.generateFilter("stock",e)}},model:{value:t.tipoStock,callback:function(e){t.tipoStock=e},expression:"tipoStock"}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"1"}},[o("b-form-group",{attrs:{label:"Limpiar "}},[o("b-button",{attrs:{disabled:!t.filter},on:{click:t.limpiarFiltros}},[t._v("Limpiar")])],1),t._v(" "),o("br")],1),t._v(" "),o("b-col",{attrs:{md:"1"}},[o("b-form-group",{attrs:{label:"Mostrar"}},[o("b-form-select",{attrs:{options:t.pageOptions},on:{input:function(e){t.currentPage=1}},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1)],1)],1)],1)],1),t._v(" "),o("b-row",[o("b-col",{attrs:{md:"12"}},[o("b-row",[o("b-col",{attrs:{md:"3"}},[o("b-form-group",[o("label",[t._v("Categoría:")]),t._v(" "),o("autocomplete",{ref:"inputCategoria",attrs:{url:t.API+"categorias",anchor:"ProductoCategoria",label:"writer","on-select":function(e){return t.generateFilter("categoria",e.ProductoCategoria)},onInput:function(e){return!e&&t.generateFilter("categoria",e)},classes:{input:"form-control upper"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"3"}},[o("b-form-group",[o("label",[t._v("Producto:")]),t._v(" "),o("autocomplete",{ref:"inputProducto",attrs:{url:t.API+"productos",anchor:"Producto",label:"writer","on-select":function(e){return t.generateFilter("producto",e.Producto)},onInput:function(e){return t.generateFilter("producto",e)},classes:{input:"form-control upper"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"3"}},[o("b-form-group",[o("label",[t._v("Marca:")]),t._v(" "),o("autocomplete",{ref:"inputMarca",attrs:{url:t.API+"marcas",anchor:"ProductoMarca",label:"writer","on-select":function(e){return t.generateFilter("marca",e.ProductoMarca)},onInput:function(e){return!e&&t.generateFilter("marca",e)},classes:{input:"form-control upper"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"3"}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"6"}},[o("b-row",[o("b-col",{attrs:{md:"3"}}),t._v(" "),o("b-col",{attrs:{md:"3"}}),t._v(" "),o("b-col",{attrs:{md:"3"}}),t._v(" "),o("b-col",{attrs:{md:"3"}})],1)],1)],1),t._v(" "),o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"12"}},[o("table",{staticClass:"table border b-table table-footer table-sm table-detalle"},[o("thead",[o("tr",[o("th",[t._v("Producto")]),t._v(" "),o("th",{staticClass:"text-center"},[t._v("Precio de compra")]),t._v(" "),o("th",{staticClass:"text-center"},[t._v("Precio de venta")]),t._v(" "),o("th",{staticClass:"text-center"},[t._v("Stock")])])]),t._v(" "),o("tbody",[o("tr",[o("td",[t._v(t._s(t.productoSelect.Producto))]),t._v(" "),o("td",{staticClass:"text-center"},[t._v(t._s(t.productoSelect.PrecioCosto))]),t._v(" "),o("td",{staticClass:"text-center"},[t._v(t._s(t.productoSelect.PrecioContado))]),t._v(" "),o("td",{staticClass:"text-center table-info"},[t._v(t._s(t.getStock(t.productoSelect.IdProducto)))])])])])]),t._v(" "),o("b-col",{attrs:{md:"12"}},[o("b-table",{ref:"tablaProductos",attrs:{small:"",filter:t.filter,"sort-by":t.sortBy,"sort-desc":t.sortDesc,striped:"",hover:"",id:"tabla-productos",busy:t.isBusy,items:t.myProvider,fields:t.fields,"per-page":t.perPage,"current-page":t.currentPage},on:{"update:sortBy":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"row-clicked":t.rowClick,"row-dblclicked":t.rowDblClick,"update:busy":function(e){t.isBusy=e}},scopedSlots:t._u([{key:"stock",fn:function(e){return[o("div",{class:t.getStock(e.item.IdProducto)>0?"table-success":"table-danger",on:{click:function(t){return t.stopPropagation(),!1}}},[t._v("\n                  "+t._s(t.getStock(e.item.IdProducto))+"\n                ")])]}}])})],1),t._v(" "),o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"6"}},[o("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)],1),t._v(" "),o("br"),t._v(" "),o("b-row",{staticClass:"text-center",attrs:{"align-h":"center"}},[o("b-col",{attrs:{cols:"4"}},[o("b-button",{attrs:{variant:"success",size:"lg",href:"/api/index.php/reporte/stock?controlaStock=1&idAlmacen="+t.almacen.IdAlmacen,target:"_blank"}},[t._v("Exportar")])],1)],1),t._v(" "),o("br"),o("br")],1),t._v(" "),o("b-modal",{attrs:{id:"kardex",size:"lg","modal-class":"modal-xl",title:"Kardex de producto"},model:{value:t.showKardex,callback:function(e){t.showKardex=e},expression:"showKardex"}},[o("b-alert",{attrs:{show:"",variant:"warning"}},[t._v(t._s(t.titleKardex))]),t._v(" "),o("producto-kardex",{attrs:{producto:t.productoSelect,kardex:t.kardexSelect}})],1)],1)},staticRenderFns:[]};var q=o("VU/8")(U,z,!1,function(t){o("rKEf")},null,null).exports,Y=o("RRo+"),H=o.n(Y),L=o("pFYg"),G=o.n(L),K={data:function(){return{API:v.a.API,show:!1,cliente:{Cliente:"",DniRuc:"",Direccion:"",Direccion2:"",Direccion3:"",Telefono:"",Email:"",Sexo:"",Ocupacion:"",FechaNacimiento:"",Nacionalidad:""}}},props:["idModal","newDniRuc","editCliente","txtButton"],methods:{shownClienteForm:function(){this.editCliente&&this.editCliente.IdCliente?this.cliente=this.editCliente:this.cliente.DniRuc=this.$parent.$parent.newDniRuc},consultarDNIRUC:function(){var t=this;if(H()(parseInt(this.cliente.DniRuc))){var e=this.cliente.DniRuc.length>8?"RUC":"DNI";this.axios.get(this.API+"consultarRUC",{params:{type:e,numero:this.cliente.DniRuc}}).then(function(o){if(o.data){t.$toasted.show("Cliente encontrado, se llenarán sus datos");var a=o.data;"DNI"==e?(t.cliente.Cliente=a.nombres+" "+a.apellidoPaterno+" "+a.apellidoMaterno,t.cliente.Direccion=""):(t.cliente.Cliente=a.razonSocial,t.cliente.Direccion=a.direccion)}else t.$toasted.show("No se encontró el Usuario")}).catch(function(e){t.$toasted.show("No se encontró el Usuario"),console.log(e)})}else this.$toasted.show("El DNI/RUC debe ser numérico, editar cliente.")},guardarCliente:function(t){var e=this;(t.preventDefault(),H()(parseInt(this.cliente.DniRuc)))?this.cliente.DniRuc.length>7&&this.cliente.DniRuc.length<=11?this.axios.post(this.API+"clientes",this.cliente).then(function(t){e.$emit("onAddCliente",t.data),e.$toasted.show("Cliente guardado correctamente"),e.$refs.clienteForm.hide(),e.cliente={}}).catch(function(t){e.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")}):this.$toasted.show("El Número de Documento es de 8 ó 11 digitos"):this.$toasted.show("El DNI/RUC debe ser numérico, editar cliente.")}}},X={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-btn",{directives:[{name:"b-modal",rawName:"v-b-modal",value:t.idModal||"modal1",expression:"idModal || 'modal1'"}],attrs:{variant:"primary"}},[t._v(t._s(t.txtButton||"Nuevo"))]),t._v(" "),o("b-form",{ref:"form",on:{submit:t.guardarCliente}},[o("b-modal",{ref:"clienteForm",attrs:{id:t.idModal||"modal1",title:"Nuevo Cliente",size:"lg"},on:{shown:t.shownClienteForm},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("b-row",[o("b-col",{attrs:{md:"12"}},[o("b-form-group",[o("label",[t._v("DNI / RUC:")]),t._v(" "),o("b-input-group",[o("b-form-input",{attrs:{required:"required",type:"number"},model:{value:t.cliente.DniRuc,callback:function(e){t.$set(t.cliente,"DniRuc",e)},expression:"cliente.DniRuc"}}),t._v(" "),o("b-input-group-append",[o("b-btn",{attrs:{variant:"info"},on:{click:t.consultarDNIRUC}},[t._v("Buscar ")])],1)],1)],1),t._v(" "),o("b-form-group",[o("label",[t._v("Nombre del Cliente:")]),t._v(" "),o("b-form-input",{attrs:{required:"required",type:"text"},model:{value:t.cliente.Cliente,callback:function(e){t.$set(t.cliente,"Cliente",e)},expression:"cliente.Cliente"}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Dirección 1:")]),t._v(" "),o("b-form-input",{attrs:{type:"text"},model:{value:t.cliente.Direccion,callback:function(e){t.$set(t.cliente,"Direccion",e)},expression:"cliente.Direccion"}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Dirección 2:")]),t._v(" "),o("b-form-input",{attrs:{type:"text"},model:{value:t.cliente.Direccion2,callback:function(e){t.$set(t.cliente,"Direccion2",e)},expression:"cliente.Direccion2"}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Dirección 3:")]),t._v(" "),o("b-form-input",{attrs:{type:"text"},model:{value:t.cliente.Direccion3,callback:function(e){t.$set(t.cliente,"Direccion3",e)},expression:"cliente.Direccion3"}})],1)],1)],1),t._v(" "),o("b-row",[o("b-col",[o("b-form-group",[o("label",[t._v("Teléfono:")]),t._v(" "),o("b-form-input",{attrs:{type:"text"},model:{value:t.cliente.Telefono,callback:function(e){t.$set(t.cliente,"Telefono",e)},expression:"cliente.Telefono"}})],1)],1),t._v(" "),o("b-col",[o("b-form-group",[o("label",[t._v("Correo Electrónico:")]),t._v(" "),o("b-form-input",{attrs:{type:"email"},model:{value:t.cliente.Email,callback:function(e){t.$set(t.cliente,"Email",e)},expression:"cliente.Email"}})],1)],1),t._v(" "),o("b-col",[o("b-form-group",[o("label",[t._v("Nacionalidad:")]),t._v(" "),o("b-form-input",{attrs:{type:"text"},model:{value:t.cliente.Nacionalidad,callback:function(e){t.$set(t.cliente,"Nacionalidad",e)},expression:"cliente.Nacionalidad"}})],1)],1)],1),t._v(" "),o("b-row",[o("b-col",[o("b-form-group",[o("label",[t._v("Sexo:")]),t._v(" "),o("b-form-select",{staticClass:"mb-3",attrs:{options:["M","F"]},model:{value:t.cliente.Sexo,callback:function(e){t.$set(t.cliente,"Sexo",e)},expression:"cliente.Sexo"}})],1)],1),t._v(" "),o("b-col",[o("b-form-group",[o("label",[t._v("Ocupación:")]),t._v(" "),o("b-form-input",{attrs:{type:"text"},model:{value:t.cliente.Ocupacion,callback:function(e){t.$set(t.cliente,"Ocupacion",e)},expression:"cliente.Ocupacion"}})],1)],1)],1),t._v(" "),o("b-row",[o("b-col",[o("b-form-checkbox",{attrs:{value:1,"unchecked-value":0},model:{value:t.cliente.EsVIP,callback:function(e){t.$set(t.cliente,"EsVIP",e)},expression:"cliente.EsVIP"}},[t._v("\n          Marcar si es un cliente VIP\n        ")])],1),t._v(" "),o("b-col",[o("b-form-group",[o("label",[t._v("Fecha Nacimiento:")]),t._v(" "),o("b-form-input",{attrs:{type:"date"},model:{value:t.cliente.FechaNacimiento,callback:function(e){t.$set(t.cliente,"FechaNacimiento",e)},expression:"cliente.FechaNacimiento"}})],1)],1)],1),t._v(" "),o("div",{attrs:{slot:"modal-footer"},slot:"modal-footer"},[o("b-btn",{attrs:{variant:"primary",type:"submit"}},[t._v("\n         Guardar\n       ")]),t._v(" "),o("b-btn",{attrs:{variant:"secondary"},on:{click:function(e){t.show=!1}}},[t._v("\n         Close\n       ")])],1)],1)],1)],1)},staticRenderFns:[]};var Z=o("VU/8")(K,X,!1,function(t){o("oKvT")},"data-v-394899e7",null).exports,W={mounted:function(){this.obtenerDescuento(),this.obtenerComision()},data:function(){return{API:v.a.API,show:!1,porCada:20,puntos:1,valorPunto:1,valorComision:1}},methods:{obtenerDescuento:function(){var t=this;this.axios.get(this.API+"ventas/descuento").then(function(e){t.porCada=e.data.PorCada,t.puntos=e.data.Puntos,t.valorPunto=e.data.ValorPunto}).catch(function(e){console.log(e),t.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})},obtenerComision:function(){var t=this;this.axios.get(this.API+"ventas/comision").then(function(e){t.valorComision=e.data.valorComision}).catch(function(e){console.log(e),t.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})},guardarConfigVenta:function(t){var e=this;t.preventDefault(),this.axios.post(this.API+"ventas/descuento",{porCada:this.porCada,puntos:this.puntos,valorPunto:this.valorPunto}).then(function(t){e.$emit("onUpdateConfig",t.data),e.obtenerDescuento(),e.$toasted.show("Se actualizó la configuración"),e.show=!1}).catch(function(t){console.log(t),e.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})},guardarConfigComision:function(){var t=this;this.axios.post(this.API+"ventas/comision",{valorComision:this.valorComision}).then(function(e){t.$emit("onUpdateConfigComision",e.data),t.obtenerComision(),t.$toasted.show("Se actualizó la configuración"),t.show=!1}).catch(function(e){console.log(e),t.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})}}},J={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){t.show=!0}}},[t._v("Configurar")]),t._v(" "),o("b-form",{on:{submit:t.guardarConfigVenta}},[o("b-modal",{attrs:{id:"modalConfigVenta",title:"Configurar Venta",size:"md","header-bg-variant":"dark",headerTextVariant:"light","body-bg-variant":"light","body-text-variant":"dark"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("b-row",{staticClass:"mb-1"},[o("b-col",[o("label",{attrs:{for:"input-porcada"}},[t._v("Por la compra de:")])]),t._v(" "),o("b-col",[o("b-input-group",{attrs:{size:"sm",prepend:"S/. "}},[o("b-form-input",{attrs:{id:"input-porcada",type:"number",min:"0",step:"0.1",placeholder:""},model:{value:t.porCada,callback:function(e){t.porCada=e},expression:"porCada"}})],1)],1)],1),t._v(" "),o("b-row",{staticClass:"mb-1"},[o("b-col",[o("label",{attrs:{for:"input-porcada"}},[t._v("El cliente gana:")])]),t._v(" "),o("b-col",[o("b-input-group",{attrs:{size:"sm",append:"punto(s)"}},[o("b-form-input",{attrs:{id:"input-porcada",type:"number",min:"0",step:"1",placeholder:""},model:{value:t.puntos,callback:function(e){t.puntos=e},expression:"puntos"}})],1)],1)],1),t._v(" "),o("b-row",{staticClass:"mb-1"},[o("b-col",[o("label",{attrs:{for:"input-porcada"}},[t._v("Cada punto vale:")])]),t._v(" "),o("b-col",[o("b-input-group",{attrs:{size:"sm",prepend:"S/. "}},[o("b-form-input",{attrs:{id:"input-porcada",type:"number",min:"0",step:"0.1",placeholder:""},model:{value:t.valorPunto,callback:function(e){t.valorPunto=e},expression:"valorPunto"}})],1)],1)],1),t._v(" "),o("b-row",{staticClass:"mb-1"},[o("b-col",[o("label",{attrs:{for:"input-porcada"}},[t._v("% Pago de comision:")])]),t._v(" "),o("b-col",[o("b-input-group",{attrs:{size:"sm",prepend:"% "}},[o("b-form-input",{attrs:{id:"input-porcada",type:"number",min:"0",step:"0.01",placeholder:""},model:{value:t.valorComision,callback:function(e){t.valorComision=e},expression:"valorComision"}}),t._v(" "),o("b-button",{attrs:{size:"sm",text:"Button",variant:"success"},on:{click:t.guardarConfigComision}},[t._v("Ok")])],1)],1)],1),t._v(" "),o("div",{attrs:{slot:"modal-footer"},slot:"modal-footer"},[o("b-btn",{attrs:{size:"sm",variant:"success",type:"submit"}},[t._v("\n                    Guardar\n                ")]),t._v(" "),o("b-btn",{attrs:{size:"sm",variant:"secondary"},on:{click:function(e){t.show=!1}}},[t._v("\n                    Cerrar\n                ")])],1)],1)],1)],1)},staticRenderFns:[]};var Q=o("VU/8")(W,J,!1,function(t){o("dhy5")},null,null).exports,tt={mounted:function(){this.initForm(),this.getVendedor()},data:function(){return{API:v.a.API,documentos:[],pagos:[],cajaBanco:{},vendedor:{},show:!1}},methods:{initForm:function(){this.vendedor={},this.documentos=[],this.pagos=[],this.cajaBanco={FechaDoc:this.$moment().format("YYYY-MM-DD")},this.$refs.inputCliente.setValue("")},getVendedor:function(){var t=this,e=sessionStorage.getItem("User");this.axios.get(this.API+"usuarios/"+e).then(function(e){t.setVendedor(e.data),t.$refs.inputVendedor.setValue(e.data.NombreUsuario)}).catch(function(e){console.log(e),t.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})},setVendedor:function(t){this.vendedor=t},focusAutocomplete:function(t){this.$refs[t].handleDoubleClick()},cargarDeuda:function(t){var e=this;this.cajaBanco.cliente=t,this.axios.get(this.API+"cliente/deudas?idCliente="+t.IdCliente).then(function(t){e.documentos=t.data}).catch(function(t){console.log(t),e.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")}),this.cargarPagos(t)},cargarPagos:function(t){var e=this;sessionStorage.getItem("User");this.axios.get(this.API+"cliente/pagos?idCliente="+t.IdCliente).then(function(t){e.pagos=t.data}).catch(function(t){console.log(t),e.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})},guardarPago:function(t){var e=this;t.preventDefault();var o=0;this.documentos.map(function(t){t.aplicar>0&&(o+=t.aplicar)}),0===o&&this.$toasted.show("Error: no ha ingresado ningun importe"),this.axios.post(this.API+"cliente/deudas/pagar",{cajaBanco:this.cajaBanco,documentos:this.documentos,vendedor:this.vendedor}).then(function(t){console.log(t.data),e.$toasted.show("Se pagó la deuda del cliente."),e.show=!1,e.initForm()}).catch(function(t){console.log(t),e.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})}}},et={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){t.show=!0}}},[t._v("Pago Deuda")]),t._v(" "),o("b-form",{on:{submit:t.guardarPago}},[o("b-modal",{attrs:{id:"modalConfigVenta",title:"Cobrar deuda cliente",size:"lg","header-bg-variant":"dark",headerTextVariant:"light","body-bg-variant":"light","body-text-variant":"dark"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("b-row",{staticClass:"mb-1"},[o("b-col",[o("label",{attrs:{for:"input-cliente"}},[t._v("Cliente:")]),t._v(" "),o("b-input-group",[o("autocomplete",{ref:"inputCliente",attrs:{required:"required",url:t.API+"clientes",anchor:"ClienteDniRuc",label:"writer",placeholder:"",onInput:function(e){return t.newDniRuc=e},"on-select":t.cargarDeuda,onFocus:t.focusAutocomplete.bind(null,"inputCliente"),classes:{input:"form-control"}}})],1)],1)],1),t._v(" "),o("b-row",{staticClass:"mb-1"},[o("b-col",[o("label",{attrs:{for:"input-fecha"}},[t._v("Fecha:")]),t._v(" "),o("b-form-input",{attrs:{required:"",id:"input-fecha",type:"date",placeholder:""},model:{value:t.cajaBanco.FechaDoc,callback:function(e){t.$set(t.cajaBanco,"FechaDoc",e)},expression:"cajaBanco.FechaDoc"}})],1),t._v(" "),o("b-col",[o("b-form-group",[o("label",[t._v("Vendedor:")]),t._v(" "),o("autocomplete",{ref:"inputVendedor",attrs:{required:"",url:t.API+"usuarios",anchor:"NombreUsuario",label:"writer","on-select":t.setVendedor,onFocus:t.focusAutocomplete.bind(null,"inputVendedor"),classes:{input:"form-control"}}})],1)],1)],1),t._v(" "),o("b-row",{staticClass:"mb-1"},[o("b-col",[o("label",{attrs:{for:"input-concepto"}},[t._v("Concepto:")]),t._v(" "),o("b-form-input",{attrs:{id:"input-concepto",required:"",type:"text",placeholder:""},model:{value:t.cajaBanco.Concepto,callback:function(e){t.$set(t.cajaBanco,"Concepto",e)},expression:"cajaBanco.Concepto"}})],1)],1),t._v(" "),o("br"),t._v(" "),o("b-row",{staticClass:"mb-1"},[o("b-col",[o("table",{staticClass:"table b-table table-sm"},[o("thead",[o("tr",[o("th",[t._v("ID")]),t._v(" "),o("th",[t._v("Fecha")]),t._v(" "),o("th",[t._v("FechaVen")]),t._v(" "),o("th",[t._v("Correlativo")]),t._v(" "),o("th",[t._v("Total")]),t._v(" "),o("th",[t._v("Aplicado")]),t._v(" "),o("th",[t._v("Saldo")]),t._v(" "),o("th",[t._v("Aplicar")])])]),t._v(" "),o("tbody",t._l(t.documentos,function(e,a){return o("tr",{key:a},[o("td",[t._v(t._s(e.IdDocVenta))]),t._v(" "),o("td",[t._v(t._s(e.FechaDoc))]),t._v(" "),o("td",[t._v(t._s(e.FechaCredito))]),t._v(" "),o("td",[t._v(t._s(e.Correlativo))]),t._v(" "),o("td",[t._v(t._s(e.Total))]),t._v(" "),o("td",{staticClass:"text-center"},[t._v(t._s(e.Aplicado))]),t._v(" "),o("td",[t._v(t._s(e.Saldo))]),t._v(" "),o("td",[o("b-form-input",{attrs:{type:"number",step:"0.01",min:"0",placeholder:"0"},model:{value:e.aplicar,callback:function(o){t.$set(e,"aplicar",o)},expression:"item.aplicar"}})],1)])}))]),t._v(" "),o("br"),t._v(" "),o("div",{staticClass:"float-right"},[o("b-btn",{attrs:{size:"sm",variant:"success",type:"submit"}},[t._v("\n                            Guardar\n                        ")]),t._v(" "),o("b-btn",{attrs:{size:"sm",variant:"secondary"},on:{click:function(e){t.show=!1}}},[t._v("\n                            Cerrar\n                        ")])],1),t._v(" "),o("hr"),t._v(" "),o("br"),o("br"),t._v(" "),o("table",{staticClass:"table b-table table-sm"},[o("thead",[o("tr",[o("th",[t._v("ID")]),t._v(" "),o("th",[t._v("Fecha Pago")]),t._v(" "),o("th",[t._v("Concepto")]),t._v(" "),o("th",[t._v("Importe")]),t._v(" "),o("th")])]),t._v(" "),o("tbody",t._l(t.pagos,function(e,a){return o("tr",{key:a},[o("td",[t._v(t._s(e.IdCajaBanco))]),t._v(" "),o("td",[t._v(t._s(e.FechaDoc))]),t._v(" "),o("td",[t._v(t._s(e.Concepto))]),t._v(" "),o("td",[t._v(t._s(e.Importe))]),t._v(" "),o("td",[o("b-btn",{attrs:{size:"sm",variant:"success",href:"/imprimir/pagocredito.php?idCajaBanco="+e.IdCajaBanco,target:"_blank"}},[t._v("Imprimir")])],1)])}))])])],1),t._v(" "),o("div",{attrs:{slot:"modal-footer"},slot:"modal-footer"})],1)],1)],1)},staticRenderFns:[]};var ot=o("VU/8")(tt,et,!1,function(t){o("hm6A")},null,null).exports,at={mounted:function(){var t=this;this.axios.get(this.API+"preorden/count").then(function(e){t.totalRows=e.data.total}),this.$route.query.idPreOrden&&this.$route.query.idCliente&&this.selectPreOrden({IdPreOrden:this.$route.query.idPreOrden,IdCliente:this.$route.query.idCliente})},data:function(){return{API:v.a.API,show:!1,filter:"",items:[],isBusy:!1,fields:["IdPreOrden","FechaReg","Cliente","DniRuc","imprimir"],totalRows:50,perPage:5,currentPage:1}},props:["idAlmacen"],methods:c()({},Object(d.b)({add:"agregarProducto",limpiar:"limpiarCarrito",obtenerStok:"obtenerStock"}),{cargarPreOrden:function(){this.show=!0,this.$refs.tablaPreOrden.refresh()},selectPreOrden:function(t){var e=this;this.axios.get(this.API+"preorden/detalle",{params:{idPreOrden:t.IdPreOrden}}).then(function(o){e.limpiar(),o.data.map(function(t){t.EsHabitacion||(e.add([t.IdProducto,function(){e.obtenerStok({IdAlmacen:e.idAlmacen})},{setPrecio:!0,cantidad:t.Cantidad,precio:t.Precio}]),e.filter="",e.show=!1)}),e.$emit("onPreOrden",t),e.$emit("onSelectPreOrden",t.IdCliente)})},myProvider:function(t){var e=this;return this.axios.get(this.API+"preorden?limit="+t.perPage+"&page="+t.currentPage+"&filter="+t.filter).then(function(t){return e.items=t.data,e.items}).catch(function(t){return[]})}})},rt={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-button",{attrs:{variant:"outline-success"},on:{click:t.cargarPreOrden}},[t._v("Cargar Pre Orden")]),t._v(" "),o("b-form",[o("b-modal",{attrs:{id:"modalPreOrden",title:"Seleccionar Pre Orden",size:"lg","header-bg-variant":"dark",headerTextVariant:"light","body-bg-variant":"light","body-text-variant":"dark"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("b-form-input",{attrs:{placeholder:"Buscar"},on:{input:function(e){t.currentPage=1}},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),t._v(" "),o("b-table",{ref:"tablaPreOrden",attrs:{id:"my-table",striped:"",hover:"",busy:t.isBusy,filter:t.filter,items:t.myProvider,fields:t.fields,"per-page":t.perPage,"current-page":t.currentPage},on:{"update:busy":function(e){t.isBusy=e},"row-clicked":t.selectPreOrden},scopedSlots:t._u([{key:"imprimir",fn:function(e){return[o("b-btn",{attrs:{size:"sm",variant:"success",target:"_blank",href:"/imprimir/preorden.php?id="+e.item.IdPreOrden}},[t._v("Imprimir")])]}}])}),t._v(" "),o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"6"}},[o("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1),t._v(" "),o("div",{attrs:{slot:"modal-footer"},slot:"modal-footer"},[o("b-btn",{attrs:{size:"sm",variant:"secondary"},on:{click:function(e){t.show=!1}}},[t._v("\n                    Cerrar\n                ")])],1)],1)],1)],1)},staticRenderFns:[]};var nt=o("VU/8")(at,rt,!1,function(t){o("1/mu")},null,null).exports,it={mounted:function(){this.$emit("mounted",this.$refs.formProformaModal)},watch:{items:function(){var t=this;this.axios.get(this.API+"proformas/count").then(function(e){t.totalRows=e.data.total})}},data:function(){return{API:v.a.API,show:!1,filter:"",items:[],isBusy:!1,fields:[{key:"IdProforma",label:"Id"},{key:"Anio",label:"Año"},"Numero","Cliente",{key:"DniRuc",label:"Documento"},"FechaReg",{key:"UsuarioReg",label:"Empleado"},"ver"],totalRows:50,perPage:5,currentPage:1}},props:["idAlmacen"],methods:c()({},Object(d.b)({add:"agregarProducto",obtenerStok:"obtenerStock",limpiarCarrito:"limpiarCarrito"}),{selectProformas:function(t){var e=this;this.axios.get(this.API+"proformas/detalle",{params:{idProforma:t.IdProforma}}).then(function(o){o.data.map(function(t){e.add([t.IdProducto,function(){e.obtenerStok({IdAlmacen:e.idAlmacen||1})},{setPrecio:!0,cantidad:t.Cantidad}]),e.filter="",e.show=!1}),t.productos=o.data,e.$emit("onSelectProforma",t.IdCliente,t),e.limpiarCarrito()})},myProvider:function(t){var e=this;return this.axios.get(this.API+"proformas?limit="+t.perPage+"&page="+t.currentPage+"&filter="+t.filter).then(function(t){return e.items=t.data,e.items}).catch(function(t){return[]})}})},st={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-button",{attrs:{variant:"outline-primary",size:"sm"},on:{click:function(e){t.show=!0}}},[t._v("Ver Proformas")]),t._v(" "),o("b-form",{ref:"formProformaModal"},[o("b-modal",{attrs:{id:"modalProformas",title:"Buscar Proforma",size:"lg","header-bg-variant":"dark",headerTextVariant:"light","body-bg-variant":"light","body-text-variant":"dark"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("b-form-input",{attrs:{placeholder:"Buscar"},on:{input:function(e){t.currentPage=1}},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),t._v(" "),t.show?o("b-table",{attrs:{id:"table-proformas",striped:"",hover:"",busy:t.isBusy,filter:t.filter,items:t.myProvider,fields:t.fields,"per-page":t.perPage,"current-page":t.currentPage},on:{"update:busy":function(e){t.isBusy=e},"row-clicked":t.selectProformas},scopedSlots:t._u([{key:"ver",fn:function(e){return[o("b-button",{attrs:{href:"/nuevo/index.html#/reportes/proforma/"+e.item.IdProforma,variant:"primary",target:"_blank"}},[t._v("Ver")])]}}])}):t._e(),t._v(" "),o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"6"}},[o("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1),t._v(" "),o("div",{attrs:{slot:"modal-footer"},slot:"modal-footer"},[o("b-btn",{attrs:{size:"sm",variant:"secondary"},on:{click:function(e){t.show=!1}}},[t._v("\n                    Cerrar\n                ")])],1)],1)],1)],1)},staticRenderFns:[]};var ct=o("VU/8")(it,st,!1,function(t){o("MdlM")},null,null).exports,lt={beforeMount:function(){this.initForm()},mounted:function(){this.getVendedor(),this.loadClienteVarios()},data:function(){return{dni:"",adelanto:0,newDniRuc:"",ultimaVenta:"",inProgress:!1,API:v.a.API,puntosAplicados:0,descuentoPuntos:{},descuentoGeneral:0,tieneIgv:!1,venta:{},carrito:{fields:[{key:"manoobra",label:"Mano de obra",class:"text-center"},{key:"stock",label:"Stock",variant:"info",class:"text-center"},{key:"Producto"},{key:"Descripcion",label:"Descripción"},{key:"eventPres",label:""},{key:"cantxPrecio",variant:"warning"},{key:"cantidad"},{key:"precio",label:"Precio"},{key:"utilidad",label:"Porcentaje Utilidad %"},{key:"subtotal",label:"SubTotal",variant:"success",class:"text-center"},{key:"descuento",label:"Descuento"},{key:"total",label:"Total",variant:"danger",class:"text-center"},{key:"acciones",label:""}]}}},watch:{totalCart:function(t){this.venta.pago.efectivo.monto=t-(parseFloat(this.venta.pago.visa.monto)+parseFloat(this.venta.pago.mastercard.monto))}},computed:c()({},Object(d.c)({productos:function(t){return t.cart.productos},totalCart:function(t){return t.cart.totalCart}}),{manoDeObraBruta:function(){var t=this.productos.find(function(t){return"MANODEOBRA"===t.CodigoBarra});return t?t.precioBruta:0},manoDeObraNeta:function(){var t=this.productos.find(function(t){return"MANODEOBRA"===t.CodigoBarra});return t?t.precio:0}}),methods:c()({},Object(d.b)({aplicarDescuento:"aplicarDescuentoGeneral",limpiarCart:"limpiarCarrito",obtenerStok:"obtenerStock",actualizarPrecioConvenio:"actualizarPrecioConvenio"}),{loadClienteVarios:function(){var t=this;this.axios.get(this.API+"clientes/00000000").then(function(e){e.data.IdCliente&&t.setCliente(e.data)})},prevent:function(t){"TEXTAREA"!==t.target.tagName&&t.preventDefault()},selectPreOrden:function(t){var e=this;this.venta.IdPreOrden.push(t),this.axios.get(this.API+"preorden/cajaybanco",{params:{IdPreOrden:t.IdPreOrden}}).then(function(t){var o=0;t.data.map(function(t){console.log(t),0==t.Tipo&&(o+=t.Importe)}),e.adelanto=o})},loadFirstAlmacen:function(){var t=this;this.axios.get(this.API+"almacenes/primero").then(function(e){t.$refs.inputAlmacen.setValue(e.data.Almacen),t.venta.almacen=e.data})},loadClienteBarcode:function(t){t.preventDefault();var e=this.dni;e&&this.setCliente(!1,e)},focusAutocomplete:function(t){this.$refs[t].handleDoubleClick()},initForm:function(){this.venta={EsCredito:0,Serie:"",Numero:"",cliente:{},comisionista:{},tipoVenta:{IdTipoDoc:7,TipoDoc:"BOLETA ELEC.",LimitItems:0,CodSunat:"03"},almacen:{IdAlmacen:1,Almacen:"HUANUCO"},puntoVenta:{IdDocVentaPuntoVenta:1,PuntoVenta:"HUANUCO"},vendedor:{},FechaCredito:this.$moment().format("YYYY-MM-DD"),FechaDoc:this.$moment().format("YYYY-MM-DDTH:mm:ss"),pago:{efectivo:{IdMetodoPago:1,monto:0},visa:{IdMetodoPago:2,monto:0},mastercard:{IdMetodoPago:3,monto:0}},IdPreOrden:[],CampoDireccion:"Direccion"}},setTipoVenta:function(t){t.TieneIgv?this.tieneIgv=!0:this.tieneIgv=!1,this.$refs.inputTipoVenta.setValue(t.TipoDoc),this.venta.tipoVenta=t,this.getNumeroVenta()},loadAlmacen:function(t){var e=this;this.axios.get(this.API+"almacenes/id/"+t).then(function(t){e.setAlmacen(t.data)})},setAlmacen:function(t){this.venta.almacen=t,this.$refs.inputAlmacen.setValue(t.Almacen),this.obtenerStok({IdAlmacen:this.venta.almacen.IdAlmacen})},loadPuntoVenta:function(t){var e=this;this.axios.get(this.API+"puntoventa/id/"+t).then(function(t){e.setPuntoVenta(t.data),e.getNumeroVenta()})},getTipoDoc:function(t){var e=this;this.axios.get(this.API+"tipodoc/"+t).then(function(t){t.data&&e.setTipoVenta(t.data)})},setPuntoVenta:function(t){this.venta.puntoVenta=t,this.$refs.inputPuntoVenta.setValue(t.PuntoVenta),this.getNumeroVenta()},getVendedor:function(){var t=this,e=sessionStorage.getItem("User");this.axios.get(this.API+"usuarios/"+e).then(function(e){t.setVendedor(e.data),t.$refs.inputVendedor.setValue(e.data.NombreUsuario),t.$refs.inputVendedor.$refs.input.disabled=!0,t.loadAlmacen(e.data.IdAlmacen),t.loadPuntoVenta(e.data.IdDocVentaPuntoVenta),t.$refs.inputAlmacen.$refs.input.disabled=!0,t.$refs.inputPuntoVenta.$refs.input.disabled=!0,t.getTipoDoc(e.data.IdTipoDoc)}).catch(function(e){console.log(e),t.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})},setVendedor:function(t){t.IdTipoDoc&&this.getTipoDoc(t.IdTipoDoc),this.venta.vendedor=t},setComisionista:function(t){"object"===(void 0===t?"undefined":G()(t))?(this.$refs.inputComisionista.setValue(t.Cliente),this.venta.comisionista=t):this.venta.comisionista={}},setCliente:function(t){var e=this,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a={};a=o?{dni:o}:{idCliente:t},"object"===(void 0===t?"undefined":G()(t))?(this.$refs.inputCliente.setValue(t.Cliente),this.venta.cliente=t):this.axios.get(this.API+"cliente",{params:a}).then(function(t){t.data?(e.$refs.inputCliente.setValue(t.data.Cliente),e.venta.cliente=t.data):e.$toasted.show("No se encontro al cliente")}).catch(function(t){console.log(t)}),this.actualizarPrecioConvenio(t)},onSetProducto:function(t,e){if(e){t.cantidad=e;var o=JSON.parse(t.PreciosPorProducto).find(function(t){return t.cantidad===e});return t.precio=o.precio||0,t}return t.cantidad=1,t.precio=t.PrecioContado||0,t},onAddProducto:function(t){this.actualizarDescuento(),this.obtenerStok({IdAlmacen:this.venta.almacen.IdAlmacen})},actualizarDescuento:function(){this.puntosAplicados>0&&this.aplicarPuntos(this.puntosAplicados),this.descuentoGeneral>0&&this.aplicarDescuentoGeneral(this.descuentoGeneral)},aplicarPuntos:function(t){var e=this;parseFloat(t)>this.venta.cliente.Puntos&&(this.puntosAplicados=this.venta.cliente.Puntos),this.axios.get(this.API+"ventas/descuento/"+this.puntosAplicados).then(function(t){e.descuentoPuntos=t.data,e.aplicarDescuento(t.data.descuento)}).catch(function(t){console.log(t),e.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})},aplicarDescuentoGeneral:function(t){this.puntosAplicados=0,this.aplicarDescuento(t)},getNumeroVenta:function(){var t=this;this.axios.get(this.API+"ventas/numero",{params:{idPuntoVenta:this.venta.puntoVenta.IdDocVentaPuntoVenta,idTipoDoc:this.venta.tipoVenta.IdTipoDoc}}).then(function(e){t.venta.Serie=e.data.serie,t.venta.Numero=e.data.numero}).catch(function(e){console.log(e),t.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})},updateTime:function(){this.venta.FechaDoc=this.$moment().format("YYYY-MM-DDTH:mm:ss")},limpiarDespuesVenta:function(){this.inProgress=!1,this.tieneIgv=!1,this.initForm(),this.limpiarCart(),this.getVendedor(),this.$refs.inputCliente.setValue("")},guardarProforma:function(){var t=this;return this.productos.length?this.venta.cliente.IdCliente?this.venta.vendedor.Usuario?(this.venta.productos=this.productos,void this.axios.post(this.API+"proformas",this.venta).then(function(e){t.$toasted.show("Proforma Guardada con exito"),t.limpiarDespuesVenta(),window.open("/nuevo/index.html#/reportes/proforma/"+e.data.insertId,"_blank")}).catch(function(e){console.log(e),t.$toasted.show("Ha ocurrido un error, vuelva a intentarlo"),t.inProgress=!1})):(this.$toasted.show("Debe seleccionar un vendedor"),void(this.inProgress=!1)):(this.$toasted.show("Debe seleccionar un cliente"),void(this.inProgress=!1)):(this.$toasted.show("No hay productos para crear la proforma"),void(this.inProgress=!1))},guardarVenta:function(t){var e=this;t.preventDefault(),this.inProgress=!0;var o=0;if(o+=parseFloat(this.venta.pago.efectivo.monto),o+=parseFloat(this.venta.pago.visa.monto),o+=parseFloat(this.venta.pago.mastercard.monto),!this.venta.EsCredito&&this.totalCart!=o)return this.$toasted.show("Los pagos no coinciden con la venta"),void(this.inProgress=!1);if(!this.venta.cliente.DniRuc)return this.$toasted.show("Debe seleccionar un cliente."),void(this.inProgress=!1);if(!H()(parseInt(this.venta.cliente.DniRuc)))return this.$toasted.show("El RUC debe ser numérico, editar cliente."),void(this.inProgress=!1);if(!(this.venta.cliente.DniRuc.length>9)&&"01"==this.venta.tipoVenta.CodSunat)return this.$toasted.show("Una factura debe ser emitida para una empresa, no un usuario común."),void(this.inProgress=!1);if(!this.productos.length)return this.$toasted.show("No hay productos para vender"),void(this.inProgress=!1);var a=0;return this.productos.forEach(function(t){t.stock<=0&&1,parseFloat(t.total)<=0&&(a+=1)}),a>=1?(this.$toasted.error("No se puede enviar un producto en S/. 0.00"),void(this.inProgress=!1)):this.totalCart<=0?(this.$toasted.show("La venta en S/. 0.00 no está permitido"),void(this.inProgress=!1)):(this.venta.productos=this.productos,this.venta.puntosAplicados=this.puntosAplicados||0,this.venta.totalCart=this.totalCart||0,this.venta.PagoCon=this.$refs.carrito.pagocon,void this.axios.post(this.API+"ventas",this.venta).then(function(t){e.$router.replace("/ventas"),e.$toasted.show("Venta realizada con exito"),e.inProgress=!1,e.tieneIgv=!1,e.ultimaVenta=t.data.insertId,e.initForm(),e.limpiarCart(),e.getVendedor(),e.getNumeroVenta(),e.$refs.inputTipoVenta.setValue("BOLETA ELEC."),e.$refs.inputAlmacen.setValue("VENTA"),e.$refs.inputPuntoVenta.setValue("CAJA1"),e.$refs.inputCliente.setValue(""),e.$refs.inputVendedor.setValue(""),e.$refs.inputComisionista.setValue(""),window.open("/imprimir/index.php?IdDocVenta="+t.data.insertId,"_blank")}).catch(function(t){console.log(t),e.$toasted.show("Ha ocurrido un error, vuelva a intentarlo"),e.inProgress=!1}))},eliminarCliente:function(){this.$refs.inputCliente.setValue(""),this.venta.cliente={}},eliminarComisionista:function(){this.$refs.inputComisionista.setValue(""),this.venta.comisionista={}}}),components:{ProductosCarrito:w,ClientesForm:Z,ConfigVenta:Q,PagoDeuda:ot,PreOrdenLista:nt,Proformas:ct}},ut={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[t._e(),t._v(" "),o("br"),t._v(" "),o("b-container",{staticClass:"bv-example-row"},[o("div",[o("div",{staticClass:"float-right"},[o("b-button-group",{attrs:{size:"sm"}},[o("pago-deuda")],1),t._v(" "),o("b-button-group",{attrs:{size:"sm"}},[o("proformas",{attrs:{idAlmacen:t.venta.almacen.IdAlmacen},on:{onSelectProforma:t.setCliente}})],1),t._v(" "),o("b-button-group",{attrs:{size:"sm"}},[o("pre-orden-lista",{directives:[{name:"show",rawName:"v-show",value:!this.$route.query.idPreOrden,expression:"!this.$route.query.idPreOrden"}],attrs:{idAlmacen:t.venta.almacen.IdAlmacen},on:{onSelectPreOrden:t.setCliente,onPreOrden:t.selectPreOrden}})],1),t._v(" "),o("b-button-group",{attrs:{size:"sm"}},[o("config-venta",{on:{onUpdateConfig:t.eliminarCliente,onUpdateConfigComision:t.eliminarComisionista}})],1)],1)]),t._v(" "),o("br"),o("br"),t._v(" "),o("b-form",{on:{submit:t.guardarVenta,keydown:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.prevent(e):null}}},[o("b-row",[o("b-col",{attrs:{md:"7"}},[o("b-row",[o("b-col",{attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Tipo de Venta:")]),t._v(" "),o("autocomplete",{ref:"inputTipoVenta",attrs:{required:"required",url:t.API+"ventas/tipos",anchor:"TipoDoc",initValue:"BOLETA ELEC.",label:"writer",placeholder:"","on-select":t.setTipoVenta,onFocus:t.focusAutocomplete.bind(null,"inputTipoVenta"),classes:{input:"form-control"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Almacen:")]),t._v(" "),o("autocomplete",{ref:"inputAlmacen",attrs:{required:"required",url:t.API+"almacenes",anchor:"Almacen",initValue:"HUANUCO",label:"writer",placeholder:"","on-select":t.setAlmacen,onFocus:t.focusAutocomplete.bind(null,"inputAlmacen"),classes:{input:"form-control"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Punto de Venta:")]),t._v(" "),o("autocomplete",{ref:"inputPuntoVenta",attrs:{required:"required",url:t.API+"ventas/puntos",anchor:"PuntoVenta",initValue:"HUANUCO",label:"writer",placeholder:"","on-select":t.setPuntoVenta,onFocus:t.focusAutocomplete.bind(null,"inputPuntoVenta"),classes:{input:"form-control"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"12"}},[o("b-form-group",[o("label",[t._v("Cliente:")]),t._v(" "),o("b-input-group",[t.venta.cliente.IdCliente?o("clientes-form",{attrs:{txtButton:"Editar",idModal:"editCliente",editCliente:t.venta.cliente},on:{onAddCliente:t.setCliente}}):t._e(),t._v(" "),o("autocomplete",{ref:"inputCliente",attrs:{required:"required",url:t.API+"clientes",anchor:"ClienteDniRuc",label:"writer",placeholder:"",onInput:function(e){return t.newDniRuc=e},"on-select":t.setCliente,onFocus:t.focusAutocomplete.bind(null,"inputCliente"),classes:{input:"form-control"}}}),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.dni,expression:"dni"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Codigo de Barra"},domProps:{value:t.dni},on:{keydown:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?(e.preventDefault(),t.loadClienteBarcode(e)):null},input:function(e){e.target.composing||(t.dni=e.target.value)}}}),t._v(" "),o("b-input-group-append",[o("clientes-form",{attrs:{ruc:t.newDniRuc},on:{onAddCliente:t.setCliente}})],1)],1),t._v(" "),t.venta.cliente.IdCliente?o("b-form-select",{staticClass:"mb-3",model:{value:t.venta.CampoDireccion,callback:function(e){t.$set(t.venta,"CampoDireccion",e)},expression:"venta.CampoDireccion"}},[o("option",{attrs:{value:"Direccion"}},[t._v(t._s(t.venta.cliente.Direccion))]),t._v(" "),o("option",{attrs:{value:"Direccion2"}},[t._v(t._s(t.venta.cliente.Direccion2))]),t._v(" "),o("option",{attrs:{value:"Direccion3"}},[t._v(t._s(t.venta.cliente.Direccion3))])]):t._e()],1)],1)],1)],1),t._v(" "),o("b-col",{attrs:{md:"3"}},[t.venta.cliente.Cliente?o("b-form-group",{staticClass:"text-center"},[o("div",{staticClass:"puntos"},[t._v("\n                            "+t._s(t._f("redondeoMenor")(t.venta.cliente.Puntos||0))+"\n                        ")]),t._v("\n                        Puntos del cliente\n                    ")]):t._e(),t._v(" "),t.venta.cliente.Puntos&&0==t.descuentoGeneral?o("b-input-group",{attrs:{prepend:"Puntos",append:t._f("redondear")(t.descuentoPuntos.descuento)}},[o("b-form-input",{attrs:{min:"0",max:t.venta.cliente.Puntos,type:"number"},on:{input:t.aplicarPuntos},model:{value:t.puntosAplicados,callback:function(e){t.puntosAplicados=e},expression:"puntosAplicados"}})],1):t._e(),t._v(" "),t.descuentoPuntos.ValorPunto?o("b-form-text",[t._v("\n                       1 Punto equivale a: S/ "+t._s(t._f("redondear")(t.descuentoPuntos.ValorPunto))+"\n                    ")]):t._e(),t._v(" "),t.venta.cliente.EsVIP?o("b-form-text",[t._v("\n                       Cliente VIP con Precio Convenio\n                    ")]):t._e()],1),t._v(" "),o("b-col",{attrs:{md:"2"}},[o("b-form-group",{staticClass:"text-center"},[o("div",{staticClass:"big-text"},[t._v("\n                            "+t._s(t.venta.Serie)+" - "),o("b",[t._v(t._s(t.venta.Numero))])]),t._v("\n                        "+t._s(t.venta.FechaDoc)+"\n                    ")]),t._v(" "),o("b-form-group",[o("label",[t._v("Vendedor:")]),t._v(" "),o("autocomplete",{ref:"inputVendedor",attrs:{required:"required",url:t.API+"usuarios",anchor:"NombreUsuario",label:"writer","on-select":t.setVendedor,onFocus:t.focusAutocomplete.bind(null,"inputVendedor"),classes:{input:"form-control"}}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Comisionista")]),t._v(" "),o("autocomplete",{ref:"inputComisionista",attrs:{required:"required",url:t.API+"comisionistas",anchor:"ClienteDniRuc",label:"writer",placeholder:"Comisionista",onInput:function(e){return t.newDniRuc=e},"on-select":t.setComisionista,onFocus:t.focusAutocomplete.bind(null,"inputComisionista"),classes:{input:"form-control"}}})],1),t._v(" "),t.adelanto?o("b-badge",{attrs:{variant:"info"}},[t._v("Adelanto de: S/ "+t._s(t.adelanto))]):t._e()],1)],1),t._v(" "),o("b-row",[o("b-col",[o("productos-carrito",{ref:"carrito",attrs:{igvTotal:t.tieneIgv,setPrecio:!0,showButton:!1,fields:t.carrito.fields,isVentas:!0,idAlmacen:t.venta.almacen.IdAlmacen,onSetProducto:t.onSetProducto},on:{onInputCantidad:t.actualizarDescuento,onAddProducto:t.onAddProducto,onRemoveProducto:t.actualizarDescuento}},[o("template",{slot:"operaciones"},[o("table",{staticClass:"table b-table border table-footer"},[o("tbody",[o("tr",[o("td",{staticClass:"text-center"},[t._v("Opciones")])]),t._v(" "),0==t.puntosAplicados?o("tr",[o("td",[o("b-input-group",{attrs:{prepend:"S/",append:"Descuento"}},[o("b-form-input",{attrs:{min:"0",value:"0",type:"number"},on:{input:t.aplicarDescuentoGeneral},model:{value:t.descuentoGeneral,callback:function(e){t.descuentoGeneral=e},expression:"descuentoGeneral"}})],1),t._v(" "),o("b-form-text",[t._v("\n                                                Descuento general a toda la venta.\n                                            ")])],1)]):t._e(),t._v(" "),o("tr",[o("td",[o("b-form-checkbox",{attrs:{value:1,"unchecked-value":0},model:{value:t.venta.EsCredito,callback:function(e){t.$set(t.venta,"EsCredito",e)},expression:"venta.EsCredito"}},[t._v("\n                                                Venta a credito\n                                            ")]),t._v(" "),t.venta.EsCredito?o("b-form-input",{attrs:{type:"date"},model:{value:t.venta.FechaCredito,callback:function(e){t.$set(t.venta,"FechaCredito",e)},expression:"venta.FechaCredito"}}):t._e()],1)])])])]),t._v(" "),t.venta.EsCredito?t._e():o("template",{slot:"metodopago"},[o("table",{staticClass:"table b-table border table-footer table-sm"},[o("tbody",[o("tr",[o("td",{staticClass:"text-center",attrs:{colspan:"3"}},[t._v("Metodo de Pago")])]),t._v(" "),o("tr",[o("td",[t._v("Efectivo")]),t._v(" "),o("td",[o("b-form-input",{attrs:{type:"text",placeholder:"Descripcion"},model:{value:t.venta.pago.efectivo.descripcion,callback:function(e){t.$set(t.venta.pago.efectivo,"descripcion",e)},expression:"venta.pago.efectivo.descripcion"}})],1),t._v(" "),o("td",[o("b-form-input",{attrs:{min:"0",step:"0.01",type:"number",placeholder:"S/."},model:{value:t.venta.pago.efectivo.monto,callback:function(e){t.$set(t.venta.pago.efectivo,"monto",e)},expression:"venta.pago.efectivo.monto"}})],1)]),t._v(" "),o("tr",[o("td",[t._v("Visa")]),t._v(" "),o("td",[o("b-form-input",{attrs:{type:"text",placeholder:"Descripcion"},model:{value:t.venta.pago.visa.descripcion,callback:function(e){t.$set(t.venta.pago.visa,"descripcion",e)},expression:"venta.pago.visa.descripcion"}})],1),t._v(" "),o("td",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.venta.pago.visa.monto,expression:"venta.pago.visa.monto"}],staticClass:"form-control",attrs:{min:"0",step:"0.01",type:"number",placeholder:"S/."},domProps:{value:t.venta.pago.visa.monto},on:{input:[function(e){e.target.composing||t.$set(t.venta.pago.visa,"monto",e.target.value)},function(e){t.venta.pago.efectivo.monto=t.$options.filters.redondear(t.totalCart-t.venta.pago.mastercard.monto-e.target.value)}]}})])]),t._v(" "),o("tr",[o("td",[t._v("Mastercard")]),t._v(" "),o("td",[o("b-form-input",{attrs:{type:"text",placeholder:"Descripcion"},model:{value:t.venta.pago.mastercard.descripcion,callback:function(e){t.$set(t.venta.pago.mastercard,"descripcion",e)},expression:"venta.pago.mastercard.descripcion"}})],1),t._v(" "),o("td",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.venta.pago.mastercard.monto,expression:"venta.pago.mastercard.monto"}],staticClass:"form-control",attrs:{min:"0",step:"0.01",type:"number",placeholder:"S/."},domProps:{value:t.venta.pago.mastercard.monto},on:{input:[function(e){e.target.composing||t.$set(t.venta.pago.mastercard,"monto",e.target.value)},function(e){t.venta.pago.efectivo.monto=t.$options.filters.redondear(t.totalCart-t.venta.pago.visa.monto-e.target.value)}]}})])])])])]),t._v(" "),t.venta.EsCredito?t._e():o("template",{slot:"adicional"},[o("table",{staticClass:"table b-table border table-footer table-sm text-center"},[o("tbody",[o("tr",[o("td",[t._v("Mano de obra bruta")])]),t._v(" "),o("tr",[o("td",[o("h3",[t._v(t._s(t._f("redondear")(t.manoDeObraBruta)))])])]),t._v(" "),o("tr",[o("td",[t._v("Mano de obra neta")])]),t._v(" "),o("tr",[o("td",[o("h3",{class:{"text-danger":t.manoDeObraNeta<=0}},[t._v(t._s(t._f("redondear")(t.manoDeObraNeta)))])])])])])])],2)],1)],1),t._v(" "),o("b-row",{staticClass:"text-center",attrs:{"align-h":"center"}},[o("b-col",{attrs:{cols:"8"}},[o("br"),t._v(" "),o("b-button",{attrs:{type:"button",disabled:t.inProgress,variant:"primary",size:"md"},on:{click:t.guardarProforma}},[t._v("Crear Proforma")]),t._v(" "),o("b-button",{attrs:{type:"submit",disabled:t.inProgress,variant:"success",size:"lg"}},[t._v("Efectuar Venta")]),t._v(" "),t.ultimaVenta?o("b-button",{attrs:{target:"_blank",variant:"info",size:"lg",href:"/imprimir/index.php?IdDocVenta="+t.ultimaVenta}},[t._v("Imprimir última Venta")]):t._e(),t._v(" "),o("br"),t._v(" "),o("br")],1)],1)],1)],1)],1)},staticRenderFns:[]};var dt=o("VU/8")(lt,ut,!1,function(t){o("2OQm")},"data-v-79ad4089",null).exports,pt=o("//Fk"),vt=o.n(pt),mt=o("BO1k"),ft=o.n(mt),ht=o("Xxa5"),bt=o.n(ht),_t=o("exGp"),gt=o.n(_t),Pt=o("mvHQ"),Ct=o.n(Pt),It=o("woOf"),At=o.n(It),xt={mounted:function(){var t=this;this.axios.get(this.API+"ventas/count",{params:{idAlmacen:this.almacen.IdAlmacen}}).then(function(e){t.totalRows=e.data.total}),this.getVentasAcumuladas(),this.loadFirstAlmacen()},data:function(){return{API:v.a.API,imgCaptcha:!0,captcha:"",loading:!1,tipoDoc:{IdTipoDoc:1,CodSunat:"01"},estadoVenta:1,optionsEstado:[{value:"1",text:"PENDIENTE"},{value:"2",text:"EMITIDOS"},{value:"0",text:"ANULADOS"}],vendedor:"",fechaInicio:this.$moment().format("YYYY-MM-DD"),fechaFin:this.$moment().format("YYYY-MM-DD"),fechaReferencia:this.$moment().format("YYYY-MM-DD"),filters:{},filter:"",sortBy:"FechaDoc",sortDesc:!1,ventasAcumuladas:0,almacen:{IdAlmacen:1},pageOptions:[5,10,15,50,100],ventaSelect:{},ventaDetalleSelect:[],items:[],itemsDetalle:[],showVenta:!1,isBusy:!1,fields:[{key:"detalles",label:""},{key:"idDocVenta",label:"ID",sortable:!0},{key:"FechaDoc",label:"Fecha",sortable:!0},{key:"TipoDoc",label:"Documento",sortable:!0},{key:"Serie",label:"Serie",sortable:!0},{key:"Numero",sortable:!0},{key:"Cliente",sortable:!0},{key:"Anulado",label:"Anulado",sortable:!0},{key:"UsuarioReg",label:"Vendedor",sortable:!0},{key:"Total",sortable:!1,variant:"success",class:"text-center"},{key:"estado",sortable:!1,class:"text-center"},{key:"consulta",class:"text-center"}],totalRows:50,perPage:10,currentPage:1,itemsStatus:{},isBoleta:!1,itemsMotivoNota:[{value:null,text:"-- SELECCIONE EL MOTIVO --"},{value:"01",text:"ANULACION DE LA OPERACION"},{value:"02",text:"ANULACION POR ERROR EN EL RUC"}],notaIdMotivo:null,notaCredito:{}}},watch:{estadoVenta:function(t){},items:function(t){var e=this;t.length&&this.axios.get(this.API+"ventas/detalle",{params:{idDocVentas:t.map(function(t){return t.idDocVenta})}}).then(function(t){e.itemsDetalle=t.data,e.items.map(function(t){return t.productos=e.getDetalles(t.idDocVenta),t})}).catch(function(t){console.log(t)})}},computed:{},methods:{loadFirstAlmacen:function(t){var e=this;this.axios.get(this.API+"almacenes/primero").then(function(t){e.$refs.inputAlmacen.setValue(t.data.Almacen),e.setAlmacen(t.data)})},regenerarPDF:function(t){var e=this;this.$refs.tablaVentas.refresh(),this.loading=!0,this.axios.post(this.API+"generarpdfelectronico",{docVenta:t}).then(function(t){console.log(t),e.$toasted.success("El PDF fue generado nuevamente",{duration:7e3}),e.loading=!1})},regenerarXML:function(t){this.$refs.tablaVentas.refresh(),this.loading=!0,this.emitirElectronico(t,!0)},setFechaReferencia:function(t){this.fechaInicio=t,this.fechaFin=t},setTipoDoc:function(t){var e=this;console.log(t),this.tipoDoc=t,3==this.tipoDoc.CodSunat?(this.isBoleta=!0,this.fechaInicio=this.fechaReferencia,this.fechaFin=this.fechaReferencia):this.isBoleta=!1,Vue.nextTick(function(){e.$refs.tablaVentas.refresh()})},getStatus:function(t){var e=this.itemsStatus[t]||{};return e.Estado&&(e.image=2==e.Estado?"success.png":"error.png"),e},emitirNotaCredito:function(t){var e=this,o=At()({},t);this.loading=!0,o.codSunatModifica=o.CodSunat,o.nroComprobanteModifica=o.Serie+"-"+o.Numero,o.notaIdMotivo=this.notaIdMotivo,o.notaDescMotivo=this.itemsMotivoNota.filter(function(t){return t.value==e.notaIdMotivo})[0].text,o.CodSunat="07",o.Serie=this.notaCredito.serie,o.Numero=this.notaCredito.numero,console.log(Ct()(o)),this.axios.post(this.API+"emitirelectronico",{docVenta:o}).then(function(t){console.log(t),e.$toasted.success(t.data.msj_sunat,{duration:7e3}),e.notaIdMotivo=null,e.loading=!1})},emitirElectronico:function(t,e){var o=this;return gt()(bt.a.mark(function a(){var r,n,i,s,c,l,u,d;return bt.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(o.items.length){a.next=3;break}return o.$toasted.show("No hay documentos para emitir"),a.abrupt("return");case 3:if(o.loading=!0,r=[],"01"!=o.tipoDoc.CodSunat&&"03"!=o.tipoDoc.CodSunat){a.next=41;break}if(!t.idDocVenta||!e){a.next=14;break}return a.t0=r,a.next=10,o.axios.post(o.API+"emitirelectronico",{generarXml:!0,docVenta:t}).then(function(t){console.log(t),1==t.data.Estado?o.$toasted.error(""):o.$toasted.success("XML Generado")});case 10:a.t1=a.sent,a.t0.push.call(a.t0,a.t1),a.next=40;break;case 14:n=bt.a.mark(function t(e){return bt.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(1!=e.Estado){t.next=7;break}return console.log(Ct()(e)),t.t0=r,t.next=5,o.axios.post(o.API+"emitirelectronico",{docVenta:e}).then(function(t){if(console.log(t),1==t.data.Estado)o.$toasted.error(t.data.msj_sunat);else{o.$toasted.success(t.data.msj_sunat),Vue.set(o,"items",o.items.filter(function(t){return t.idDocVenta!==e.idDocVenta}));t.data.data.txtNRO_COMPROBANTE.split("-")[0],t.data.data.txtNRO_COMPROBANTE.split("-")[1]}Vue.set(o.itemsStatus,e.idDocVenta,t.data)});case 5:t.t1=t.sent,t.t0.push.call(t.t0,t.t1);case 7:case"end":return t.stop()}},t,o)}),i=!0,s=!1,c=void 0,a.prev=18,l=ft()(o.items);case 20:if(i=(u=l.next()).done){a.next=26;break}return d=u.value,a.delegateYield(n(d),"t2",23);case 23:i=!0,a.next=20;break;case 26:a.next=32;break;case 28:a.prev=28,a.t3=a.catch(18),s=!0,c=a.t3;case 32:a.prev=32,a.prev=33,!i&&l.return&&l.return();case 35:if(a.prev=35,!s){a.next=38;break}throw c;case 38:return a.finish(35);case 39:return a.finish(32);case 40:vt.a.all(r).then(function(t){o.loading=!1});case 41:o.tipoDoc.CodSunat;case 42:case"end":return a.stop()}},a,o,[[18,28,32,40],[33,,35,39]])}))()},eliminarElectronico:function(t){var e=this;if(1==confirm("¿Desea Anular la venta?")){if(this.loading=!0,"01"==this.tipoDoc.CodSunat){var o=prompt("Escriba el motivo por el cual desea dar de baja esta factura");o&&this.axios.post(this.API+"bajaelectronico",{facturas:[t],descripcion:o,codSunat:this.tipoDoc.CodSunat}).then(function(t){console.log(t),e.$toasted.show("Factura Anulada"),e.$refs.tablaVentas.refresh(),e.loading=!1})}"03"==this.tipoDoc.CodSunat&&this.axios.post(this.API+"emitirelectronicoboleta",{boletas:[t],statu:3,codSunat:this.tipoDoc.CodSunat,fechaReferencia:this.fechaReferencia}).then(function(t){console.log(t),e.$toasted.show("Boleta Anulada"),e.$refs.tablaVentas.refresh(),e.loading=!1})}},getDetalles:function(t){return this.itemsDetalle.filter(function(e){return e.IdDocVenta==t})},getVentasAcumuladas:function(){var t=this;this.filters.vendedor?this.axios.get(this.API+"ventas/usuario",{params:{usuario:this.vendedor.Usuario,fechaInicio:this.fechaInicio,fechaFin:this.fechaFin}}).then(function(e){t.ventasAcumuladas=e.data.total}):this.axios.get(this.API+"ventas/total",{params:{fechaInicio:this.fechaInicio,fechaFin:this.fechaFin}}).then(function(e){t.ventasAcumuladas=e.data.total})},focusAutocomplete:function(t){this.$refs[t].handleDoubleClick()},setAlmacen:function(t){var e=this;this.almacen=t,this.limpiarFiltros(),Vue.nextTick(function(){return e.$refs.tablaVentas.refresh()})},actualizarTabla:function(){this.$refs.tablaVentas.refresh()},myProvider:function(t){var e=this,o=this.API+"ventas?estado="+this.estadoVenta+"&idTipoDoc[]="+this.tipoDoc.IdTipoDoc+"&idAlmacen="+this.almacen.IdAlmacen+"&filter="+(t.filter||"")+"&sortBy="+t.sortBy;return o+="&sortDesc="+(t.sortDesc?1:0),console.log(o),this.axios.get(o).then(function(t){return e.items=t.data.map(function(t){return 1===t.Anulado&&(t._rowVariant="warning"),t}),e.items}).catch(function(t){return[]})},limpiarFiltros:function(){this.filters={},this.filter="",this.fechaInicio=this.$moment().format("YYYY-MM-DD"),this.fechaFin=this.$moment().format("YYYY-MM-DD")},generateFilter:function(t,e){this.filters[t]=e;var o="";for(var t in this.filters)o+="&filter["+t+"]="+this.filters[t];this.filter=o,this.getVentasAcumuladas()},exportarProductos:function(){},moverAEmitidos:function(t){var e=this;this.loading=!0,this.axios.post(this.API+"moveraemitidos",{idDocVenta:t.idDocVenta}).then(function(t){e.$refs.tablaVentas.refresh(),e.loading=!1})},cambiarAAnonimo:function(t){var e=this;1==confirm("¿Desea Cambiar a Cliente Anónimo?")&&(this.loading=!0,this.axios.post(this.API+"cambiaraanonimo",{idDocVenta:t.idDocVenta}).then(function(t){e.$refs.tablaVentas.refresh(),e.loading=!1}))},consultaElectronico:function(t){var e=this;console.log(t);var o="",a="",r=this.$moment(t.FechaDoc,"YYYY-MM-DD hh:mm:ss").format("DD/MM/YYYY");console.log(r),"03"==t.CodSunat&&(o="06"),"01"==t.CodSunat&&(a=t.Total,o="03"),this.imgCaptcha=!1,window.open("http://www.sunat.gob.pe/ol-ti-itconsvalicpe/ConsValiCpe.htm?accion=CapturaCriterioValidez&num_ruc=20573027125&tipocomprobante="+o+"&num_serie="+t.Serie+"&num_comprob="+t.Numero+"&fec_emision="+encodeURI(r)+"&codigo="+this.captcha+(a?"&cantidad="+a:"")),setTimeout(function(){e.imgCaptcha=!0,e.captcha=""},1e3)}},components:{ProductoKardex:j}},yt={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-container",{staticClass:"bv-example-row"},[o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"12"}},[o("b-row",[o("b-col",{attrs:{md:"2"}},[o("b-form-group",[o("label",[t._v("Almacen:")]),t._v(" "),o("autocomplete",{ref:"inputAlmacen",attrs:{required:"required",url:t.API+"almacenes",anchor:"Almacen",initValue:"",label:"writer",placeholder:"","on-select":t.setAlmacen,onFocus:t.focusAutocomplete.bind(null,"inputAlmacen"),classes:{input:"form-control"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"4"}},[o("b-form-group",{directives:[{name:"show",rawName:"v-show",value:t.isBoleta,expression:"isBoleta"}]},[o("label",[t._v("Fecha Referencia:")]),t._v(" "),o("b-form-input",{attrs:{type:"date",placeholder:""},on:{input:t.setFechaReferencia},model:{value:t.fechaReferencia,callback:function(e){t.fechaReferencia=e},expression:"fechaReferencia"}})],1),t._v(" "),o("b-form-group",{directives:[{name:"show",rawName:"v-show",value:!t.isBoleta,expression:"!isBoleta"}]},[o("label",[t._v("Fecha Inicio:")]),t._v(" "),o("b-form-input",{attrs:{type:"date",placeholder:""},on:{input:function(e){return t.generateFilter("fechaInicio",e)}},model:{value:t.fechaInicio,callback:function(e){t.fechaInicio=e},expression:"fechaInicio"}})],1),t._v(" "),o("b-form-group",{directives:[{name:"show",rawName:"v-show",value:!t.isBoleta,expression:"!isBoleta"}]},[o("label",[t._v("Fecha Fin:")]),t._v(" "),o("b-form-input",{attrs:{type:"date",placeholder:""},on:{input:function(e){return t.generateFilter("fechaFin",e)}},model:{value:t.fechaFin,callback:function(e){t.fechaFin=e},expression:"fechaFin"}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Tipo Comprobante:")]),t._v(" "),o("autocomplete",{ref:"inputTipoVenta",attrs:{required:"required",url:t.API+"ventas/tipos/electronicos",initValue:"",anchor:"TipoDoc",label:"writer",placeholder:"","on-select":t.setTipoDoc,onFocus:t.focusAutocomplete.bind(null,"inputTipoVenta"),classes:{input:"form-control"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"2"}},[o("b-form-group",{attrs:{label:"Estado"}},[o("b-form-select",{attrs:{options:t.optionsEstado},on:{input:function(e){t.$refs.tablaVentas.refresh()}},model:{value:t.estadoVenta,callback:function(e){t.estadoVenta=e},expression:"estadoVenta"}})],1),t._v(" "),o("br")],1)],1)],1)],1),t._v(" "),o("b-row",[o("b-col",{attrs:{md:"12"}},[o("b-table",{ref:"tablaVentas",attrs:{small:"",filter:t.filter,"sort-by":t.sortBy,"sort-desc":t.sortDesc,striped:"",hover:"",id:"tabla-ventas",busy:t.isBusy,items:t.myProvider,fields:t.fields,"per-page":t.perPage,"current-page":t.currentPage},on:{"update:sortBy":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"update:busy":function(e){t.isBusy=e}},scopedSlots:t._u([{key:"detalles",fn:function(e){return[o("b-button",{staticClass:"mr-2",attrs:{size:"sm"},on:{click:function(t){return t.stopPropagation(),e.toggleDetails(t)}}},[t._v("\n                  "+t._s(e.detailsShowing?"-":"+")+"\n                ")])]}},{key:"row-details",fn:function(e){return[o("b-card",[o("b-row",{staticClass:"mb-2"},[o("table",{staticClass:"table b-table table-sm prod-detalle"},[o("thead",[o("tr",[o("th",[t._v("Codigo")]),t._v(" "),o("th",[t._v("Producto")]),t._v(" "),o("th",[t._v("Cantidad")]),t._v(" "),o("th",[t._v("Precio")]),t._v(" "),o("th",[t._v("Descuento")]),t._v(" "),e.item.TieneIgv?o("th",[t._v("Subtotal")]):t._e(),t._v(" "),e.item.TieneIgv?o("th",[t._v("IGV")]):t._e(),t._v(" "),o("th",[t._v("Total")])])]),t._v(" "),o("tbody",t._l(t.getDetalles(e.item.idDocVenta),function(a,r){return o("tr",{key:r},[o("td",[t._v(t._s(a.CodigoBarra))]),t._v(" "),o("td",[t._v(t._s(a.Producto))]),t._v(" "),o("td",[t._v(t._s(a.Cantidad))]),t._v(" "),o("td",[t._v(t._s(a.Precio))]),t._v(" "),o("td",[t._v(t._s(a.Descuento))]),t._v(" "),e.item.TieneIgv?o("td",[t._v("\n                        "+t._s(t._f("redondear")(a.Subtotal/1.18))+"                          \n                      ")]):t._e(),t._v(" "),e.item.TieneIgv?o("td",[t._v("\n                        "+t._s(t._f("redondear")(a.Subtotal-a.Subtotal/1.18))+"\n                      ")]):t._e(),t._v(" "),o("td",[t._v(t._s(t._f("redondear")(a.Subtotal)))])])}))]),t._v(" "),o("b-button",{staticStyle:{"margin-left":"30px"},attrs:{variant:"primary",size:"sm"},on:{click:function(o){t.moverAEmitidos(e.item)}}},[t._v("Mover a emitidos")]),t._v(" "),o("b-button",{staticStyle:{"margin-left":"10px"},attrs:{variant:"primary",size:"sm"},on:{click:function(o){t.cambiarAAnonimo(e.item)}}},[t._v("Cambiar a cliente anónimo")])],1)],1)]}},{key:"estado",fn:function(e){return[o("div",{staticStyle:{display:"flex"}},[t.getStatus(e.item.idDocVenta).image&&2!=t.estadoVenta?o("img",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:t.getStatus(e.item.idDocVenta).msj_sunat,placement:"right",src:"static/"+t.getStatus(e.item.idDocVenta).image,width:"32",height:"32"}}):t._e(),t._v(" "),2==e.item.Estado?o("img",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],ref:"imgSuccess",attrs:{title:e.item.Msj_sunat,src:"static/success.png",width:"32",height:"32"}}):t._e(),t._v("\n                      \n                    "),0==t.estadoVenta?o("img",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:e.item.Msj_sunat+"\nDocumento Anulado",src:"static/cancel.png",height:"32"}}):t._e(),t._v(" "),2==t.estadoVenta?o("b-button",{attrs:{disabled:t.loading,variant:"danger",size:"sm"},on:{click:function(o){t.eliminarElectronico(e.item)}}},[t._v("Anular")]):t._e(),t._v("\n                    \n                      \n                    "),o("b-button",{attrs:{variant:"warning"},on:{click:function(o){t.regenerarXML(e.item)}}},[t._v("XML")]),t._v(" "),2==t.estadoVenta?o("b-button",{on:{click:function(o){t.regenerarPDF(e.item)}}},[t._v("PDF")]):t._e(),t._v("\n                      \n                    "),2==t.estadoVenta&&"01"==t.tipoDoc.CodSunat?o("b-button",{attrs:{id:"popover-nota"+e.index,disabled:t.loading,variant:"primary",size:"sm"}},[t._v("Nota Credito")]):t._e(),t._v(" "),2==t.estadoVenta&&"01"==t.tipoDoc.CodSunat?o("b-popover",{attrs:{target:"popover-nota"+e.index,title:"Emitir Nota Credito",placement:"top"}},[o("form",{on:{submit:function(o){o.preventDefault(),t.emitirNotaCredito(e.item)}}},[o("b-form-select",{staticClass:"mb-3",attrs:{options:t.itemsMotivoNota,size:"sm",required:""},model:{value:t.notaIdMotivo,callback:function(e){t.notaIdMotivo=e},expression:"notaIdMotivo"}}),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.notaCredito.serie,expression:"notaCredito.serie"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Serie",required:""},domProps:{value:t.notaCredito.serie},on:{input:function(e){e.target.composing||t.$set(t.notaCredito,"serie",e.target.value)}}}),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.notaCredito.numero,expression:"notaCredito.numero"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Numero",required:""},domProps:{value:t.notaCredito.numero},on:{input:function(e){e.target.composing||t.$set(t.notaCredito,"numero",e.target.value)}}}),t._v(" "),o("b-button",{attrs:{type:"submit",variant:"primary",size:"sm",disabled:t.loading}},[t._v("Emitir")])],1)]):t._e()],1)]}},{key:"consulta",fn:function(e){return[o("div",[o("div",{staticStyle:{width:"150px"}},[t.imgCaptcha?o("img",{staticStyle:{width:"80px",float:"left"},attrs:{id:"captcha",src:"http://www.sunat.gob.pe/ol-ti-itconsvalicpe/captcha?accion=image&nmagic=0"}}):t._e(),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.captcha,expression:"captcha"}],staticClass:"form-control",staticStyle:{width:"60px"},attrs:{type:"text"},domProps:{value:t.captcha},on:{input:function(e){e.target.composing||(t.captcha=e.target.value)}}})]),t._v(" "),o("b-button",{attrs:{disabled:t.loading,variant:"warning",size:"sm"},on:{click:function(o){t.consultaElectronico(e.item)}}},[t._v("Consulta SUNAT")])],1)]}}])})],1)],1),t._v(" "),o("br"),t._v(" "),o("b-row",{staticClass:"text-center",attrs:{"align-h":"center"}},[o("b-col",{attrs:{cols:"12"}},[1==t.estadoVenta?o("b-button",{attrs:{disabled:this.loading,variant:"success",size:"lg"},on:{click:t.emitirElectronico}},[t._v("Emitir Documentos Electronicas")]):t._e()],1)],1),t._v(" "),o("br"),o("br")],1),t._v(" "),o("b-modal",{attrs:{id:"kardex",size:"lg","modal-class":"modal-xl",title:"Kardex de producto"},model:{value:t.showVenta,callback:function(e){t.showVenta=e},expression:"showVenta"}},[o("b-alert",{attrs:{show:"",variant:"warning"}},[t._v("titulo")])],1)],1)},staticRenderFns:[]};var kt=o("VU/8")(xt,yt,!1,function(t){o("ZwEl")},null,null).exports,wt={data:function(){return{API:v.a.API,show:!1,cliente:{}}},props:["clienteSelect"],watch:{clienteSelect:function(t){this.cliente=At()({},t)}},methods:{consultarDNIRUC:function(){var t=this,e=this.cliente.DniRuc.length>8?"RUC":"DNI";this.axios.get(this.API+"consultarRUC",{params:{type:e,numero:this.cliente.DniRuc}}).then(function(o){if(o.data){t.$toasted.show("Cliente encontrado, se llenarán sus datos");var a=o.data;"DNI"==e?Vue.set(t.cliente,"Cliente",a.nombres+" "+a.apellidoPaterno+" "+a.apellidoMaterno):(Vue.set(t.cliente,"Cliente",a.razonSocial),Vue.set(t.cliente,"Direccion",a.direccion))}else t.$toasted.show("No se encontró el Usuario")}).catch(function(e){t.$toasted.show("No se encontró el Usuario"),console.log(e)})},guardarCliente:function(t){var e=this;t.preventDefault(),this.axios.post(this.API+"clientes",this.cliente).then(function(t){e.$emit("onAddCliente",t.data),e.$toasted.show("Cliente guardado correctamente"),e.$refs.clienteForm.hide()}).catch(function(t){e.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})}}},Dt={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-form",{on:{submit:t.guardarCliente}},[o("b-modal",{ref:"clienteForm",attrs:{id:"modal1",title:"Editar Cliente",size:"lg"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("b-row",[o("b-col",{attrs:{md:"12"}},[o("b-form-group",[o("label",[t._v("DNI / RUC:")]),t._v(" "),o("b-input-group",[o("b-form-input",{attrs:{required:"required"},model:{value:t.cliente.DniRuc,callback:function(e){t.$set(t.cliente,"DniRuc",e)},expression:"cliente.DniRuc"}}),t._v(" "),o("b-input-group-append",[o("b-btn",{attrs:{variant:"info"},on:{click:t.consultarDNIRUC}},[t._v("Buscar ")])],1)],1)],1),t._v(" "),o("b-form-group",[o("label",[t._v("Nombre del Cliente:")]),t._v(" "),o("b-form-input",{attrs:{required:"required",type:"text"},model:{value:t.cliente.Cliente,callback:function(e){t.$set(t.cliente,"Cliente",e)},expression:"cliente.Cliente"}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Nombre Comercial:")]),t._v(" "),o("b-form-input",{attrs:{required:"required",type:"text"},model:{value:t.cliente.NombreComercial,callback:function(e){t.$set(t.cliente,"NombreComercial",e)},expression:"cliente.NombreComercial"}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Dirección:")]),t._v(" "),o("b-form-input",{attrs:{type:"text"},model:{value:t.cliente.Direccion,callback:function(e){t.$set(t.cliente,"Direccion",e)},expression:"cliente.Direccion"}})],1)],1)],1),t._v(" "),o("b-row",[o("b-col",[o("b-form-group",[o("label",[t._v("Teléfono:")]),t._v(" "),o("b-form-input",{attrs:{type:"text"},model:{value:t.cliente.Telefono,callback:function(e){t.$set(t.cliente,"Telefono",e)},expression:"cliente.Telefono"}})],1)],1),t._v(" "),o("b-col",[o("b-form-group",[o("label",[t._v("Correo Electrónico:")]),t._v(" "),o("b-form-input",{attrs:{type:"email"},model:{value:t.cliente.Email,callback:function(e){t.$set(t.cliente,"Email",e)},expression:"cliente.Email"}})],1)],1)],1),t._v(" "),o("b-row",[o("b-col",[o("b-form-checkbox",{attrs:{id:"checkbox1",value:1,"unchecked-value":0},model:{value:t.cliente.EsVIP,callback:function(e){t.$set(t.cliente,"EsVIP",e)},expression:"cliente.EsVIP"}},[t._v("\n          Marcar si es un cliente VIP\n        ")])],1)],1),t._v(" "),o("b-row",[o("b-col",[o("b-form-checkbox",{attrs:{id:"checkbox2",value:1,"unchecked-value":0},model:{value:t.cliente.esComisionista,callback:function(e){t.$set(t.cliente,"esComisionista",e)},expression:"cliente.esComisionista"}},[t._v("\n          Marcar si es un comisionista\n        ")])],1)],1),t._v(" "),o("div",{attrs:{slot:"modal-footer"},slot:"modal-footer"},[o("b-btn",{attrs:{variant:"primary",type:"submit"}},[t._v("\n         Guardar\n       ")]),t._v(" "),o("b-btn",{attrs:{variant:"secondary"},on:{click:function(e){t.show=!1}}},[t._v("\n         Close\n       ")])],1)],1)],1)],1)},staticRenderFns:[]};var Vt={mounted:function(){var t=this;this.axios.get(this.API+"clientes/count").then(function(e){t.totalRows=e.data.total})},data:function(){return{API:v.a.API,pageOptions:[5,10,15,50,100],filter:null,sortBy:"IdCliente",sortDesc:!1,clienteSelect:{},items:[],isBusy:!1,fields:[{key:"Cliente",sortable:!0},{key:"DniRuc",sortable:!0},{key:"Direccion",sortable:!0},{key:"Puntos",sortable:!0},{key:"EsVIP",sortable:!0}],totalRows:50,perPage:10,currentPage:1}},methods:{rowClick:function(t,e){this.clienteSelect=t,this.$refs.clienteForm.show=!0},actualizarTabla:function(){this.$refs.tablaClientes.refresh()},nuevoCliente:function(){this.clienteSelect={},this.$refs.clienteForm.show=!0},myProvider:function(t){var e=this,o=this.API+"clientes?limit="+t.perPage+"&page="+t.currentPage+"&q="+(t.filter||"")+"&sortBy="+t.sortBy;return o+="&sortDesc="+(t.sortDesc?1:0),this.axios.get(o).then(function(t){return e.items=t.data,console.log(t.data),e.items}).catch(function(t){return[]})}},components:{ClienteForm:o("VU/8")(wt,Dt,!1,function(t){o("s40W")},null,null).exports}},$t={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-container",{staticClass:"bv-example-row"},[o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"6"}},[o("b-form-group",{staticClass:"mb-0",attrs:{horizontal:"",label:"Buscar"}},[o("b-input-group",[o("b-form-input",{attrs:{placeholder:"Buscar"},on:{input:function(e){t.currentPage=1}},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),t._v(" "),o("b-input-group-append",[o("b-btn",{attrs:{disabled:!t.filter},on:{click:function(e){t.filter=""}}},[t._v("Limpiar")])],1)],1)],1),t._v(" "),o("br")],1),t._v(" "),o("b-col",{staticClass:"my-1",attrs:{md:"6"}},[o("b-row",[o("b-col",{attrs:{md:"8"}},[o("b-form-group",{staticClass:"mb-0",attrs:{horizontal:"",label:"Mostrar"}},[o("b-form-select",{attrs:{options:t.pageOptions},on:{input:function(e){t.currentPage=1}},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"4"}},[o("p",{staticStyle:{"margin-top":"6px"}},[t._v("de "),o("b",{staticClass:"text-success"},[t._v(t._s(this.totalRows))]),t._v(" Clientes")])])],1)],1),t._v(" "),o("b-table",{ref:"tablaClientes",attrs:{small:"",filter:t.filter,"sort-by":t.sortBy,"sort-desc":t.sortDesc,striped:"",hover:"",id:"my-table",busy:t.isBusy,items:t.myProvider,fields:t.fields,"per-page":t.perPage,"current-page":t.currentPage},on:{"update:sortBy":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"row-clicked":t.rowClick,"update:busy":function(e){t.isBusy=e}}}),t._v(" "),o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"6"}},[o("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)],1),t._v(" "),o("cliente-form",{ref:"clienteForm",attrs:{clienteSelect:t.clienteSelect},on:{onAddCliente:t.actualizarTabla}}),t._v(" "),o("br"),t._v(" "),o("b-row",{staticClass:"text-center",attrs:{"align-h":"center"}},[o("b-col",{attrs:{cols:"4"}},[o("b-button",{attrs:{variant:"success",size:"lg"},on:{click:t.nuevoCliente}},[t._v("Nuevo")])],1)],1),t._v(" "),o("br"),o("br")],1)],1)},staticRenderFns:[]};var St=o("VU/8")(Vt,$t,!1,function(t){o("POZ1")},null,null).exports,Ft={mounted:function(){this.getProductos()},data:function(){return{API:v.a.API,productosACargar:[],productos:[]}},props:["idPreorden","idProducto"],computed:{sumProductos:function(){var t=0;return this.productos.map(function(e){t+=e.Cantidad*e.Precio||0}),t}},methods:{emitUpdate:function(){this.$emit("onUpdateProductos",this.productos)},getProductos:function(){var t=this;this.idPreorden&&this.axios.get(this.API+"preorden/detalle",{params:{idPreOrden:this.idPreorden}}).then(function(e){t.productos=e.data.map(function(e){return e.IdProducto===t.idProducto&&(e.isDisabled=!0),e}),t.productosACargar.map(function(e){t.productos.find(function(t){return t.IdProducto===e.IdProducto})||t.productos.push(e)})}).catch(function(t){console.log(t)})},renderChild:function(t){return"\n        <b>"+t.IdProducto+" - "+t.Producto+" - "+t.CodigoBarra+"</b>\n      "},addProducto:function(t){this.productos.findIndex(function(e){return e.IdProducto==t.IdProducto})>=0?this.$toasted.show("El producto ya está agregado"):t.EsHabitacion?this.$toasted.show("No puede ingresar este producto"):(t.Precio=t.PrecioContado,this.productos.push(t),this.emitUpdate())},quitarProducto:function(t){var e=this.productos.findIndex(function(e){return e.IdProducto==t.IdProducto});this.productos.splice(e,1),this.emitUpdate()},focusAutocomplete:function(t){this.$refs[t].handleDoubleClick()}}},Tt={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-form-group",[o("label",[t._v("Agrega Productos:")]),t._v(" "),o("b-input-group",[o("autocomplete",{ref:"inputProducto",attrs:{url:t.API+"productos",anchor:"Producto",onShouldRenderChild:t.renderChild,label:"writer",placeholder:"Seleccionar Producto","on-select":t.addProducto,onFocus:t.focusAutocomplete.bind(null,"inputProducto"),classes:{input:"form-control upper"}}})],1)],1),t._v(" "),o("table",{staticClass:"table b-table table-sm"},[t._m(0),t._v(" "),o("tbody",t._l(t.productos,function(e,a){return o("tr",{directives:[{name:"show",rawName:"v-show",value:!e.isDisabled,expression:"!prod.isDisabled"}],key:a,class:{"bg-secondary text-white":e.isDisabled}},[o("td",[t._v(t._s(e.IdProducto))]),t._v(" "),o("td",[t._v(t._s(e.Producto))]),t._v(" "),o("td",[o("span",{staticClass:"hideInModal"},[t._v(t._s(e.Precio))]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.Precio,expression:"prod.Precio"}],staticClass:"form-control",attrs:{disabled:e.isDisabled,step:"0.01",required:"",type:"number"},domProps:{value:e.Precio},on:{input:function(o){o.target.composing||t.$set(e,"Precio",o.target.value)}}})]),t._v(" "),o("td",[o("span",{staticClass:"hideInModal"},[t._v(t._s(e.Cantidad))]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.Cantidad,expression:"prod.Cantidad"}],staticClass:"form-control",attrs:{disabled:e.isDisabled,required:"",type:"number"},domProps:{value:e.Cantidad},on:{input:[function(o){o.target.composing||t.$set(e,"Cantidad",o.target.value)},t.emitUpdate]}})]),t._v(" "),o("td",{staticClass:"text-center"},[o("b-button",{attrs:{disabled:e.isDisabled,variant:"danger",size:"sm"},on:{click:function(o){t.quitarProducto(e)}}},[t._v("X")])],1)])}))])],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("thead",[o("tr",[o("th",[t._v("Id")]),t._v(" "),o("th",[t._v("Producto")]),t._v(" "),o("th",[t._v("Precio")]),t._v(" "),o("th",[t._v("Cantidad")]),t._v(" "),o("th",{staticClass:"text-center"},[t._v("Quitar")])])])}]};var Et={mounted:function(){this.getHabitaciones()},data:function(){return{API:v.a.API,show:!1,showPopover:!0,habitaciones:[],selectCliente:{},selectProducto:{},vuelo:"",fechaReserva:this.$moment().format("YYYY-MM-DD"),pisos:[1,2,3,4,5],adelantos:[],gastos:[],montoTotal:0,IdProforma:null,proformaTotal:null}},computed:{totalAdelantos:function(){var t=0;return this.adelantos.map(function(e){e.Tipo?t-=parseFloat(e.Importe):t+=parseFloat(e.Importe)}),t},totalGastos:function(){var t=0;return this.gastos.map(function(e){t+=parseFloat(e.Importe)}),t}},methods:{mountedProforma:function(t){document.body.appendChild(t)},selectProforma:function(t,e){var o=this;this.show=!0,this.$nextTick(function(){e.productos.map(function(t){o.$refs.preOrdenProductos.productosACargar.push(t)}),o.IdProforma=e.IdProforma})},cargarAdelantos:function(){var t=this;this.axios.get(this.API+"preorden/cajaybanco",{params:{IdPreOrden:this.selectProducto.IdPreOrden}}).then(function(e){t.adelantos=e.data})},insertarAdelanto:function(){var t=this,e=sessionStorage.getItem("User");this.selectProducto.Adelanto<=0||confirm("¿Desea Insertar un adelanto?")&&this.axios.post(this.API+"preorden/cajaybanco",{producto:this.selectProducto,concepto:"Adelanto Proyecto "+this.selectProducto.Producto+" - "+this.selectProducto.AdelantoDesc,IdPreOrden:this.selectProducto.IdPreOrden,IdHabitacion:this.selectProducto.IdProducto,Adelanto:this.selectProducto.Adelanto,Usuario:e}).then(function(e){t.cargarAdelantos()})},insertarGasto:function(){var t=this,e=sessionStorage.getItem("User");this.selectProducto.Gasto<=0||confirm("¿Desea Insertar un gasto?")&&this.axios.post(this.API+"preorden/cajaybanco/gasto",{producto:this.selectProducto,concepto:"Gasto Proyecto "+this.selectProducto.Producto+" - "+this.selectProducto.GastoDesc,IdPreOrden:this.selectProducto.IdPreOrden,IdHabitacion:this.selectProducto.IdProducto,Gasto:this.selectProducto.Gasto,Usuario:e}).then(function(e){t.cargarAdelantos()})},getHabitacionesPiso:function(t){return this.habitaciones.filter(function(e){return e.Piso===t})},guardarProductos:function(){var t=this;this.axios.post(this.API+"preorden/detalle",{IdPreOrden:this.selectProducto.IdPreOrden,IdHabitacion:this.selectProducto.IdProducto,productos:this.$refs.preOrdenProductos.productos,IdProforma:this.IdProforma}).then(function(e){t.$toasted.success("Guardado correctamente"),t.show=!1})},openCarrito:function(t){this.proformaTotal=null,this.selectProducto=t,this.$refs.modalCarrito.show(),this.cargarAdelantos(),this.cargarProformaTotal(this.selectProducto.IdProforma)},cargarProformaTotal:function(t){var e=this;t&&this.axios.get(this.API+"preorden/proforma",{params:{idProforma:t}}).then(function(t){e.proformaTotal=t.data.Total})},getHabitaciones:function(){var t=this;this.axios.get(this.API+"habitaciones?sortBy=Gen_Producto.Producto").then(function(e){t.habitaciones=e.data})},getVariant:function(t){return 2==t.EstadoHabitacion?"warning":3==t.EstadoHabitacion?"danger":1==t.EstadoHabitacion&&1==t.EstaSucio?"secondary":"success"},reservarHab:function(t){var e=this;this.selectCliente.Cliente||this.$toasted.error("Seleccione un cliente."),this.axios.post(this.API+"habitaciones/reservar",{IdProducto:t.IdProducto,IdCliente:this.selectCliente.IdCliente,FechaReserva:this.fechaReserva,Vuelo:this.vuelo}).then(function(o){e.getHabitaciones(),e.limpiarPopover(),e.limpiarDespues(),e.$toasted.success("La Habitación: "+t.Producto+" ha sido reservada"),e.showPopover=!1,e.$nextTick(function(){e.showPopover=!0})})},liberarHab:function(t){var e=this;confirm("¿Está seguro que desea liberar el proyecto? Asegurese de haber realizado la venta")&&this.axios.post(this.API+"habitaciones/liberar",{IdProducto:t.IdProducto}).then(function(o){e.getHabitaciones(),e.limpiarPopover(),e.$toasted.success("El proyecto: "+t.Producto+" está ahora disponible"),e.showPopover=!1,e.$nextTick(function(){e.showPopover=!0})})},alquilarHab:function(t){var e=this;this.selectCliente.Cliente||this.$toasted.error("Seleccione un cliente."),confirm("¿Está seguro que desea empezar el proyecto?")&&this.axios.post(this.API+"habitaciones/alquilar",{IdProducto:t.IdProducto,IdCliente:this.selectCliente.IdCliente,cliente:this.selectCliente}).then(function(o){e.getHabitaciones(),e.limpiarPopover(),e.limpiarDespues(),e.$toasted.success("El proyecto: "+t.Producto+" ha sido iniciado."),e.showPopover=!1,e.$nextTick(function(){e.showPopover=!0})})},setCliente:function(t,e){e>=0&&this.$refs["inputCliente2"+e][0].setValue(t.Cliente),this.selectCliente=t},limpiarPopover:function(){},limpiarDespues:function(){this.selectCliente={},this.selectProducto={}},formatFecha:function(t){return this.$moment(t,"YYYY-MM-DD hh:mm:ss").format("YYYY-MM-DD")},imprimir:function(){var t=window.open("","PRINT","height=600,width=1000");t.document.write('<head><link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"></head>'),t.document.write('<h5 style="text-align:center">'+document.querySelector("#carrito .modal-title").textContent+"</h5> <hr>"),t.document.write(document.getElementById("contentModal").innerHTML);for(var e=0;e<t.document.querySelectorAll("input, button, a").length;++e)t.document.querySelectorAll("input, button, a")[e].style.display="none";return t.document.getElementById("headerCamiones").className="col-md-12",t.document.getElementById("productosProduccion").className="col-md-8",t.document.close(),t.focus(),t.onload=function(){setTimeout(function(){t.print()},500)},!0},sumProductos:function(){return this.$refs.preOrdenProductos?this.totalAdelantos<0?(Math.abs(this.totalAdelantos)+this.$refs.preOrdenProductos.sumProductos).toFixed(2):(this.$refs.preOrdenProductos.sumProductos-this.totalAdelantos).toFixed(2):Math.abs(this.totalAdelantos).toFixed(2)}},components:{PreOrdenFormDet:o("VU/8")(Ft,Tt,!1,function(t){o("GqpO")},"data-v-802dafbe",null).exports,ClientesForm:Z,Proformas:ct}},Mt={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-container",{staticClass:"bv-example-row"},t._l(t.pisos,function(e,a){return o("div",{key:a,staticClass:"piso"},[t.getHabitacionesPiso(e).length?o("div",[o("br"),t._v(" "),o("b-alert",{staticClass:"text-center",attrs:{show:""}},[o("b",[t._v(t._s(1===e?"Huánuco":"Pucallpa"))])]),t._v(" "),o("br")],1):t._e(),t._v(" "),o("b-row",t._l(t.getHabitacionesPiso(e),function(e,r){return o("b-col",{key:r,staticClass:"habitacion",attrs:{md:"3"}},[o("b-card",{staticClass:"text-center",attrs:{"bg-variant":t.getVariant(e)}},[o("h5",[t._v(t._s(e.Producto))]),t._v(" "),o("h5",[t._v(t._s(e.Cliente))]),t._v(" "),o("h5",[t._v("S/ "+t._s(t._f("moneda")(e.granTotalCalculado)))]),t._v(" "),2==e.EstadoHabitacion?o("ul",{staticClass:"detalle"},[o("li",[o("b",[t._v(t._s(e.Cliente))])]),t._v(" "),o("li",{staticClass:"text-warning"},[o("b",[t._v("FECHA: "+t._s(t.formatFecha(e.FechaReserva)))])]),t._v(" "),e.vuelo?o("li",[o("br"),t._v("Vuelo: "+t._s(e.Vuelo))]):t._e()]):t._e(),t._v(" "),3==e.EstadoHabitacion?o("ul",{staticClass:"detalle"},[o("li",{staticClass:"text-warning"},[o("b",[t._v("FECHA: "+t._s(e.FechaAlquiler)+" - "+t._s(e.FechaAlquilerFin))])])]):t._e(),t._v(" "),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("b-btn",{attrs:{variant:"success",size:"sm"},on:{click:function(o){t.liberarHab(e)}}},[t._v("Liberar")]),t._v(" "),o("b-btn",{attrs:{id:a+"popover-alquilar"+r,variant:"danger",size:"sm"}},[t._v("Empezar")]),t._v(" "),t.showPopover?o("b-popover",{attrs:{target:a+"popover-alquilar"+r,title:"Empezar Proyecto"}},[o("label",[t._v("Seleccione un cliente:")]),t._v(" "),o("b-input-group",[o("autocomplete",{ref:"inputCliente2"+r,refInFor:!0,attrs:{required:"required",url:t.API+"clientes",anchor:"ClienteDniRuc",label:"writer",placeholder:"","on-select":t.setCliente,classes:{input:"form-control"}}}),t._v(" "),o("b-input-group-append",[o("clientes-form",{on:{onAddCliente:function(e){t.setCliente(e,r)}}})],1)],1),t._v(" "),o("br"),t._v(" "),o("label",[t._v("Fecha Inicio:")]),t._v(" "),o("b-input-group",[o("b-form-input",{attrs:{type:"date",placeholder:"Fecha Inicio"},model:{value:t.selectCliente.FechaAlquilerInicio,callback:function(e){t.$set(t.selectCliente,"FechaAlquilerInicio",e)},expression:"selectCliente.FechaAlquilerInicio"}})],1),t._v(" "),o("br"),t._v(" "),o("label",[t._v("Fecha Fin:")]),t._v(" "),o("b-input-group",[o("b-form-input",{attrs:{type:"date",placeholder:"Fecha Fin"},model:{value:t.selectCliente.FechaAlquilerFin,callback:function(e){t.$set(t.selectCliente,"FechaAlquilerFin",e)},expression:"selectCliente.FechaAlquilerFin"}})],1),t._v(" "),o("br"),t._v(" "),o("b-button",{attrs:{variant:"success",size:"sm"},on:{click:function(o){t.alquilarHab(e)}}},[t._v("Empezar Proyecto")])],1):t._e(),t._v(" "),e.IdPreOrden&&3==e.EstadoHabitacion?o("b-button",{attrs:{variant:"primary",size:"sm"},on:{click:function(o){t.openCarrito(e)}}},[t._v("+")]):t._e()],1)])],1)}))],1)})),t._v(" "),o("b-form",{on:{submit:function(e){return e.preventDefault(),t.guardarProductos(e)},keydown:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()}}},[o("b-modal",{ref:"modalCarrito",attrs:{size:"lg",id:"carrito",title:"Cesta de compras - Proyecto "+t.selectProducto.Producto},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("div",{attrs:{id:"contentModal"}},[o("div",{staticClass:"row"},[o("div",{staticClass:"col-md-12",attrs:{id:"headerCamiones"}},[o("div",{staticClass:"text-center"},[o("b",[t._v(t._s(t.selectProducto.DniRuc)+" - "+t._s(t.selectProducto.Cliente))])]),t._v(" "),t.proformaTotal?o("div",{staticClass:"text-left"},[o("b",{staticStyle:{padding:"10px",background:"#ebf0ff"}},[t._v("PROFORMA: S/ "+t._s(t.proformaTotal))])]):t._e(),t._v(" "),o("br"),t._v(" "),o("br"),t._v(" "),o("b-row",[o("b-col",{attrs:{md:"8",id:"productosProduccion"}},[t.show?o("pre-orden-form-det",{ref:"preOrdenProductos",attrs:{"id-preorden":t.selectProducto.IdPreOrden,"id-producto":t.selectProducto.IdProducto}}):t._e()],1),t._v(" "),o("b-col",{attrs:{md:"4"}},[o("label",[o("b",[t._v("Gastos")])]),t._v(" "),o("b-form-input",{attrs:{size:"sm",type:"number",placeholder:"Gasto S/."},model:{value:t.selectProducto.Gasto,callback:function(e){t.$set(t.selectProducto,"Gasto",e)},expression:"selectProducto.Gasto"}}),t._v(" "),o("b-input-group",[o("b-form-input",{attrs:{size:"sm",type:"text",placeholder:"Descripción"},model:{value:t.selectProducto.GastoDesc,callback:function(e){t.$set(t.selectProducto,"GastoDesc",e)},expression:"selectProducto.GastoDesc"}}),t._v(" "),o("b-button",{attrs:{variant:"primary",size:"sm"},on:{click:t.insertarGasto}},[t._v("+")]),t._v(" "),o("b-form-text",{attrs:{id:"inputLiveHelp"}},[t._v("Los gastos se reflejará en Caja y Banco.")])],1),t._v(" "),o("hr"),t._v(" "),o("label",[o("b",[t._v("Adelantos")])]),t._v(" "),o("b-form-input",{attrs:{size:"sm",type:"number",placeholder:"Adelanto S/."},model:{value:t.selectProducto.Adelanto,callback:function(e){t.$set(t.selectProducto,"Adelanto",e)},expression:"selectProducto.Adelanto"}}),t._v(" "),o("b-input-group",[o("b-form-input",{attrs:{size:"sm",type:"text",placeholder:"Descripción"},model:{value:t.selectProducto.AdelantoDesc,callback:function(e){t.$set(t.selectProducto,"AdelantoDesc",e)},expression:"selectProducto.AdelantoDesc"}}),t._v(" "),o("b-button",{attrs:{variant:"primary",size:"sm"},on:{click:t.insertarAdelanto}},[t._v("+")]),t._v(" "),o("b-form-text",{attrs:{id:"inputLiveHelp"}},[t._v("Adelanto se reflejará en Caja y Banco.")])],1),t._v(" "),o("br"),t._v(" "),o("table",{staticClass:"table b-table table-sm"},[o("thead",[o("tr",[o("th",[t._v("Fecha")]),t._v(" "),o("th",[t._v("Concepto")]),t._v(" "),o("th",[t._v("Cantidad")])])]),t._v(" "),o("tbody",[t._l(t.adelantos,function(e,a){return o("tr",{key:a},[o("td",[t._v(t._s(e.FechaDoc))]),t._v(" "),o("td",[t._v(t._s(e.Concepto.split(" - ").pop()))]),t._v(" "),o("td",[t._v(t._s(e.Tipo?"-"+e.Importe:e.Importe))])])}),t._v(" "),o("tr",{staticClass:"bg-info text-white"},[o("td",{attrs:{colspan:"2"}},[t._v("TOTAL")]),t._v(" "),o("td",[t._v(t._s(t.totalAdelantos))])])],2)])],1)],1),t._v(" "),o("div",{staticClass:"text-center"},[o("h4",[t._v("Gran total: "+t._s(t.sumProductos()))])])],1)])]),t._v(" "),o("div",{attrs:{slot:"modal-footer"},slot:"modal-footer"},[o("div",{staticStyle:{left:"1rem",position:"absolute"}},[o("b-btn",{attrs:{variant:"info",type:"submit",target:"_blank",href:"/views/V_VentaForm.php?idPreOrden="+t.selectProducto.IdPreOrden+"&idCliente="+t.selectProducto.IdClienteReserva}},[t._v("\n\t\t\t\t\t\tPagar Ahora\n\t\t\t\t\t\t")]),t._v(" "),o("b-btn",{attrs:{variant:""},on:{click:t.imprimir}},[t._v("\n\t\t\t\t\t\t\tImprimir\n\t\t\t\t\t\t")]),t._v(" "),o("div",{staticStyle:{float:"right","margin-left":"10px"}},[o("proformas",{on:{onSelectProforma:t.selectProforma,mounted:t.mountedProforma}})],1)],1),t._v(" "),o("b-btn",{attrs:{variant:"success",type:"submit"}},[t._v("\n\t\t\t\t\tGuardar\n\t\t\t\t\t")]),t._v(" "),o("b-btn",{attrs:{variant:"secondary"},on:{click:function(e){t.show=!1}}},[t._v("\n\t\t\t\t\tCerrar\n\t\t\t\t\t")])],1)])],1)],1)},staticRenderFns:[]};var Rt=o("VU/8")(Et,Mt,!1,function(t){o("CLg2"),o("Vi6H")},"data-v-7fd033fe",null).exports,Ot={mounted:function(){var t=this;this.axios.get(this.API+"ventas/count",{params:{idAlmacen:this.almacen.IdAlmacen}}).then(function(e){t.totalRows=e.data.total}),this.getVentasAcumuladas()},data:function(){return{API:v.a.API,vendedor:"",fechaInicio:this.$moment().format("YYYY-MM-DD"),fechaFin:this.$moment().format("YYYY-MM-DD"),declarado:1,filters:{},filter:"",sortBy:"FechaDoc",sortDesc:!1,ventasAcumuladas:0,almacen:{IdAlmacen:1,Almacen:"VENTA"},tipoDoc:{},pageOptions:[5,10,15,50,100],ventaSelect:{},ventaDetalleSelect:[],items:[],showVenta:!1,isBusy:!1,fields:[{key:"idDocVenta",label:"ID",sortable:!0},{key:"FechaDoc",label:"Fecha",sortable:!0},{key:"TipoDoc",label:"Documento",sortable:!0},{key:"Serie",label:"Serie",sortable:!0},{key:"Numero",sortable:!0},{key:"Cliente",sortable:!0},{key:"Anulado",label:"Anulado",sortable:!0},{key:"UsuarioReg",label:"Vendedor",sortable:!0},{key:"Total",sortable:!1,variant:"success",class:"text-center"}],totalRows:50,perPage:10,currentPage:1}},computed:{},methods:{setTipoVenta:function(t){this.tipoDoc=t||{},this.getVentasAcumuladas(),this.$refs.tablaVentas.refresh()},setVendedor:function(t){this.currentPage=1,this.vendedor=t,this.generateFilter("vendedor",t.Usuario)},getVentasAcumuladas:function(){var t=this;this.filters.vendedor?this.axios.get(this.API+"ventas/usuario",{params:{usuario:this.vendedor.Usuario,fechaInicio:this.fechaInicio,fechaFin:this.fechaFin,idTipoDoc:this.tipoDoc.IdTipoDoc||""}}).then(function(e){t.ventasAcumuladas=e.data.total}):this.axios.get(this.API+"ventas/total",{params:{fechaInicio:this.fechaInicio,fechaFin:this.fechaFin,idTipoDoc:this.tipoDoc.IdTipoDoc||""}}).then(function(e){t.ventasAcumuladas=e.data.total})},focusAutocomplete:function(t){this.$refs[t].handleDoubleClick()},setAlmacen:function(t){var e=this;this.almacen=t,this.limpiarFiltros(),Vue.nextTick(function(){return e.$refs.tablaVentas.refresh()})},rowClick:function(t){var e=this;this.ventaSelect=t,this.showKardex=!0,this.axios.get(this.API+"productos/kardex/10?limit=0",{params:{idAlmacen:this.almacen.IdAlmacen,fechaHasta:this.$moment().format("YYYY-MM-DDTH:mm:ss")}}).then(function(t){e.ventaDetalleSelect=t.data})},actualizarTabla:function(){this.$refs.tablaVentas.refresh()},myProvider:function(t){var e=this,o="";this.tipoDoc.IdTipoDoc&&(o="idTipoDoc[]="+this.tipoDoc.IdTipoDoc+"&");var a=this.API+"ventas?"+o+"idAlmacen="+this.almacen.IdAlmacen+"&limit="+t.perPage+"&page="+t.currentPage+"&filter="+(t.filter||"")+"&sortBy="+t.sortBy;return a+="&sortDesc="+(t.sortDesc?1:0),console.log(a),this.axios.get(a).then(function(t){return e.items=t.data,e.items}).catch(function(t){return[]})},limpiarFiltros:function(){this.filters={},this.filter="",this.$refs.inputVendedor.setValue(""),document.location.reload()},generateFilter:function(t,e){this.filters[t]=e;var o="";for(var t in this.filters)o+="&filter["+t+"]="+this.filters[t];this.filter=o,this.getVentasAcumuladas()},exportarProductos:function(){}},components:{ProductoKardex:j}},Bt={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-container",{staticClass:"bv-example-row"},[o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"10"}},[o("b-row",[o("b-col",{attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Almacen:")]),t._v(" "),o("autocomplete",{ref:"inputAlmacen",attrs:{required:"required",url:t.API+"almacenes",anchor:"Almacen",initValue:"VENTA",label:"writer",placeholder:"","on-select":t.setAlmacen,onFocus:t.focusAutocomplete.bind(null,"inputAlmacen"),classes:{input:"form-control"}}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Fecha Inicio:")]),t._v(" "),o("b-form-input",{attrs:{type:"date",placeholder:""},on:{input:function(e){return t.generateFilter("fechaInicio",e)}},model:{value:t.fechaInicio,callback:function(e){t.fechaInicio=e},expression:"fechaInicio"}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"4"}},[o("b-row",[o("b-col",{attrs:{md:"6"}},[o("b-form-group",[o("label",[t._v("Tipo de Venta:")]),t._v(" "),o("autocomplete",{ref:"inputTipoVenta",attrs:{required:"required",url:t.API+"ventas/tipos",anchor:"TipoDoc",label:"writer",placeholder:"","on-select":t.setTipoVenta,onInput:function(e){return!e&&t.setTipoVenta()},onFocus:t.focusAutocomplete.bind(null,"inputTipoVenta"),classes:{input:"form-control"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"6"}},[o("b-form-group",{attrs:{label:"Declarado"}},[o("b-form-radio-group",{attrs:{id:"btnradios1",buttons:"",options:[{text:"SI",value:1},{text:"NO",value:0}],name:"radiosBtnDefault"},on:{input:function(e){return t.generateFilter("declarado",e)}},model:{value:t.declarado,callback:function(e){t.declarado=e},expression:"declarado"}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"12"}},[o("b-form-group",[o("label",[t._v("Fecha Fin:")]),t._v(" "),o("b-form-input",{attrs:{type:"date",placeholder:""},on:{input:function(e){return t.generateFilter("fechaFin",e)}},model:{value:t.fechaFin,callback:function(e){t.fechaFin=e},expression:"fechaFin"}})],1)],1)],1)],1),t._v(" "),o("b-col",{attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Vendedor:")]),t._v(" "),o("autocomplete",{ref:"inputVendedor",attrs:{required:"required",url:t.API+"usuarios",anchor:"NombreUsuario",label:"writer","on-select":t.setVendedor,onInput:function(e){return!e&&t.generateFilter("vendedor",e)},onFocus:t.focusAutocomplete.bind(null,"inputVendedor"),classes:{input:"form-control"}}})],1),t._v(" "),o("div",{staticClass:"total-ventas"},[t._v("\n                S/ "+t._s(t.ventasAcumuladas||"0.00")+"\n              ")])],1)],1)],1),t._v(" "),o("b-col",{staticClass:"my-1",attrs:{md:"2"}},[o("b-row",[o("b-col",{attrs:{md:"12"}},[o("b-form-group",{attrs:{label:"Limpiar Filtros"}},[o("b-button",{attrs:{disabled:!t.filter},on:{click:t.limpiarFiltros}},[t._v("Limpiar")])],1),t._v(" "),o("b-form-group",{attrs:{label:"Mostrar"}},[o("b-form-select",{attrs:{options:t.pageOptions},on:{input:function(e){t.currentPage=1}},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1),t._v(" "),o("br")],1)],1)],1)],1),t._v(" "),o("b-row",[o("b-col",{attrs:{md:"12"}},[o("b-table",{ref:"tablaVentas",attrs:{small:"",filter:t.filter,"sort-by":t.sortBy,"sort-desc":t.sortDesc,striped:"",hover:"",id:"tabla-ventas",busy:t.isBusy,items:t.myProvider,fields:t.fields,"per-page":t.perPage,"current-page":t.currentPage},on:{"update:sortBy":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"row-clicked":t.rowClick,"update:busy":function(e){t.isBusy=e}},scopedSlots:t._u([{key:"stock",fn:function(e){return[o("div",{class:t.getStock(e.item.IdProducto)>0?"table-success":"table-danger",on:{click:function(t){return t.stopPropagation(),!1}}},[t._v("\n                  "+t._s(t.getStock(e.item.IdProducto))+"\n                ")])]}}])})],1),t._v(" "),o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"6"}},[o("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)],1),t._v(" "),o("br"),t._v(" "),o("b-row",{staticClass:"text-center",attrs:{"align-h":"center"}},[o("b-col",{attrs:{cols:"4"}},[o("b-button",{attrs:{variant:"success",size:"lg",href:"/api/index.php/reporte/stock?idAlmacen="+t.almacen.IdAlmacen,target:"_blank"}},[t._v("Exportar")])],1)],1),t._v(" "),o("br"),o("br")],1),t._v(" "),o("b-modal",{attrs:{id:"kardex",size:"lg","modal-class":"modal-xl",title:"Kardex de producto"},model:{value:t.showVenta,callback:function(e){t.showVenta=e},expression:"showVenta"}},[o("b-alert",{attrs:{show:"",variant:"warning"}},[t._v("titulo")])],1)],1)},staticRenderFns:[]};var Nt=o("VU/8")(Ot,Bt,!1,function(t){o("Z/tc")},null,null).exports,jt={mounted:function(){var t=this;this.axios.get(this.API+"productos/stock?idAlmacen="+this.almacen.IdAlmacen+"&filter[minimo]=1&count=1").then(function(e){t.totalRows=e.data.total})},data:function(){return{API:v.a.API,pageOptions:[5,10,15,50,100],filter:null,sortBy:"Gen_Producto.IdProducto",sortDesc:!1,items:[],isBusy:!1,fields:[{key:"IdProducto",label:"ID",sortable:!0},{key:"CodigoBarra",label:"Codigo",sortable:!0},{key:"Producto",sortable:!0},{key:"ProductoCategoria",label:"Categoría",sortable:!0},{key:"ProductoMarca",label:"Marca",sortable:!0},{key:"ProductoMedicion",label:"Medición",sortable:!0},{key:"stock",label:"Stock",sortable:!0}],totalRows:50,perPage:10,currentPage:1,almacen:{IdAlmacen:1}}},methods:{focusAutocomplete:function(t){this.$refs[t].handleDoubleClick()},setAlmacen:function(t){var e=this;this.almacen=t,Vue.nextTick(function(){return e.$refs.tablaProductos.refresh()})},myProvider:function(t){var e=this,o=this.API+"productos/stock?idAlmacen="+this.almacen.IdAlmacen+"&limit="+t.perPage+"&page="+t.currentPage+"&filter[producto]="+(t.filter||"")+"&filter[minimo]=1&sortBy="+t.sortBy;return o+="&sortDesc="+(t.sortDesc?1:0),this.axios.get(o).then(function(t){return e.items=t.data,e.items}).catch(function(t){return[]})}},components:{ProductoForm:x}},Ut={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-container",{staticClass:"bv-example-row"},[o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Buscar:")]),t._v(" "),o("b-input-group",[o("b-form-input",{attrs:{placeholder:"Buscar"},on:{input:function(e){t.currentPage=1}},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),t._v(" "),o("b-input-group-append",[o("b-btn",{attrs:{disabled:!t.filter},on:{click:function(e){t.filter=""}}},[t._v("Limpiar")])],1)],1)],1),t._v(" "),o("br")],1),t._v(" "),o("b-col",{attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Almacen:")]),t._v(" "),o("autocomplete",{ref:"inputAlmacen",attrs:{required:"required",url:t.API+"almacenes",anchor:"Almacen",initValue:"",label:"writer",placeholder:"","on-select":t.setAlmacen,onFocus:t.focusAutocomplete.bind(null,"inputAlmacen"),classes:{input:"form-control"}}})],1)],1),t._v(" "),o("b-col",{staticClass:"my-1",attrs:{md:"4"}},[o("b-row",[o("b-col",{attrs:{md:"8"}},[o("b-form-group",[o("label",[t._v("Mostrar:")]),t._v(" "),o("b-form-select",{attrs:{options:t.pageOptions},on:{input:function(e){t.currentPage=1}},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"4"}})],1)],1),t._v(" "),o("b-table",{ref:"tablaProductos",attrs:{small:"",filter:t.filter,"sort-by":t.sortBy,"sort-desc":t.sortDesc,striped:"",hover:"",id:"my-table",busy:t.isBusy,items:t.myProvider,fields:t.fields,"per-page":t.perPage,"current-page":t.currentPage},on:{"update:sortBy":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"update:busy":function(e){t.isBusy=e}}}),t._v(" "),o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"6"}},[o("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)],1),t._v(" "),o("br"),o("br")],1)],1)},staticRenderFns:[]};var zt=o("VU/8")(jt,Ut,!1,function(t){o("uuwG")},null,null).exports,qt={watch:{cliente:function(t){this.$refs.tablaPagos.refresh()}},data:function(){return{API:v.a.API,pageOptions:[5,10,15,50,100],filter:"",sortBy:"IdCajaBanco",sortDesc:!1,items:[],isBusy:!1,fields:[{key:"FechaDoc"},{key:"TipoCajaBanco"},{key:"Concepto"},{key:"Importe"}],totalRows:50,perPage:10,currentPage:1}},props:["cliente"],methods:{myProvider:function(t){var e=this;return this.axios.get(this.API+"cliente/comisionistas/pagos?idComisionista="+this.cliente.IdCliente+"&q="+t.filter+"&limit="+t.perPage+"&page="+t.currentPage).then(function(t){return e.items=t.data,e.items}).catch(function(t){return[]})}}},Yt={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-table",{ref:"tablaPagos",attrs:{small:"",filter:t.filter,"sort-by":t.sortBy,"sort-desc":t.sortDesc,striped:"",hover:"",id:"my-table",busy:t.isBusy,items:t.myProvider,fields:t.fields,"per-page":t.perPage,"current-page":t.currentPage},on:{"update:sortBy":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"update:busy":function(e){t.isBusy=e}}})],1)},staticRenderFns:[]};var Ht={mounted:function(){var t=this;this.axios.get(this.API+"clientes/comisionistas/count?idAlmacen="+this.almacen.IdAlmacen).then(function(e){t.totalRows=e.data.total})},watch:{items:function(t){var e=0;t.map(function(t){e+=t.Comision}),this.totalComision=e}},data:function(){return{API:v.a.API,totalComision:0,clienteSelect:{},showPagos:!1,pageOptions:[5,10,15,50,100],filter:"",sortBy:"IdDocVenta",sortDesc:!1,items:[],isBusy:!1,fields:[{key:"DniRuc",label:"DNI/RUC",sortable:!0},{key:"Cliente",label:"Cliente",sortable:!0},{key:"Comision",label:"Total Comisión",sortable:!0},{key:"pagar",label:"Pagar"}],totalRows:50,perPage:10,currentPage:1,almacen:{IdAlmacen:0}}},methods:{pagarAComisionista:function(t,e){var o=this;if(confirm("Desea pagar al comisionista")){var a=t.target.parentElement.previousElementSibling.value;this.axios.post(this.API+"cliente/comisionistas/pagar",{cliente:e,importe:a}).then(function(t){o.$toasted.success("Pago a comisionista realizado"),Vue.nextTick(function(){return o.$refs.tablaProductos.refresh()})}).catch(function(t){console.log(t),o.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})}},rowDblClick:function(t){this.clienteSelect=t,this.showPagos=!0},focusAutocomplete:function(t){this.$refs[t].handleDoubleClick()},setAlmacen:function(t){var e=this;this.almacen=t,Vue.nextTick(function(){return e.$refs.tablaProductos.refresh()})},myProvider:function(t){var e=this;return this.axios.get(this.API+"cliente/comisionistas?idAlmacen="+this.almacen.IdAlmacen+"&q="+t.filter).then(function(t){return e.items=t.data,e.items}).catch(function(t){return[]})}},components:{PagosComisionista:o("VU/8")(qt,Yt,!1,function(t){o("pHfo")},null,null).exports}},Lt={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("h2",{staticClass:"text-center",attrs:{"align-h":"center"}},[t._v("Reporte de Comisionistas")]),t._v(" "),o("b-container",{staticClass:"bv-example-row"},[o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Buscar:")]),t._v(" "),o("b-input-group",[o("b-form-input",{attrs:{placeholder:"Buscar"},on:{input:function(e){t.currentPage=1}},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),t._v(" "),o("b-input-group-append",[o("b-btn",{attrs:{disabled:!t.filter},on:{click:function(e){t.filter=""}}},[t._v("Limpiar")])],1)],1)],1),t._v(" "),o("br")],1),t._v(" "),o("b-col",{attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Almacen:")]),t._v(" "),o("autocomplete",{ref:"inputAlmacen",attrs:{required:"required",url:t.API+"almacenes",anchor:"Almacen",initValue:"",label:"writer",placeholder:"","on-select":t.setAlmacen,onFocus:t.focusAutocomplete.bind(null,"inputAlmacen"),classes:{input:"form-control"}}})],1)],1),t._v(" "),o("b-col",{staticClass:"my-1",attrs:{md:"4"}},[t._v("\n            Total Comisión\n            "),o("div",{staticClass:"total-comision"},[t._v(t._s(t.totalComision))])]),t._v(" "),o("b-table",{ref:"tablaProductos",attrs:{small:"",filter:t.filter,"sort-by":t.sortBy,"sort-desc":t.sortDesc,striped:"",hover:"",id:"my-table",busy:t.isBusy,items:t.myProvider,fields:t.fields,"per-page":t.perPage,"current-page":t.currentPage},on:{"update:sortBy":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"row-dblclicked":t.rowDblClick,"update:busy":function(e){t.isBusy=e}},scopedSlots:t._u([{key:"pagar",fn:function(e){return[o("div",{staticClass:"input-group mb-3"},[o("input",{staticClass:"form-control",staticStyle:{width:"30px"},attrs:{type:"text",placeholder:"Monto"}}),t._v(" "),o("div",{staticClass:"input-group-append"},[o("button",{staticClass:"btn btn-outline-success",attrs:{type:"button",id:"button-addon2"},on:{click:function(o){return t.pagarAComisionista(o,e.item)}}},[t._v("Pagar")])])])]}}])}),t._v(" "),o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"6"}},[o("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)],1),t._v(" "),o("br"),o("br")],1),t._v(" "),o("b-modal",{attrs:{id:"pagos",size:"lg","modal-class":"modal-xl",title:"pagos a comisionista"},model:{value:t.showPagos,callback:function(e){t.showPagos=e},expression:"showPagos"}},[o("b-alert",{attrs:{show:"",variant:"warning"}},[t._v(t._s(t.clienteSelect.DniRuc)+" - "+t._s(t.clienteSelect.Cliente))]),t._v(" "),t.clienteSelect.IdCliente?o("PagosComisionista",{attrs:{cliente:t.clienteSelect}}):t._e()],1)],1)},staticRenderFns:[]};var Gt=o("VU/8")(Ht,Lt,!1,function(t){o("90jw")},"data-v-7b76ecca",null).exports,Kt={mounted:function(){var t=this;this.axios.get(this.API+"clientes/deuda/count?idalmacen="+this.almacen.IdAlmacen).then(function(e){console.log(e),t.totalRows=e.data.total})},data:function(){return{API:v.a.API,pageOptions:[5,10,15,50,100],filter:"",sortBy:"IdDocVenta",sortDesc:!1,items:[],isBusy:!1,fields:[{key:"DniRuc",label:"DNI/RUC",sortable:!0},{key:"Cliente",label:"Cliente",sortable:!0},{key:"Correlativo",label:"Serie",sortable:!0},{key:"Total",label:"Total",sortable:!0},{key:"Aplicado",label:"Aplicado",sortable:!0},{key:"Saldo",label:"Saldo",sortable:!0},{key:"FechaDoc",label:"Emision",sortable:!0},{key:"FechaCredito",label:"Vencimiento",sortable:!0}],totalRows:50,perPage:10,currentPage:1,almacen:{IdAlmacen:1}}},methods:{focusAutocomplete:function(t){this.$refs[t].handleDoubleClick()},setAlmacen:function(t){var e=this;this.almacen=t,Vue.nextTick(function(){return e.$refs.tablaProductos.refresh()})},myProvider:function(t){var e=this;return this.axios.get(this.API+"cliente/deudas?idalmacen="+this.almacen.IdAlmacen+"&q="+t.filter+"&limit="+t.perPage+"&page="+t.currentPage).then(function(t){return console.log(t),e.items=t.data,e.items}).catch(function(t){return[]})}},components:{}},Xt={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("h2",{staticClass:"text-center",attrs:{"align-h":"center"}},[t._v("Reporte Deuda de Clientes")]),t._v(" "),o("b-container",{staticClass:"bv-example-row"},[o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Buscar:")]),t._v(" "),o("b-input-group",[o("b-form-input",{attrs:{placeholder:"Buscar"},on:{input:function(e){t.currentPage=1}},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),t._v(" "),o("b-input-group-append",[o("b-btn",{attrs:{disabled:!t.filter},on:{click:function(e){t.filter=""}}},[t._v("Limpiar")])],1)],1)],1),t._v(" "),o("br")],1),t._v(" "),o("b-col",{attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Almacen:")]),t._v(" "),o("autocomplete",{ref:"inputAlmacen",attrs:{required:"required",url:t.API+"almacenes",anchor:"Almacen",initValue:"",label:"writer",placeholder:"","on-select":t.setAlmacen,onFocus:t.focusAutocomplete.bind(null,"inputAlmacen"),classes:{input:"form-control"}}})],1)],1),t._v(" "),o("b-col",{staticClass:"my-1",attrs:{md:"4"}},[o("b-row",[o("b-col",{attrs:{md:"8"}},[o("b-form-group",[o("label",[t._v("Mostrar:")]),t._v(" "),o("b-form-select",{attrs:{options:t.pageOptions},on:{input:function(e){t.currentPage=1}},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"4"}})],1)],1),t._v(" "),o("b-table",{ref:"tablaProductos",attrs:{small:"",filter:t.filter,"sort-by":t.sortBy,"sort-desc":t.sortDesc,striped:"",hover:"",id:"my-table",busy:t.isBusy,items:t.myProvider,fields:t.fields,"per-page":t.perPage,"current-page":t.currentPage},on:{"update:sortBy":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"update:busy":function(e){t.isBusy=e}}}),t._v(" "),o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"6"}},[o("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)],1),t._v(" "),o("b-row",{staticClass:"text-center",attrs:{"align-h":"center"}},[o("b-col",{attrs:{cols:"4"}},[o("b-button",{attrs:{variant:"success",size:"lg",href:"/api/index.php/reporte/deudaclientes2?idalmacen="+t.almacen.IdAlmacen,target:"_blank"}},[t._v("Exportar")])],1)],1),t._v(" "),o("br"),o("br")],1)],1)},staticRenderFns:[]};var Zt=o("VU/8")(Kt,Xt,!1,function(t){o("Taqc")},null,null).exports,Wt={mounted:function(){var t=this;this.axios.get(this.API+"proveedores/deuda/count").then(function(e){console.log(e),t.totalRows=e.data.total})},data:function(){return{API:v.a.API,pageOptions:[5,10,15,50,100],filter:"",sortBy:"IdDocVenta",sortDesc:!1,items:[],isBusy:!1,fields:[{key:"Ruc",label:"RUC",sortable:!0},{key:"Proveedor",label:"Cliente",sortable:!0},{key:"Correlativo",label:"Serie",sortable:!0},{key:"Total",label:"Total",sortable:!0},{key:"Aplicado",label:"Aplicado",sortable:!0},{key:"Saldo",label:"Saldo",sortable:!0},{key:"FechaDoc",label:"Emision",sortable:!0},{key:"FechaCredito",label:"Vencimiento",sortable:!0}],totalRows:50,perPage:10,currentPage:1,almacen:{IdAlmacen:1}}},methods:{focusAutocomplete:function(t){this.$refs[t].handleDoubleClick()},setAlmacen:function(t){},myProvider:function(t){var e=this;return this.axios.get(this.API+"proveedores/deudas?q="+t.filter+"&limit="+t.perPage+"&page="+t.currentPage).then(function(t){return console.log(t),e.items=t.data,e.items}).catch(function(t){return[]})}},components:{}},Jt={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("h2",{staticClass:"text-center",attrs:{"align-h":"center"}},[t._v("Reporte Deuda de Proveedores")]),t._v(" "),o("b-container",{staticClass:"bv-example-row"},[o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Buscar:")]),t._v(" "),o("b-input-group",[o("b-form-input",{attrs:{placeholder:"Buscar"},on:{input:function(e){t.currentPage=1}},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),t._v(" "),o("b-input-group-append",[o("b-btn",{attrs:{disabled:!t.filter},on:{click:function(e){t.filter=""}}},[t._v("Limpiar")])],1)],1)],1),t._v(" "),o("br")],1),t._v(" "),o("b-col",{attrs:{md:"4"}}),t._v(" "),o("b-col",{staticClass:"my-1",attrs:{md:"4"}},[o("b-row",[o("b-col",{attrs:{md:"8"}},[o("b-form-group",[o("label",[t._v("Mostrar:")]),t._v(" "),o("b-form-select",{attrs:{options:t.pageOptions},on:{input:function(e){t.currentPage=1}},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"4"}})],1)],1),t._v(" "),o("b-table",{attrs:{small:"",filter:t.filter,"sort-by":t.sortBy,"sort-desc":t.sortDesc,striped:"",hover:"",id:"my-table",busy:t.isBusy,items:t.myProvider,fields:t.fields,"per-page":t.perPage,"current-page":t.currentPage},on:{"update:sortBy":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"update:busy":function(e){t.isBusy=e}}}),t._v(" "),o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"6"}},[o("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)],1),t._v(" "),o("b-row",{staticClass:"text-center",attrs:{"align-h":"center"}},[o("b-col",{attrs:{cols:"4"}},[o("b-button",{attrs:{variant:"success",size:"lg",href:"/api/index.php/reporte/deudaproveedores",target:"_blank"}},[t._v("Exportar")])],1)],1),t._v(" "),o("br"),o("br")],1)],1)},staticRenderFns:[]};var Qt=o("VU/8")(Wt,Jt,!1,function(t){o("MobZ")},null,null).exports,te={mounted:function(){var t=this;this.axios.get(this.API+"ranking/clientes/count?idalmacen="+this.almacen.IdAlmacen).then(function(e){console.log(e),t.totalRows=e.data.total})},data:function(){return{API:v.a.API,pageOptions:[5,10,15,50,100],filter:"",sortBy:"Total",sortDesc:!1,items:[],isBusy:!1,fields:[{key:"DniRuc",label:"DNI / RUC",sortable:!0},{key:"Cliente",label:"Cliente",sortable:!0},{key:"FechaNacimiento",label:"Fecha Nacimiento",sortable:!0},{key:"Puntos",label:"Puntos",sortable:!0},{key:"Total",label:"Total",sortable:!0}],totalRows:50,perPage:10,currentPage:1,almacen:{IdAlmacen:1}}},methods:{focusAutocomplete:function(t){this.$refs[t].handleDoubleClick()},setAlmacen:function(t){var e=this;this.almacen=t,Vue.nextTick(function(){return e.$refs.tablaProductos.refresh()})},myProvider:function(t){var e=this;return this.axios.get(this.API+"ranking/clientes?idalmacen="+this.almacen.IdAlmacen+"&q="+t.filter+"&limit="+t.perPage+"&page="+t.currentPage).then(function(t){return console.log(t),e.items=t.data,e.items}).catch(function(t){return[]})}},components:{}},ee={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("h2",{staticClass:"text-center",attrs:{"align-h":"center"}},[t._v("Reporte Ranking de Clientes")]),t._v(" "),o("b-container",{staticClass:"bv-example-row"},[o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Buscar:")]),t._v(" "),o("b-input-group",[o("b-form-input",{attrs:{placeholder:"Buscar"},on:{input:function(e){t.currentPage=1}},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),t._v(" "),o("b-input-group-append",[o("b-btn",{attrs:{disabled:!t.filter},on:{click:function(e){t.filter=""}}},[t._v("Limpiar")])],1)],1)],1),t._v(" "),o("br")],1),t._v(" "),o("b-col",{attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Almacen:")]),t._v(" "),o("autocomplete",{ref:"inputAlmacen",attrs:{required:"required",url:t.API+"almacenes",anchor:"Almacen",initValue:"",label:"writer",placeholder:"","on-select":t.setAlmacen,onFocus:t.focusAutocomplete.bind(null,"inputAlmacen"),classes:{input:"form-control"}}})],1)],1),t._v(" "),o("b-col",{staticClass:"my-1",attrs:{md:"4"}},[o("b-row",[o("b-col",{attrs:{md:"8"}},[o("b-form-group",[o("label",[t._v("Mostrar:")]),t._v(" "),o("b-form-select",{attrs:{options:t.pageOptions},on:{input:function(e){t.currentPage=1}},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"4"}})],1)],1),t._v(" "),o("b-table",{ref:"tablaProductos",attrs:{small:"",filter:t.filter,"sort-by":t.sortBy,"sort-desc":t.sortDesc,striped:"",hover:"",id:"my-table",busy:t.isBusy,items:t.myProvider,fields:t.fields,"per-page":t.perPage,"current-page":t.currentPage},on:{"update:sortBy":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"update:busy":function(e){t.isBusy=e}}}),t._v(" "),o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"6"}},[o("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)],1),t._v(" "),o("b-row",{staticClass:"text-center",attrs:{"align-h":"center"}},[o("b-col",{attrs:{cols:"4"}},[o("b-button",{attrs:{variant:"success",size:"lg",href:"/api/index.php/reporte/rankingclientes?idalmacen="+t.almacen.IdAlmacen,target:"_blank"}},[t._v("Exportar")])],1)],1),t._v(" "),o("br"),o("br")],1)],1)},staticRenderFns:[]};var oe=o("VU/8")(te,ee,!1,function(t){o("1Z70")},null,null).exports,ae={mounted:function(){},watch:{items:function(){var t=this;this.axios.get(this.API+"cierrecaja/count").then(function(e){t.totalRows=e.data.total})}},data:function(){return{API:v.a.API,show:!1,filter:"",items:[],isBusy:!1,fields:["IdCierreCaja","FechaCierre","IdTurno","UsuarioReg","ver"],totalRows:50,perPage:5,currentPage:1}},methods:{selectCierre:function(t){},myProvider:function(t){var e=this;return this.axios.get(this.API+"cierrecaja?limit="+t.perPage+"&page="+t.currentPage+"&filter="+t.filter+"&sortBy=IdCierreCaja&sortDesc=1").then(function(t){return e.items=t.data,e.items}).catch(function(t){return[]})}}},re={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-button",{attrs:{variant:"outline-success"},on:{click:function(e){t.show=!0}}},[t._v("Ver Cierres")]),t._v(" "),o("b-form",[o("b-modal",{attrs:{id:"modalCierres",title:"Seleccionar Cierre de Caja",size:"lg","header-bg-variant":"dark",headerTextVariant:"light","body-bg-variant":"light","body-text-variant":"dark"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("b-form-input",{attrs:{placeholder:"Buscar"},on:{input:function(e){t.currentPage=1}},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),t._v(" "),t.show?o("b-table",{attrs:{id:"my-table",striped:"",hover:"",busy:t.isBusy,filter:t.filter,items:t.myProvider,fields:t.fields,"per-page":t.perPage,"current-page":t.currentPage},on:{"update:busy":function(e){t.isBusy=e},"row-clicked":t.selectCierre},scopedSlots:t._u([{key:"ver",fn:function(e){return[o("b-button",{attrs:{href:"/views/ve_cierreform.php?idCierre="+e.item.IdCierreCaja,variant:"primary",target:"_blank"}},[t._v("Ver")])]}}])}):t._e(),t._v(" "),o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"6"}},[o("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1),t._v(" "),o("div",{attrs:{slot:"modal-footer"},slot:"modal-footer"},[o("b-btn",{attrs:{size:"sm",variant:"secondary"},on:{click:function(e){t.show=!1}}},[t._v("\n                    Cerrar\n                ")])],1)],1)],1)],1)},staticRenderFns:[]};var ne={mounted:function(){this.$route.params.id?(this.getCierre(this.$route.params.id),this.loadData()):this.getVendedor()},data:function(){return{API:v.a.API,ventas:[],ingresos:[],salidas:[],adelantos:[],turno:null,turnos:[{value:null,text:"Seleccione un Turno"},{value:1,text:"Mañana"},{value:2,text:"Tarde"},{value:3,text:"Noche"}],cierre:{},vendedor:{}}},computed:{getFechaCierre:function(){},granTotal:function(){return this.totalVentasEfectivo+this.totalVentasVisa+this.totalVentasMastercard+this.totalIngresos-this.totalSalidas-this.totalAdelantos},granTotalSinPagoCliente:function(){return this.totalVentasEfectivo+this.totalVentasVisa+this.totalVentasMastercard-this.totalSalidas},totalSalidas:function(){var t=0;return this.salidas.forEach(function(e){e.Anulado||(t+=e.Importe)}),t},totalIngresos:function(){var t=0;return this.ingresos.forEach(function(e){e.Anulado||(t+=e.Importe)}),t},totalAdelantos:function(){var t=0;return this.adelantos.forEach(function(e){e.Anulado||(t+=e.Importe)}),t},totalVentasEfectivo:function(){var t=0;return this.ventasEfectivo.forEach(function(e){e.Anulado||(t+=e.Efectivo)}),t},ventasEfectivo:function(){return this.ventas.filter(function(t){return t.Efectivo>0&&!t.EsCredito})},totalVentasVisa:function(){var t=0;return this.ventasVisa.forEach(function(e){e.Anulado||(t+=e.Visa)}),t},ventasVisa:function(){return this.ventas.filter(function(t){return t.Visa>0&&!t.EsCredito})},totalVentasMastercard:function(){var t=0;return this.ventasMastercard.forEach(function(e){e.Anulado||(t+=e.Mastercard)}),t},ventasMastercard:function(){return this.ventas.filter(function(t){return t.Mastercard>0&&!t.EsCredito})},totalVentasCredito:function(){var t=0;return this.ventasCredito.forEach(function(e){e.Anulado||(t+=e.Total)}),t},ventasCredito:function(){return this.ventas.filter(function(t){return t.EsCredito})}},methods:{getDetalles:function(t){return this.itemsDetalle.filter(function(e){return e.IdDocVenta==t})},getVendedor:function(){var t=this,e=sessionStorage.getItem("User");this.axios.get(this.API+"usuarios/"+e).then(function(e){t.setVendedor(e.data),t.$refs.inputVendedor.setValue(e.data.NombreUsuario),1!==e.data.IdUsuarioPerfil&&(t.$refs.inputVendedor.$refs.input.disabled=!0)}).catch(function(e){console.log(e),t.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})},imprimir:function(){window.print()},loadData:function(){this.getVentas(),this.getIngresos(),this.getSalidas()},setVendedor:function(t){this.vendedor=t,this.loadData()},cerrarCaja:function(){var t=this;this.turno?confirm("¿Está seguro de cerrar la caja?")&&this.axios.post(this.API+"cierrecaja",{idTurno:this.turno,user:this.vendedor.Usuario,ingresos:parseFloat(this.granTotal+this.totalSalidas).toFixed(2),salidas:this.totalSalidas,total:this.granTotal}).then(function(e){t.loadData(),t.$toasted.show("¡Caja cerrada!")}):this.$toasted.show("Seleccione un Turno")},focusAutocomplete:function(t){this.$refs[t].handleDoubleClick()},estadoVenta:function(t){return t.Anulado?"ANULADO":t.EsCredito?"CREDITO":"APLICADO"},loadDetalles:function(){var t=this;this.axios.get(this.API+"ventas/detalle",{params:{idDocVentas:this.ventas.map(function(t){return t.idDocVenta})}}).then(function(e){t.itemsDetalle=e.data,t.ventas=t.ventas.map(function(e){return e.productos=t.getDetalles(e.idDocVenta),e})}).catch(function(t){console.log(t)})},getVentas:function(){var t=this,e={idCierre:this.$route.params.id};this.vendedor.Usuario&&(e.usuario=this.vendedor.Usuario),this.axios.get(this.API+"cierrecaja/ventas",{params:e}).then(function(e){t.ventas=e.data,t.loadDetalles(),t.getAdelantos()}).catch(function(t){console.log(t)})},getIngresos:function(){var t=this,e={idCierre:this.$route.params.id};this.vendedor.Usuario&&(e.usuario=this.vendedor.Usuario),this.axios.get(this.API+"cierrecaja/ingresos",{params:e}).then(function(e){t.ingresos=e.data}).catch(function(t){console.log(t)})},getSalidas:function(){var t=this,e={idCierre:this.$route.params.id};this.vendedor.Usuario&&(e.usuario=this.vendedor.Usuario),this.axios.get(this.API+"cierrecaja/salidas",{params:e}).then(function(e){t.salidas=e.data}).catch(function(t){console.log(t)})},getAdelantos:function(){var t=this,e={idDocVentas:this.ventas.map(function(t){return t.idDocVenta})};this.axios.get(this.API+"cierrecaja/ingresos/adelantos",{params:e}).then(function(e){t.adelantos=e.data}).catch(function(t){console.log(t)})},getCierre:function(t){var e=this;this.axios.get(this.API+"cierrecaja",{params:{idCierre:t}}).then(function(t){e.cierre=t.data[0]})}},components:{CierresCaja:o("VU/8")(ae,re,!1,function(t){o("EWIx")},null,null).exports}},ie={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("br"),t._v(" "),o("b-container",{staticClass:"bv-example-row"},[o("div",[o("div",{staticClass:"no-print"},[o("b-row",{staticClass:" no-print",attrs:{"align-h":"end"}},[this.$route.params.id?t._e():o("label",[t._v("Vendedor:")]),t._v(" "),this.$route.params.id?t._e():o("b-col",{attrs:{cols:"3"}},[o("b-form-group",{attrs:{size:"sm"}},[o("autocomplete",{ref:"inputVendedor",attrs:{required:"required",url:t.API+"usuarios",anchor:"NombreUsuario",label:"writer","on-select":t.setVendedor,onFocus:t.focusAutocomplete.bind(null,"inputVendedor"),classes:{input:"form-control"}}})],1)],1),t._v(" "),o("b-col",{attrs:{cols:"7"}},[this.$route.params.id?t._e():o("b-button-group",{attrs:{size:"sm"}},[o("b-form-select",{attrs:{options:t.turnos},model:{value:t.turno,callback:function(e){t.turno=e},expression:"turno"}})],1),t._v(" "),o("b-button-group",{attrs:{size:"sm"}},[this.$route.params.id?t._e():o("b-button",{attrs:{variant:"outline-success"},on:{click:t.cerrarCaja}},[t._v("Cerrar Caja")])],1),t._v(" "),o("b-button-group",{attrs:{size:"sm"}},[o("cierres-caja")],1),t._v(" "),o("b-button-group",{attrs:{size:"sm"}},[o("b-button",{attrs:{variant:"outline-primary"},on:{click:t.imprimir}},[t._v("IMPRIMIR")])],1)],1)],1)],1)]),t._v(" "),o("br",{staticClass:"no-print"}),o("br",{staticClass:"no-print"}),t._v(" "),o("h2",{staticClass:"text-center"},[t._v("Cierre de Caja")]),t._v(" "),t.cierre.FechaCierre?o("h6",{staticClass:"text-center"},[t._v("Fecha: "+t._s(t.cierre.FechaCierre))]):t._e(),t._v(" "),t.cierre.IdTurno?o("h6",{staticClass:"text-center"},[t._v("Turno: "+t._s(1==t.cierre.IdTurno?"MAÑANA":"TARDE"))]):t._e(),t._v(" "),t.cierre.UsuarioReg?o("div",[t._v("Empleado: "),o("b",[t._v(t._s(t.cierre.UsuarioReg))])]):t._e(),t._v(" "),o("b-row",[o("h5",[t._v("Ventas Efectivo")]),o("br"),t._v(" "),o("table",{staticClass:"table b-table table-sm"},[o("thead",[o("tr",[o("th",[t._v("Recibo")]),o("th",[t._v("Fecha")]),o("th",[t._v("Productos")]),o("th",[t._v("Estado")]),o("th",{staticStyle:{width:"90px"}},[t._v("Pagado")])])]),t._v(" "),o("tbody",t._l(t.ventasEfectivo,function(e,a){return o("tr",{key:a,class:{anulado:e.Anulado}},[o("td",[t._v(t._s(e.TipoDoc+"-"+e.Serie+"-"+e.Numero))]),t._v(" "),o("td",[t._v(t._s(e.FechaDoc))]),t._v(" "),o("td",[o("table",{staticClass:"tabla-detalle"},[o("thead",[o("tr",[o("th",[t._v("Codigo")]),t._v(" "),o("th",[t._v("Producto")]),t._v(" "),o("th",[t._v("Cantidad")]),t._v(" "),o("th",[t._v("Precio")]),t._v(" "),o("th",[t._v("Descuento")]),t._v(" "),e.TieneIgv?o("th",[t._v("Subtotal")]):t._e(),t._v(" "),e.TieneIgv?o("th",[t._v("IGV")]):t._e(),t._v(" "),o("th",[t._v("Total")])])]),t._v(" "),o("tbody",t._l(e.productos,function(a,r){return o("tr",{key:r},[o("td",[t._v(t._s(a.CodigoBarra))]),t._v(" "),o("td",{staticClass:"detalle-producto"},[t._v(t._s(a.Producto))]),t._v(" "),o("td",[t._v(t._s(a.Cantidad))]),t._v(" "),o("td",[t._v(t._s(a.Precio))]),t._v(" "),o("td",[t._v(t._s(a.Descuento))]),t._v(" "),e.TieneIgv?o("td",[t._v("\n                      "+t._s(t._f("redondear")(a.Subtotal-.18*a.Subtotal))+"\n                    ")]):t._e(),t._v(" "),e.TieneIgv?o("td",[t._v("\n                      "+t._s(t._f("redondear")(.18*a.Subtotal))+"\n                    ")]):t._e(),t._v(" "),o("td",[t._v(t._s(t._f("redondear")(a.Subtotal)))])])}))]),t._v(" "),o("div",[o("i",[o("small",[o("b",[t._v("Cliente:")]),t._v(" "+t._s(e.Cliente))])])])]),t._v(" "),o("td",[t._v(t._s(t.estadoVenta(e)))]),t._v(" "),o("td",[t._v("S/. "+t._s(t._f("redondear")(e.Efectivo)))])])})),t._v(" "),o("tfoot",[o("tr",[o("td",{attrs:{colspan:"3"}}),t._v(" "),o("td",{staticClass:"total"},[o("b",[t._v("Total Efectivo")])]),t._v(" "),o("td",{staticClass:"total"},[o("b",[t._v("S/. "+t._s(t._f("redondear")(t.totalVentasEfectivo)))])])])])])]),t._v(" "),o("b-row",[o("h5",[t._v("Ventas Visa")]),o("br"),t._v(" "),o("table",{staticClass:"table b-table table-sm"},[o("thead",[o("tr",[o("th",[t._v("Recibo")]),o("th",[t._v("Fecha")]),o("th",[t._v("Productos")]),o("th",[t._v("Detalle")]),o("th",[t._v("Estado")]),o("th",[t._v("Pagado")])])]),t._v(" "),o("tbody",t._l(t.ventasVisa,function(e,a){return o("tr",{key:a,class:{anulado:e.Anulado}},[o("td",[t._v(t._s(e.TipoDoc+"-"+e.Serie+"-"+e.Numero))]),t._v(" "),o("td",[t._v(t._s(e.FechaDoc))]),t._v(" "),o("td",[o("table",{staticClass:"tabla-detalle"},[o("thead",[o("tr",[o("th",[t._v("Codigo")]),t._v(" "),o("th",[t._v("Producto")]),t._v(" "),o("th",[t._v("Cantidad")]),t._v(" "),o("th",[t._v("Precio")]),t._v(" "),o("th",[t._v("Descuento")]),t._v(" "),e.TieneIgv?o("th",[t._v("Subtotal")]):t._e(),t._v(" "),e.TieneIgv?o("th",[t._v("IGV")]):t._e(),t._v(" "),o("th",[t._v("Total")])])]),t._v(" "),o("tbody",t._l(e.productos,function(a,r){return o("tr",{key:r},[o("td",[t._v(t._s(a.CodigoBarra))]),t._v(" "),o("td",{staticClass:"detalle-producto"},[t._v(t._s(a.Producto))]),t._v(" "),o("td",[t._v(t._s(a.Cantidad))]),t._v(" "),o("td",[t._v(t._s(a.Precio))]),t._v(" "),o("td",[t._v(t._s(a.Descuento))]),t._v(" "),e.TieneIgv?o("td",[t._v("\n                      "+t._s(t._f("redondear")(a.Subtotal-.18*a.Subtotal))+"\n                    ")]):t._e(),t._v(" "),e.TieneIgv?o("td",[t._v("\n                      "+t._s(t._f("redondear")(.18*a.Subtotal))+"\n                    ")]):t._e(),t._v(" "),o("td",[t._v(t._s(t._f("redondear")(a.Subtotal)))])])}))]),t._v(" "),o("div",[o("i",[o("small",[o("b",[t._v("Cliente:")]),t._v(" "+t._s(e.Cliente))])])])]),t._v(" "),o("td",[t._v(t._s(e.VisaDesc))]),t._v(" "),o("td",[t._v(t._s(t.estadoVenta(e)))]),t._v(" "),o("td",[t._v("S/. "+t._s(t._f("redondear")(e.Visa)))])])})),t._v(" "),o("tfoot",[o("tr",[o("td",{attrs:{colspan:"4"}}),t._v(" "),o("td",{staticClass:"total"},[o("b",[t._v("Total Visa")])]),t._v(" "),o("td",{staticClass:"total"},[o("b",[t._v("S/. "+t._s(t._f("redondear")(t.totalVentasVisa)))])])])])])]),t._v(" "),o("b-row",[o("h5",[t._v("Ventas Mastercard")]),o("br"),t._v(" "),o("table",{staticClass:"table b-table table-sm"},[o("thead",[o("tr",[o("th",[t._v("Recibo")]),o("th",[t._v("Fecha")]),o("th",[t._v("Productos")]),o("th",[t._v("Detalle")]),o("th",[t._v("Estado")]),o("th",[t._v("Pagado")])])]),t._v(" "),o("tbody",t._l(t.ventasMastercard,function(e,a){return o("tr",{key:a,class:{anulado:e.Anulado}},[o("td",[t._v(t._s(e.TipoDoc+"-"+e.Serie+"-"+e.Numero))]),t._v(" "),o("td",[t._v(t._s(e.FechaDoc))]),t._v(" "),o("td",[o("table",{staticClass:"tabla-detalle"},[o("thead",[o("tr",[o("th",[t._v("Codigo")]),t._v(" "),o("th",[t._v("Producto")]),t._v(" "),o("th",[t._v("Cantidad")]),t._v(" "),o("th",[t._v("Precio")]),t._v(" "),o("th",[t._v("Descuento")]),t._v(" "),e.TieneIgv?o("th",[t._v("Subtotal")]):t._e(),t._v(" "),e.TieneIgv?o("th",[t._v("IGV")]):t._e(),t._v(" "),o("th",[t._v("Total")])])]),t._v(" "),o("tbody",t._l(e.productos,function(a,r){return o("tr",{key:r},[o("td",[t._v(t._s(a.CodigoBarra))]),t._v(" "),o("td",{staticClass:"detalle-producto"},[t._v(t._s(a.Producto))]),t._v(" "),o("td",[t._v(t._s(a.Cantidad))]),t._v(" "),o("td",[t._v(t._s(a.Precio))]),t._v(" "),o("td",[t._v(t._s(a.Descuento))]),t._v(" "),e.TieneIgv?o("td",[t._v("\n                      "+t._s(t._f("redondear")(a.Subtotal-.18*a.Subtotal))+"\n                    ")]):t._e(),t._v(" "),e.TieneIgv?o("td",[t._v("\n                      "+t._s(t._f("redondear")(.18*a.Subtotal))+"\n                    ")]):t._e(),t._v(" "),o("td",[t._v(t._s(t._f("redondear")(a.Subtotal)))])])}))]),t._v(" "),o("div",[o("i",[o("small",[o("b",[t._v("Cliente:")]),t._v(" "+t._s(e.Cliente))])])])]),t._v(" "),o("td",[t._v(t._s(e.MastercardDesc))]),t._v(" "),o("td",[t._v(t._s(t.estadoVenta(e)))]),t._v(" "),o("td",[t._v("S/. "+t._s(t._f("redondear")(e.Mastercard)))])])})),t._v(" "),o("tfoot",[o("tr",[o("td",{attrs:{colspan:"4"}}),t._v(" "),o("td",{staticClass:"total"},[o("b",[t._v("Total Mastercard")])]),t._v(" "),o("td",{staticClass:"total"},[o("b",[t._v("S/. "+t._s(t._f("redondear")(t.totalVentasMastercard)))])])])])])]),t._v(" "),o("b-row",{staticClass:"credito"},[o("h5",[t._v("Ventas a Credito")]),o("br"),t._v(" "),o("table",{staticClass:"table b-table table-sm"},[o("thead",[o("tr",[o("th",[t._v("Recibo")]),o("th",[t._v("Fecha")]),o("th",[t._v("Productos")]),o("th",[t._v("Estado")]),o("th",[t._v("Pagado")])])]),t._v(" "),o("tbody",t._l(t.ventasCredito,function(e,a){return o("tr",{key:a,class:{anulado:e.Anulado}},[o("td",[t._v(t._s(e.TipoDoc+"-"+e.Serie+"-"+e.Numero))]),t._v(" "),o("td",[t._v(t._s(e.FechaDoc))]),t._v(" "),o("td",[o("table",{staticClass:"tabla-detalle"},[o("thead",[o("tr",[o("th",[t._v("Codigo")]),t._v(" "),o("th",[t._v("Producto")]),t._v(" "),o("th",[t._v("Cantidad")]),t._v(" "),o("th",[t._v("Precio")]),t._v(" "),o("th",[t._v("Descuento")]),t._v(" "),e.TieneIgv?o("th",[t._v("Subtotal")]):t._e(),t._v(" "),e.TieneIgv?o("th",[t._v("IGV")]):t._e(),t._v(" "),o("th",[t._v("Total")])])]),t._v(" "),o("tbody",t._l(e.productos,function(a,r){return o("tr",{key:r},[o("td",[t._v(t._s(a.CodigoBarra))]),t._v(" "),o("td",{staticClass:"detalle-producto"},[t._v(t._s(a.Producto))]),t._v(" "),o("td",[t._v(t._s(a.Cantidad))]),t._v(" "),o("td",[t._v(t._s(a.Precio))]),t._v(" "),o("td",[t._v(t._s(a.Descuento))]),t._v(" "),e.TieneIgv?o("td",[t._v("\n                      "+t._s(t._f("redondear")(a.Subtotal-.18*a.Subtotal))+"\n                    ")]):t._e(),t._v(" "),e.TieneIgv?o("td",[t._v("\n                      "+t._s(t._f("redondear")(.18*a.Subtotal))+"\n                    ")]):t._e(),t._v(" "),o("td",[t._v(t._s(t._f("redondear")(a.Subtotal)))])])}))]),t._v(" "),o("div",[o("i",[o("small",[o("b",[t._v("Cliente:")]),t._v(" "+t._s(e.Cliente))])])])]),t._v(" "),o("td",[t._v(t._s(t.estadoVenta(e)))]),t._v(" "),o("td",[t._v("S/. "+t._s(t._f("redondear")(e.Total)))])])})),t._v(" "),o("tfoot",[o("tr",[o("td",{attrs:{colspan:"3"}}),t._v(" "),o("td",[o("b",[t._v("Total Credito")])]),t._v(" "),o("td",[o("b",[t._v("S/. "+t._s(t._f("redondear")(t._f("moneda")(t.totalVentasCredito))))])])])])])]),t._v(" "),o("b-row",[t.totalIngresos?o("b-col",[o("h5",[t._v("Ingresos")]),o("br"),t._v(" "),o("table",{staticClass:"table b-table table-sm"},[o("thead",[o("tr",[o("th",[t._v("ID")]),o("th",[t._v("Fecha")]),o("th",[t._v("Detalle")]),o("th",[t._v("Ingreso")])])]),t._v(" "),o("tbody",t._l(t.ingresos,function(e,a){return o("tr",{key:a},[o("td",[t._v(t._s(e.IdCajaBanco))]),t._v(" "),o("td",[t._v(t._s(e.FechaDoc))]),t._v(" "),o("td",[t._v(t._s(e.Concepto))]),t._v(" "),o("td",[t._v("S/. "+t._s(t._f("redondear")(e.Importe)))])])})),t._v(" "),o("tfoot",[o("tr",[o("td",{attrs:{colspan:"2"}}),t._v(" "),o("td",{staticClass:"total"},[o("b",[t._v("Total Ingresos")])]),t._v(" "),o("td",{staticClass:"total"},[o("b",[t._v("S/. "+t._s(t._f("redondear")(t.totalIngresos)))])])])])])]):t._e(),t._v(" "),t.totalSalidas?o("b-col",[o("h5",[t._v("Salidas")]),o("br"),t._v(" "),o("table",{staticClass:"table b-table table-sm"},[o("thead",[o("tr",[o("th",[t._v("ID")]),o("th",[t._v("Fecha")]),o("th",[t._v("Detalle")]),o("th",[t._v("Salida")])])]),t._v(" "),o("tbody",t._l(t.salidas,function(e,a){return o("tr",{key:a},[o("td",[t._v(t._s(e.IdCajaBanco))]),t._v(" "),o("td",[t._v(t._s(e.FechaDoc))]),t._v(" "),o("td",[t._v(t._s(e.Concepto))]),t._v(" "),o("td",[t._v("S/. "+t._s(t._f("redondear")(e.Importe)))])])})),t._v(" "),o("tfoot",[o("tr",[o("td",{attrs:{colspan:"2"}}),t._v(" "),o("td",{staticClass:"total-salida"},[o("b",[t._v("Total Salidas")])]),t._v(" "),o("td",{staticClass:"total-salida"},[o("b",[t._v("S/. "+t._s(t._f("redondear")(t.totalSalidas)))])])])])])]):t._e()],1),t._v(" "),o("b-row",[t.totalAdelantos?o("b-col",[o("h5",[t._v("Descontar Adelantos")]),o("br"),t._v(" "),o("table",{staticClass:"table b-table table-sm adelantos"},[o("thead",[o("tr",[o("th",[t._v("ID")]),o("th",[t._v("Fecha")]),o("th",[t._v("Detalle")]),o("th",[t._v("Ingreso")])])]),t._v(" "),o("tbody",t._l(t.adelantos,function(e,a){return o("tr",{key:a},[o("td",[t._v(t._s(e.IdCajaBanco))]),t._v(" "),o("td",[t._v(t._s(e.FechaDoc))]),t._v(" "),o("td",[t._v(t._s(e.Concepto)+" ("+t._s(e.Serie)+"-"+t._s(e.Numero)+")")]),t._v(" "),o("td",[t._v("S/. "+t._s(t._f("redondear")(e.Importe)))])])})),t._v(" "),o("tfoot",[o("tr",[o("td",{attrs:{colspan:"2"}}),t._v(" "),o("td",{staticClass:"total"},[o("b",[t._v("Total Adelantos")])]),t._v(" "),o("td",{staticClass:"total"},[o("b",[t._v("S/. "+t._s(t._f("redondear")(t.totalAdelantos)))])])])])])]):t._e()],1),t._v(" "),o("br"),t._v(" "),o("b-alert",{staticClass:"text-center",attrs:{variant:"success",show:""}},[o("b",[t._v("GRAN TOTAL: S/. "+t._s(t._f("moneda")(t.granTotal)))])])],1)],1)},staticRenderFns:[]};var se=o("VU/8")(ne,ie,!1,function(t){o("nA8+")},"data-v-2ae0a676",null).exports,ce={mounted:function(){this.getVendedor()},data:function(){return{API:v.a.API,producto:{},almacen:{},esValorizado:!1,fechaDesde:this.$moment().format("YYYY-MM-01"),fechaHasta:this.$moment().format("YYYY-MM-DD"),kardexSelect:[],cierres:[]}},computed:{totalGeneral:function(){for(var t=0,e=0;e<this.cierres.length;e++)if(this.cierres[e].Ingresos||this.cierres[e].Salidas){t=this.cierres[e].Total;break}return t}},methods:{getCierres:function(){var t=this;this.axios.get(this.API+"cierrecaja/reporte",{params:{idAlmacen:this.almacen.IdAlmacen,fechaDesde:this.fechaDesde+" 00:00:00",fechaHasta:this.fechaHasta+" 23:59:59"}}).then(function(e){console.log(e),t.cierres=e.data})},getVendedor:function(){var t=this,e=sessionStorage.getItem("User");this.axios.get(this.API+"usuarios/"+e).then(function(e){t.loadAlmacen(e.data.IdAlmacen),1!==e.data.IdUsuarioPerfil&&(t.$refs.inputAlmacen.$refs.input.disabled=!0)}).catch(function(e){console.log(e),t.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})},loadAlmacen:function(t){var e=this;this.axios.get(this.API+"almacenes/id/"+t).then(function(t){e.setAlmacen(t.data)})},setAlmacen:function(t){this.almacen=t,this.$refs.inputAlmacen.setValue(t.Almacen)},focusAutocomplete:function(t){this.$refs[t].handleDoubleClick()}}},le={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("h2",{staticClass:"text-center",attrs:{"align-h":"center"}},[t._v("Reporte de Cierre de Caja")]),t._v(" "),o("br"),t._v(" "),o("b-container",{staticClass:"bv-example-row"},[o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"3"}},[o("b-form-group",[o("label",[t._v("Almacen:")]),t._v(" "),o("autocomplete",{ref:"inputAlmacen",attrs:{required:"required",url:t.API+"almacenes",anchor:"Almacen",label:"writer",placeholder:"","on-select":t.setAlmacen,onFocus:t.focusAutocomplete.bind(null,"inputAlmacen"),classes:{input:"form-control"}}})],1)],1),t._v(" "),o("b-col",{staticClass:"my-1",attrs:{md:"3"}},[o("b-form-group",[o("label",[t._v("Fecha Inicio:")]),t._v(" "),o("b-form-input",{attrs:{type:"date",step:"1",placeholder:"Fecha Inicio"},model:{value:t.fechaDesde,callback:function(e){t.fechaDesde=e},expression:"fechaDesde"}})],1)],1),t._v(" "),o("b-col",{staticClass:"my-1",attrs:{md:"3"}},[o("b-form-group",[o("label",[t._v("Fecha Fin:")]),t._v(" "),o("b-form-input",{attrs:{type:"date",step:"1",placeholder:"Fecha Inicio"},model:{value:t.fechaHasta,callback:function(e){t.fechaHasta=e},expression:"fechaHasta"}})],1)],1),t._v(" "),o("b-col",{staticClass:"my-1",attrs:{md:"3"}},[o("br"),t._v(" "),o("b-button",{attrs:{disabled:!t.almacen.IdAlmacen,variant:"success",size:"sm"},on:{click:t.getCierres}},[t._v("Buscar")])],1)],1),t._v(" "),o("b-row",[o("table",{staticClass:"table b-table table-striped table-hover table-sm"},[o("thead",[o("tr",[o("th",[t._v("ID")]),t._v(" "),o("th",[t._v("Fecha Cierre")]),t._v(" "),o("th",[t._v("Turno")]),t._v(" "),o("th",[t._v("Usuario")]),t._v(" "),o("th",[t._v("Ingresos")]),t._v(" "),o("th",[t._v("Salidas")]),t._v(" "),o("th",[t._v("Saldo")]),t._v(" "),o("th",[t._v("Ver")])])]),t._v(" "),o("tbody",t._l(t.cierres,function(e,a){return o("tr",{key:a},[o("td",[t._v(t._s(e.IdCierreCaja))]),t._v(" "),o("td",[t._v(t._s(e.FechaCierre))]),t._v(" "),1===e.IdTurno?o("td",[t._v("Mañana")]):t._e(),t._v(" "),2===e.IdTurno?o("td",[t._v("Tarde")]):t._e(),t._v(" "),3===e.IdTurno?o("td",[t._v("Noche")]):t._e(),t._v(" "),o("td",[t._v(t._s(e.UsuarioReg))]),t._v(" "),o("td",[t._v(t._s(e.Ingresos))]),t._v(" "),o("td",[t._v(t._s(e.Salidas))]),t._v(" "),o("td",[o("b",[t._v(t._s(e.Total))])]),t._v(" "),o("td",[o("b-button",{attrs:{href:"/views/ve_cierreform.php?idCierre="+e.IdCierreCaja,variant:"primary",target:"_blank"}},[t._v("Ver")])],1)])}))])]),t._v(" "),o("b-alert",{staticClass:"text-center no-print",attrs:{variant:"success",show:""}},[o("b",[t._v("TOTAL GENERAL: S/. "+t._s(t._f("moneda")(t.totalGeneral)))])])],1)],1)},staticRenderFns:[]};var ue=o("VU/8")(ce,le,!1,function(t){o("WzjS")},null,null).exports,de={mounted:function(){this.getProforma(),this.getEmpresa()},data:function(){return{API:p.API,idProforma:this.$route.params.id,proforma:{productos:[]},empresa:{}}},computed:{subTotal:function(){var t=0;return this.proforma.productos.forEach(function(e){t+=e.Cantidad*e.Precio-e.Descuento}),t}},methods:{getProforma:function(){var t=this;this.axios.get(p.API+"proformas/id/"+this.idProforma).then(function(e){t.proforma=e.data})},getEmpresa:function(){var t=this;this.axios.get(p.API+"empresa/id/1").then(function(e){t.empresa=e.data})}}},pe={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"invoice-container"}},[t._m(0),t._v(" "),o("main",[o("div",{staticClass:"clearfix",attrs:{id:"details"}},[o("div",{attrs:{id:"client"}},[o("div",{staticClass:"to"},[t._v("PROFORMA A:")]),t._v(" "),o("h2",{staticClass:"name"},[t._v(t._s(t.proforma.Cliente))]),t._v(" "),o("div",{staticClass:"address"},[t._v(t._s(t.proforma.ClienteDireccion))]),t._v(" "),o("div",{staticClass:"email"},[o("a",{attrs:{href:"mailto:"+t.proforma.ClienteEmail}},[t._v(t._s(t.proforma.ClienteEmail))])])]),t._v(" "),o("div",{attrs:{id:"invoice"}},[o("h1",[t._v("PROFORMA "+t._s(t.proforma.Anio)+"-"+t._s(t.proforma.Numero))]),t._v(" "),o("div",{staticClass:"date"},[t._v("Fecha Proforma: "+t._s(t.proforma.FechaReg))])])]),t._v(" "),o("table",{attrs:{border:"0",cellspacing:"0",cellpadding:"0"}},[t._m(1),t._v(" "),o("tbody",t._l(t.proforma.productos,function(e,a){return o("tr",{key:a},[o("td",{staticClass:"no"},[t._v(t._s(a+1))]),t._v(" "),o("td",[o("img",{staticStyle:{"max-width":"65px","max-height":"65px"},attrs:{src:"/resources/images/productos/"+e.Imagen}})]),t._v(" "),o("td",{staticClass:"desc"},[o("h3",[t._v(t._s(e.Producto))]),t._v(t._s(e.ProductoDesc))]),t._v(" "),o("td",{staticClass:"unit"},[t._v("S/. "+t._s(t._f("moneda")(e.Precio)))]),t._v(" "),o("td",{staticClass:"qty"},[t._v(t._s(e.Cantidad))]),t._v(" "),o("td",{staticClass:"total"},[t._v("\n              S/. "+t._s(t._f("redondear")(e.Precio*e.Cantidad-e.Descuento))),o("br"),t._v(" "),e.Descuento?o("span",{staticClass:"dsct"},[t._v("Dsct: "+t._s(t._f("moneda")(e.Descuento,"S/. "))+" ")]):t._e()])])})),t._v(" "),o("tfoot",[o("tr",[o("td",{attrs:{colspan:"3"}}),t._v(" "),o("td",{attrs:{colspan:"2"}},[t._v("SUBTOTAL")]),t._v(" "),o("td",[t._v("S/. "+t._s(t._f("redondear")(t.subTotal)))])]),t._v(" "),o("tr",[o("td",{attrs:{colspan:"3"}}),t._v(" "),o("td",{attrs:{colspan:"2"}},[t._v("GRAN TOTAL")]),t._v(" "),o("td",[t._v("S/. "+t._s(t._f("redondear")(t.subTotal)))])])])]),t._v(" "),o("div",{attrs:{id:"thanks"}},[t._v("¡Dios lo Bendiga!")]),t._v(" "),t._m(2)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("header",{staticClass:"clearfix"},[e("div",{attrs:{id:"logo"}},[e("img",{attrs:{src:"/resources/images/banner-proforma.jpg"}})])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("thead",[o("tr",[o("th",{staticClass:"no"},[t._v("#")]),t._v(" "),o("th"),t._v(" "),o("th",{staticClass:"desc"},[t._v("DESCRIPCIÓN")]),t._v(" "),o("th",{staticClass:"unit"},[t._v("PRECIO U.")]),t._v(" "),o("th",{staticClass:"qty"},[t._v("CANT.")]),t._v(" "),o("th",{staticClass:"total"},[t._v("TOTAL")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"notices"}},[e("div",[this._v("NOTA:")]),this._v(" "),e("div",{staticClass:"notice"},[this._v("Esta proforma solo tiene validez durante los 30 dias posteriores.")])])}]};var ve=o("VU/8")(de,pe,!1,function(t){o("2/BE")},"data-v-11469102",null).exports,me={mounted:function(){this.getRegistroHuespedes()},data:function(){return{API:v.a.API,huespedes:[],fechaRegistroInicio:this.$moment().format("YYYY-MM-DD"),fechaRegistroFin:this.$moment().format("YYYY-MM-DD"),almacen:{IdAlmacen:1}}},methods:{focusAutocomplete:function(t){this.$refs[t].handleDoubleClick()},setAlmacen:function(t){var e=this;this.almacen=t,Vue.nextTick(function(){return e.$refs.tablaProductos.refresh()})},getRegistroHuespedes:function(){var t=this;this.axios.get(this.API+"reporte/habitaciones?idAlmacen="+this.almacen.IdAlmacen+"&fechaInicio="+this.fechaRegistroInicio+"&fechaFin="+this.fechaRegistroFin).then(function(e){t.huespedes=e.data})}},components:{}},fe={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-container",{staticClass:"container-huespedes"},[o("b-row",{staticClass:"no-print"},[o("b-col",{staticClass:"my-1",attrs:{md:"3"}},[o("b-form-group",[o("label",[t._v("Fecha Registro Inicio:")]),t._v(" "),o("b-input-group",[o("b-form-input",{attrs:{type:"date"},model:{value:t.fechaRegistroInicio,callback:function(e){t.fechaRegistroInicio=e},expression:"fechaRegistroInicio"}})],1)],1)],1),t._v(" "),o("b-col",{attrs:{md:"3"}},[o("b-form-group",[o("label",[t._v("Fecha Registro Fin:")]),t._v(" "),o("b-input-group",[o("b-form-input",{attrs:{type:"date"},model:{value:t.fechaRegistroFin,callback:function(e){t.fechaRegistroFin=e},expression:"fechaRegistroFin"}})],1)],1)],1),t._v(" "),o("b-col",{attrs:{md:"3"}},[o("b-form-group",[o("label",[t._v("Buscar:")]),t._v(" "),o("b-input-group",[o("b-btn",{attrs:{variant:"success"},on:{click:t.getRegistroHuespedes}},[t._v("Buscar")])],1)],1)],1)],1),t._v(" "),o("div",{staticClass:"registro"},[o("h1",{staticClass:"text-center"},[t._v("Registro de Proyectos")]),t._v(" "),o("b-row",[o("table",{staticClass:"table b-table table-striped table-hover"},[o("thead",[o("tr",[o("th",[t._v("Proyecto")]),t._v(" "),o("th",[t._v("Apellidos y Nombres")]),t._v(" "),o("th",[t._v("Sexo")]),t._v(" "),o("th",[t._v("Ocupacion")]),t._v(" "),o("th",[t._v("F. Nacimiento")]),t._v(" "),o("th",[t._v("Nacionalidad")]),t._v(" "),o("th",[t._v("Documento de Identidad")]),t._v(" "),o("th",[t._v("Direccion")]),t._v(" "),o("th",[t._v("Fecha de Ingreso")]),t._v(" "),o("th",[t._v("Lugar de Procedencia")]),t._v(" "),o("th",[t._v("Medio de Transporte")]),t._v(" "),o("th",[t._v("Próximo Destino")]),t._v(" "),o("th",[t._v("Fecha de salida")]),t._v(" "),o("th",[t._v("Tipo")]),t._v(" "),o("th",[t._v("Tarifa")])])]),t._v(" "),o("tbody",t._l(t.huespedes,function(e,a){return o("tr",{key:a},[o("td",[t._v(t._s(e.Producto))]),t._v(" "),o("td",[t._v(t._s(e.Cliente))]),t._v(" "),o("td",[t._v(t._s(e.Sexo))]),t._v(" "),o("td",[t._v(t._s(e.Ocupacion))]),t._v(" "),o("td",[t._v(t._s(e.FechaNacimiento))]),t._v(" "),o("td",[t._v(t._s(e.Nacionalidad))]),t._v(" "),o("td",[t._v(t._s(e.DniRuc))]),t._v(" "),o("td",[t._v(t._s(e.Direccion))]),t._v(" "),o("td",[t._v(t._s(e.FechaAlquilerInicio))]),t._v(" "),o("td",[t._v(t._s(e.LugarProcedencia))]),t._v(" "),o("td",[t._v(t._s(e.MedioTransporte))]),t._v(" "),o("td",[t._v(t._s(e.ProximoDestino))]),t._v(" "),o("td",[t._v(t._s(e.FechaAlquilerFin))]),t._v(" "),o("td",[t._v(t._s(e.ProductoMarca))]),t._v(" "),o("td",[t._v(t._s(e.Tarifa))])])}))])])],1),t._v(" "),o("br"),o("br")],1)],1)},staticRenderFns:[]};var he=o("VU/8")(me,fe,!1,function(t){o("i4Pz")},"data-v-5d0f31b6",null).exports;a.a.use(i.a);var be=new i.a({routes:[{path:"/",name:"Movimiento",component:T},{path:"/productos",name:"Productos",component:R},{path:"/clientes",name:"Clientes",component:St},{path:"/habitaciones",name:"Habitaciones",component:Rt},{path:"/almacen",name:"Almacen",component:q},{path:"/ventas",name:"Ventas",component:dt},{path:"/reportes/ventas",name:"ReporteVentas",component:Nt},{path:"/reportes/cierrecaja",name:"CierreCaja",component:se},{path:"/reportes/proforma/:id",name:"Proforma",component:ve},{path:"/reportes/cierrecaja/:id",name:"CierreCajaId",component:se},{path:"/reportes/reportecierrecaja",name:"ReporteCierreCaja",component:ue},{path:"/reportes/stockminimo",name:"StockMinimo",component:zt},{path:"/reportes/comisionistas",name:"comisionistas",component:Gt},{path:"/reportes/deudaclientes",name:"DeudaClientes",component:Zt},{path:"/reportes/deudaproveedores",name:"DeudaProveedores",component:Qt},{path:"/reportes/rankingclientes",name:"RankingClientes",component:oe},{path:"/reportes/huespedes",name:"RegistroHuespedes",component:he},{path:"/facturacion",name:"VentasFacturacion",component:kt}]}),_e=o("d7EF"),ge=o.n(_e),Pe=o("mtWM"),Ce=o.n(Pe),Ie={state:{productos:[],productosFiltrados:[],totalCart:0},mutations:{AGREGAR_PRODUCTO:function(t,e){var o=t.productos;if(e.setSuma){var a=o.findIndex(function(t){return t.IdProducto==e.IdProducto});a<0?o.push(e):o[a].cantidad+=1}else o.find(function(t){return t.IdProducto===e.IdProducto})||o.push(e)},ACTUALIZAR_PRECIOCONVENIO:function(t,e){var o=t.productos;o=o.map(function(t){return e.EsVIP?t.precio=t.precioConvenio||t.precio:t.precio=t.PrecioContado,t})},ACTUALIZAR_PRODUCTO:function(t,e){var o=t.productos,a=o.findIndex(function(t){return t.IdProducto===e.IdProducto});o.splice(a,1,e)},ELIMINAR_PRODUCTO:function(t,e){t.productos.splice(e,1)},LLENAR_PRODUCTOS_FILTRADOS:function(t,e){t.productosFiltrados=e},LIMPIAR_CART:function(t){t.productos=[]},APLICAR_DESCUENTO:function(t,e){var o=0;t.productos.forEach(function(t,e){o+=parseFloat(t.cantidad)}),t.productos=t.productos.map(function(t){return t.descuento=(e/o*t.cantidad).toFixed(2),t})},ACTUALIZAR_TOTAL:function(t,e){t.totalCart=e},OBTENER_STOCK:function(t,e){t.productos=t.productos.map(function(t){var o=e.findIndex(function(e){return e.IdProducto==t.IdProducto});return t.stock=e[o]&&e[o].stock,t})}},actions:{agregarProducto:function(t,e){var o=t.commit,a=ge()(e,5),r=a[0],n=a[1],i=a[2],s=a[3],c=a[4],l=!1,u=!1,d=!1,v=!1;if(i&&(l=i.setPrecio,u=i.cantidad,d=i.precio,v=i.setSuma),"object"===(void 0===r?"undefined":G()(r)))c&&(r.precio=r.precioConvenio||r.precio),o("AGREGAR_PRODUCTO",r),n&&n(r);else{var m={};s&&(m={codigoBarra:r}),Ce.a.get(p.API+"productos/id/"+r,{params:m}).then(function(t){if(t.data){var e=t.data;l?(e.cantidad=1,e.precio=e.PrecioContado||0):(e.cantidad=0,e.precio=0),c&&(r.precio=r.precioConvenio||r.precio),u&&(e.cantidad=u),d&&(e.precio=d),v&&(e.setSuma=!0),e.descuento=0,e.nuevoPrecioContado=0,o("AGREGAR_PRODUCTO",e),n&&n(e)}else n&&n(!1)})}},actualizarPrecioConvenio:function(t,e){(0,t.commit)("ACTUALIZAR_PRECIOCONVENIO",e)},actualizarProducto:function(t,e){(0,t.commit)("ACTUALIZAR_PRODUCTO",e)},eliminarProducto:function(t,e){(0,t.commit)("ELIMINAR_PRODUCTO",e)},buscarProductos:function(t,e){var o=t.commit;Ce.a.get(p.API+"productos?limit=10&q="+e).then(function(t){o("LLENAR_PRODUCTOS_FILTRADOS",t.data)})},limpiarCarrito:function(t){(0,t.commit)("LIMPIAR_CART")},aplicarDescuentoGeneral:function(t,e){(0,t.commit)("APLICAR_DESCUENTO",e)},actualizarTotalCart:function(t,e){(0,t.commit)("ACTUALIZAR_TOTAL",e)},obtenerStock:function(t,e){var o=t.commit,a=t.state;Ce.a.get(p.API+"productos/stock",{params:{idProductos:a.productos.map(function(t){return t.IdProducto}),idAlmacen:e.IdAlmacen}}).then(function(t){o("OBTENER_STOCK",t.data)}).catch(function(t){console.log(t)})}}},Ae={buscarProveedores:function(t,e){var o=t.commit;Ce.a.get(p.API+"proveedores?limit=10&q="+e).then(function(t){o("LLENAR_PROVEEDORES_FILTRADOS",t.data)})},buscarAlmacenes:function(t,e){var o=t.commit;Ce.a.get(p.API+"almacenes?q="+e).then(function(t){o("LLENAR_ALMACENES_FILTRADOS",t.data)})}};a.a.use(d.a);var xe=new d.a.Store({state:{proveedoresFiltrados:[],almacenesFiltrados:[]},actions:Ae,mutations:{LLENAR_PROVEEDORES_FILTRADOS:function(t,e){t.proveedoresFiltrados=e},LLENAR_ALMACENES_FILTRADOS:function(t,e){t.almacenesFiltrados=e}},modules:{cart:Ie}}),ye=o("e6fC"),ke=o("9XJu"),we=o.n(ke),De=o("Rf8U"),Ve=o.n(De),$e=o("IZMb"),Se=o.n($e),Fe=o("mjDs"),Te=o.n(Fe),Ee=o("+9Dj");o("Jmt5"),o("9M+g"),o("imi0"),o("ux0l"),Object(Ee.detect)();a.a.prototype.$browser=Object(Ee.detect)(),a.a.config.productionTip=!1,a.a.use(Ve.a,Ce.a),a.a.use(Se.a,{theme:"bubble",position:"top-center",duration:3e3}),a.a.use(ye.a),a.a.use(Te.a),a.a.component("autocomplete",we.a),a.a.component("editable",{template:'<div contenteditable="true" @input="update"></div>',props:["content"],mounted:function(){this.$el.innerText=this.content},methods:{update:function(t){this.$emit("update",t.target.innerText)}}}),a.a.filter("redondear",function(t,e){return parseFloat(t||0).toFixed(e||2)}),a.a.filter("redondeoMayor",function(t){return Math.ceil(t||0)}),a.a.filter("redondeoMenor",function(t){return Math.floor(t||0)}),a.a.filter("moneda",function(t){return parseFloat(t||0).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")}),window.Vue=a.a,new a.a({el:"#app",router:be,store:xe,components:{App:n},template:"<App/>"})},POZ1:function(t,e){},Sxdx:function(t,e){},Taqc:function(t,e){},"U+Ev":function(t,e){},UdTa:function(t,e,o){t.exports={API:"/api/index.php/"}},VK8q:function(t,e){},Vi6H:function(t,e){},WzjS:function(t,e){},XZXq:function(t,e){},"Z/tc":function(t,e){},ZwEl:function(t,e){},dhy5:function(t,e){},hm6A:function(t,e){},i4Pz:function(t,e){},imi0:function(t,e){},"nA8+":function(t,e){},o8nZ:function(t,e){},oKvT:function(t,e){},p3am:function(t,e){},pHfo:function(t,e){},rKEf:function(t,e){},rPld:function(t,e){},s40W:function(t,e){},uslO:function(t,e,o){var a={"./af":"3CJN","./af.js":"3CJN","./ar":"3MVc","./ar-dz":"tkWw","./ar-dz.js":"tkWw","./ar-kw":"j8cJ","./ar-kw.js":"j8cJ","./ar-ly":"wPpW","./ar-ly.js":"wPpW","./ar-ma":"dURR","./ar-ma.js":"dURR","./ar-sa":"7OnE","./ar-sa.js":"7OnE","./ar-tn":"BEem","./ar-tn.js":"BEem","./ar.js":"3MVc","./az":"eHwN","./az.js":"eHwN","./be":"3hfc","./be.js":"3hfc","./bg":"lOED","./bg.js":"lOED","./bm":"hng5","./bm.js":"hng5","./bn":"aM0x","./bn.js":"aM0x","./bo":"w2Hs","./bo.js":"w2Hs","./br":"OSsP","./br.js":"OSsP","./bs":"aqvp","./bs.js":"aqvp","./ca":"wIgY","./ca.js":"wIgY","./cs":"ssxj","./cs.js":"ssxj","./cv":"N3vo","./cv.js":"N3vo","./cy":"ZFGz","./cy.js":"ZFGz","./da":"YBA/","./da.js":"YBA/","./de":"DOkx","./de-at":"8v14","./de-at.js":"8v14","./de-ch":"Frex","./de-ch.js":"Frex","./de.js":"DOkx","./dv":"rIuo","./dv.js":"rIuo","./el":"CFqe","./el.js":"CFqe","./en-au":"Sjoy","./en-au.js":"Sjoy","./en-ca":"Tqun","./en-ca.js":"Tqun","./en-gb":"hPuz","./en-gb.js":"hPuz","./en-ie":"ALEw","./en-ie.js":"ALEw","./en-il":"QZk1","./en-il.js":"QZk1","./en-nz":"dyB6","./en-nz.js":"dyB6","./eo":"Nd3h","./eo.js":"Nd3h","./es":"LT9G","./es-do":"7MHZ","./es-do.js":"7MHZ","./es-us":"INcR","./es-us.js":"INcR","./es.js":"LT9G","./et":"XlWM","./et.js":"XlWM","./eu":"sqLM","./eu.js":"sqLM","./fa":"2pmY","./fa.js":"2pmY","./fi":"nS2h","./fi.js":"nS2h","./fo":"OVPi","./fo.js":"OVPi","./fr":"tzHd","./fr-ca":"bXQP","./fr-ca.js":"bXQP","./fr-ch":"VK9h","./fr-ch.js":"VK9h","./fr.js":"tzHd","./fy":"g7KF","./fy.js":"g7KF","./gd":"nLOz","./gd.js":"nLOz","./gl":"FuaP","./gl.js":"FuaP","./gom-latn":"+27R","./gom-latn.js":"+27R","./gu":"rtsW","./gu.js":"rtsW","./he":"Nzt2","./he.js":"Nzt2","./hi":"ETHv","./hi.js":"ETHv","./hr":"V4qH","./hr.js":"V4qH","./hu":"xne+","./hu.js":"xne+","./hy-am":"GrS7","./hy-am.js":"GrS7","./id":"yRTJ","./id.js":"yRTJ","./is":"upln","./is.js":"upln","./it":"FKXc","./it.js":"FKXc","./ja":"ORgI","./ja.js":"ORgI","./jv":"JwiF","./jv.js":"JwiF","./ka":"RnJI","./ka.js":"RnJI","./kk":"j+vx","./kk.js":"j+vx","./km":"5j66","./km.js":"5j66","./kn":"gEQe","./kn.js":"gEQe","./ko":"eBB/","./ko.js":"eBB/","./ky":"6cf8","./ky.js":"6cf8","./lb":"z3hR","./lb.js":"z3hR","./lo":"nE8X","./lo.js":"nE8X","./lt":"/6P1","./lt.js":"/6P1","./lv":"jxEH","./lv.js":"jxEH","./me":"svD2","./me.js":"svD2","./mi":"gEU3","./mi.js":"gEU3","./mk":"Ab7C","./mk.js":"Ab7C","./ml":"oo1B","./ml.js":"oo1B","./mn":"CqHt","./mn.js":"CqHt","./mr":"5vPg","./mr.js":"5vPg","./ms":"ooba","./ms-my":"G++c","./ms-my.js":"G++c","./ms.js":"ooba","./mt":"oCzW","./mt.js":"oCzW","./my":"F+2e","./my.js":"F+2e","./nb":"FlzV","./nb.js":"FlzV","./ne":"/mhn","./ne.js":"/mhn","./nl":"3K28","./nl-be":"Bp2f","./nl-be.js":"Bp2f","./nl.js":"3K28","./nn":"C7av","./nn.js":"C7av","./pa-in":"pfs9","./pa-in.js":"pfs9","./pl":"7LV+","./pl.js":"7LV+","./pt":"ZoSI","./pt-br":"AoDM","./pt-br.js":"AoDM","./pt.js":"ZoSI","./ro":"wT5f","./ro.js":"wT5f","./ru":"ulq9","./ru.js":"ulq9","./sd":"fW1y","./sd.js":"fW1y","./se":"5Omq","./se.js":"5Omq","./si":"Lgqo","./si.js":"Lgqo","./sk":"OUMt","./sk.js":"OUMt","./sl":"2s1U","./sl.js":"2s1U","./sq":"V0td","./sq.js":"V0td","./sr":"f4W3","./sr-cyrl":"c1x4","./sr-cyrl.js":"c1x4","./sr.js":"f4W3","./ss":"7Q8x","./ss.js":"7Q8x","./sv":"Fpqq","./sv.js":"Fpqq","./sw":"DSXN","./sw.js":"DSXN","./ta":"+7/x","./ta.js":"+7/x","./te":"Nlnz","./te.js":"Nlnz","./tet":"gUgh","./tet.js":"gUgh","./tg":"5SNd","./tg.js":"5SNd","./th":"XzD+","./th.js":"XzD+","./tl-ph":"3LKG","./tl-ph.js":"3LKG","./tlh":"m7yE","./tlh.js":"m7yE","./tr":"k+5o","./tr.js":"k+5o","./tzl":"iNtv","./tzl.js":"iNtv","./tzm":"FRPF","./tzm-latn":"krPU","./tzm-latn.js":"krPU","./tzm.js":"FRPF","./ug-cn":"To0v","./ug-cn.js":"To0v","./uk":"ntHu","./uk.js":"ntHu","./ur":"uSe8","./ur.js":"uSe8","./uz":"XU1s","./uz-latn":"/bsm","./uz-latn.js":"/bsm","./uz.js":"XU1s","./vi":"0X8Q","./vi.js":"0X8Q","./x-pseudo":"e/KL","./x-pseudo.js":"e/KL","./yo":"YXlc","./yo.js":"YXlc","./zh-cn":"Vz2w","./zh-cn.js":"Vz2w","./zh-hk":"ZUyn","./zh-hk.js":"ZUyn","./zh-tw":"BbgG","./zh-tw.js":"BbgG"};function r(t){return o(n(t))}function n(t){var e=a[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}r.keys=function(){return Object.keys(a)},r.resolve=n,t.exports=r,r.id="uslO"},uuwG:function(t,e){},ux0l:function(t,e){},zj2Q:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.d316ff009ae18d87584e.js.map