webpackJsonp([1],{"1/oy":function(t,e){},"1lvo":function(t,e){},"2ira":function(t,e){},"9M+g":function(t,e){},"9eGC":function(t,e){},"9n3c":function(t,e){},E6uB:function(t,e){},GfHa:function(t,e){},Id91:function(t,e){},Jmt5:function(t,e){},LDza:function(t,e){},NHnr:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o("7+uW"),a={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var n=o("VU/8")({name:"App"},a,!1,function(t){o("yGYl")},null,null).exports,i=o("/ocq"),s=o("Dd8w"),c=o.n(s),l={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("b-navbar",{attrs:{toggleable:"md",type:"dark",variant:"info"}},[o("b-navbar-toggle",{attrs:{target:"nav_collapse"}}),t._v(" "),o("b-navbar-brand",{attrs:{href:"#"}},[t._v("NavBar")]),t._v(" "),o("b-collapse",{attrs:{"is-nav":"",id:"nav_collapse"}},[o("b-navbar-nav",[o("b-nav-item",{attrs:{href:"#"}},[t._v("Inicio")]),t._v(" "),o("b-nav-item",{attrs:{href:"#",disabled:""}},[t._v("Disabled")]),t._v(" "),o("b-nav-item-dropdown",{attrs:{text:"Lang",right:""}},[o("b-dropdown-item",{attrs:{href:"#"}},[t._v("EN")]),t._v(" "),o("b-dropdown-item",{attrs:{href:"#"}},[t._v("ES")]),t._v(" "),o("b-dropdown-item",{attrs:{href:"#"}},[t._v("RU")]),t._v(" "),o("b-dropdown-item",{attrs:{href:"#"}},[t._v("FA")])],1)],1),t._v(" "),o("b-navbar-nav",{staticClass:"ml-auto"},[o("b-nav-item-dropdown",{attrs:{right:""}},[o("template",{slot:"button-content"},[o("em",[t._v("User")])]),t._v(" "),o("b-dropdown-item",{attrs:{href:"#"}},[t._v("Profile")]),t._v(" "),o("b-dropdown-item",{attrs:{href:"#"}},[t._v("Signout")])],2)],1)],1)],1)},staticRenderFns:[]};var u=o("VU/8")({},l,!1,function(t){o("E6uB")},null,null).exports,d=o("NYxO"),p=o("UdTa"),m=o.n(p),v=o("bOdI"),f=o.n(v),b={data:function(){return f()({API:m.a.API,show:!1,categoria:{}},"show",!1)},props:["showButton","cbGuardar"],methods:{guardarCategoria:function(){var t=this;this.categoria.ProductoCategoria&&(this.categoria.ProductoCategoria=this.categoria.ProductoCategoria.toUpperCase(),this.axios.post(this.API+"categorias",this.categoria).then(function(e){t.$toasted.show("Categoría guardada correctamente"),t.cbGuardar&&t.cbGuardar({IdProductoCategoria:e.data.insertId,ProductoCategoria:e.data.ProductoCategoria}),t.categoria.ProductoCategoria=""}).catch(function(e){console.log(e),t.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")}))}}},h={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[t.showButton?o("b-btn",{attrs:{id:"popoverCategoriaForm",variant:"primary"}},[o("b",[t._v("+")])]):t._e(),t._v(" "),o("b-popover",{ref:"popover",attrs:{target:"popoverCategoriaForm",triggers:"focus",title:"Nueva Categoría"}},[o("b-form-group",[o("label",[t._v("Categoria:")]),t._v(" "),o("b-form-input",{staticClass:"upper",attrs:{type:"text",value:""},nativeOn:{keydown:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.guardarCategoria(e):null}},model:{value:t.categoria.ProductoCategoria,callback:function(e){t.$set(t.categoria,"ProductoCategoria",e)},expression:"categoria.ProductoCategoria"}})],1),t._v(" "),o("b-btn",{attrs:{size:"sm",variant:"success"},on:{click:t.guardarCategoria}},[t._v("Guardar")])],1)],1)},staticRenderFns:[]};var g={data:function(){return f()({API:m.a.API,show:!1,marca:{}},"show",!1)},props:["showButton","cbGuardar"],methods:{guardarMarca:function(){var t=this;this.marca.ProductoMarca&&(this.marca.ProductoMarca=this.marca.ProductoMarca.toUpperCase(),this.axios.post(this.API+"marcas",this.marca).then(function(e){t.$toasted.show("Marca guardada correctamente"),t.cbGuardar&&t.cbGuardar({IdProductoMarca:e.data.insertId,ProductoMarca:e.data.ProductoMarca}),t.marca.ProductoMarca=""}).catch(function(e){console.log(e),t.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")}))}}},P={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[t.showButton?o("b-btn",{attrs:{id:"popoverMarcaForm",variant:"primary"}},[o("b",[t._v("+")])]):t._e(),t._v(" "),o("b-popover",{ref:"popover",attrs:{target:"popoverMarcaForm",triggers:"focus",title:"Nueva Marca"}},[o("b-form-group",[o("label",[t._v("Marca:")]),t._v(" "),o("b-form-input",{staticClass:"upper",attrs:{type:"text",value:""},nativeOn:{keydown:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.guardarMarca(e):null}},model:{value:t.marca.ProductoMarca,callback:function(e){t.$set(t.marca,"ProductoMarca",e)},expression:"marca.ProductoMarca"}})],1),t._v(" "),o("b-btn",{attrs:{size:"sm",variant:"success"},on:{click:t.guardarMarca}},[t._v("Guardar")])],1)],1)},staticRenderFns:[]};var _={data:function(){return{cantidadCodigoBarra:1,title:"Nuevo Producto",API:m.a.API,show:!1,generos:["VARON","DAMA","NIÑO","NIÑA","UNISEX","JUNIOR"],producto:{}}},beforeMount:function(){this.initForm()},props:["showButton","productoUpdate","cbGuardar"],watch:{productoUpdate:function(t){console.log(t),t.IdProducto?(this.title="Editar Producto << "+t.CodigoBarra+" >>",this.producto.categoria={IdProductoCategoria:t.IdProductoCategoria,ProductoCategoria:t.ProductoCategoria},this.producto.marca={IdProductoMarca:t.IdProductoMarca,ProductoMarca:t.ProductoMarca},this.producto.medicion={IdProductoMedicion:t.IdProductoMedicion,ProductoMedicion:t.ProductoMedicion},this.$refs.inputCategoria.setValue(t.ProductoCategoria),this.$refs.inputMarca.setValue(t.ProductoMarca),this.$refs.inputMedicion.setValue(t.ProductoMedicion),this.$refs.inputModelo.setValue(t.ProductoModelo),this.$refs.inputTalla.setValue(t.ProductoTalla),this.$refs.inputColor.setValue(t.Color),this.$refs.inputBotapie.setValue(t.Botapie),this.producto.talla={IdProductoTalla:t.IdProductoTalla,ProductoTalla:t.ProductoTalla},this.producto.Producto=t.Producto.split("-").slice(0,-1).join(),this.producto.IdProducto=t.IdProducto,this.producto.Genero=t.Genero,this.producto.Botapie=t.Botapie,this.producto.Color=t.Color,this.producto.PorcentajeUtilidad=t.PorcentajeUtilidad,this.producto.CodigoBarra=t.CodigoBarra,this.producto.ProductoModelo=t.ProductoModelo,this.producto.PrecioCosto=t.PrecioCosto,this.producto.PrecioContado=t.PrecioContado):(this.title="Nuevo Producto",this.clearForm())}},methods:{actualizarPrecioContado:function(){var t=this.producto.PrecioCosto,e=t+t*(this.producto.PorcentajeUtilidad/100);this.producto.precioContadoNormal=e,this.producto.PrecioContado=this.$options.filters.redondeoMayor(e)},setCategoria:function(t){this.producto.categoria=t,this.$refs.inputCategoria.setValue(t.ProductoCategoria)},setMedicion:function(t){this.producto.medicion=t},setMarca:function(t){this.producto.marca=t,this.$refs.inputMarca.setValue(t.ProductoMarca)},setTalla:function(t){this.producto.talla=t,this.$refs.inputTalla.setValue(t.ProductoTalla)},clearForm:function(){this.$refs.inputCategoria.setValue(""),this.$refs.inputMarca.setValue(""),this.$refs.inputMedicion.setValue("UNIDAD"),this.$refs.inputTalla.setValue(""),this.$refs.inputModelo.setValue(""),this.$refs.inputColor.setValue(""),this.$refs.inputBotapie.setValue(""),this.initForm()},initForm:function(){this.producto={Anulado:0,IdProductoMarca:null,IdProductoMedicion:null,IdProductoCategoria:null,IdProductoBotapie:null,IdProductoTalla:"",Producto:"",CodigoBarra:"",Color:"",PorcentajeUtilidad:"",PrecioContado:"",Botapie:"",Genero:"",categoria:{},marca:{},talla:{},medicion:{IdProductoMedicion:6,ProductoMedicion:"UNIDAD"}}},guardarProducto:function(t){var e=this;t.preventDefault(),this.axios.post(this.API+"productos",this.producto).then(function(t){e.cbGuardar&&e.cbGuardar(t.data.insertId),t.data.error?e.$toasted.show("Producto insertado correctamente - "+t.data.codigoBarra):e.$toasted.show("Producto guardado correctamente"),e.producto.talla={},e.$refs.inputTalla.setValue(""),e.$refs.productoForm.hide()}).catch(function(t){console.log(t),e.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})},focusAutocomplete:function(t){this.$refs[t].handleDoubleClick()},crearCategoria:function(){var t=this;if(this.$refs.inputCategoria.type){var e={};e.ProductoCategoria=this.$refs.inputCategoria.type.toUpperCase(),this.axios.post(this.API+"categorias",e).then(function(e){t.$toasted.show("Categoría guardada correctamente"),t.setCategoria({IdProductoCategoria:e.data.insertId,ProductoCategoria:e.data.ProductoCategoria})}).catch(function(e){console.log(e),t.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})}},crearMarca:function(){var t=this;if(this.$refs.inputMarca.type){var e={};e.ProductoMarca=this.$refs.inputMarca.type.toUpperCase(),this.axios.post(this.API+"marcas",e).then(function(e){t.$toasted.show("Marca guardada correctamente"),t.setMarca({IdProductoMarca:e.data.insertId,ProductoMarca:e.data.ProductoMarca})}).catch(function(e){console.log(e),t.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})}},crearTalla:function(){var t=this;if(this.$refs.inputTalla.type){var e={};e.ProductoTalla=this.$refs.inputTalla.type.toUpperCase(),this.axios.post(this.API+"tallas",e).then(function(e){t.$toasted.show("Talla guardada correctamente"),t.setTalla({IdProductoTalla:e.data.insertId,ProductoTalla:e.data.ProductoTalla})}).catch(function(e){console.log(e),t.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})}}},computed:{},components:{CategoriaForm:o("VU/8")(b,h,!1,function(t){o("Vv6i")},null,null).exports,MarcaForm:o("VU/8")(g,P,!1,function(t){o("gt/p")},null,null).exports}},C={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[t.showButton?o("b-btn",{directives:[{name:"b-modal",rawName:"v-b-modal.modalProducto",modifiers:{modalProducto:!0}}],attrs:{variant:"primary"}},[t._v("Nuevo")]):t._e(),t._v(" "),o("b-form",{on:{submit:t.guardarProducto,keydown:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()}}},[o("b-modal",{ref:"productoForm",attrs:{"no-close-on-esc":!0,id:"modalProducto",title:t.title,size:"lg"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("b-row",[o("b-col",{attrs:{md:"6"}},[o("b-form-group",[o("label",[t._v("Categoría:")]),t._v(" "),o("b-input-group",[o("autocomplete",{ref:"inputCategoria",attrs:{required:"required",url:t.API+"categorias",anchor:"ProductoCategoria",label:"writer",placeholder:t.producto.categoria.ProductoCategoria,"on-select":t.setCategoria,onFocus:t.focusAutocomplete.bind(null,"inputCategoria"),classes:{input:"form-control upper"}}}),t._v(" "),o("b-input-group-append",[o("b-btn",{attrs:{variant:"primary"},on:{click:t.crearCategoria}},[o("b",[t._v("Guardar")])])],1)],1)],1),t._v(" "),o("b-form-group",[o("label",[t._v("Artículo:")]),t._v(" "),o("b-form-input",{attrs:{required:"required",type:"text",value:t.producto.Producto},on:{input:function(e){return t.producto.Producto=e&&e.toUpperCase()}},model:{value:t.producto.Producto,callback:function(e){t.$set(t.producto,"Producto",e)},expression:"producto.Producto"}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Marca:")]),t._v(" "),o("b-input-group",[o("autocomplete",{ref:"inputMarca",attrs:{required:"required",url:t.API+"marcas",anchor:"ProductoMarca",label:"writer",placeholder:t.producto.marca.ProductoMarca,"on-select":t.setMarca,onFocus:t.focusAutocomplete.bind(null,"inputMarca"),classes:{input:"form-control upper"}},on:{"update:placeholder":function(e){t.$set(t.producto.marca,"ProductoMarca",e)}}}),t._v(" "),o("b-input-group-append",[o("b-btn",{attrs:{variant:"primary"},on:{click:t.crearMarca}},[o("b",[t._v("Guardar")])])],1)],1)],1),t._v(" "),o("b-form-group",[o("label",[t._v("Modelo:")]),t._v(" "),o("b-input-group",[o("autocomplete",{ref:"inputModelo",attrs:{required:"required",url:t.API+"productos/modelos",anchor:"ProductoModelo",label:"writer",placeholder:t.producto.ProductoModelo,"on-select":function(e){return t.producto.ProductoModelo=e.ProductoModelo&&e.ProductoModelo.toUpperCase()},onInput:function(e){return t.producto.ProductoModelo=e&&e.toUpperCase()},onFocus:t.focusAutocomplete.bind(null,"inputModelo"),classes:{input:"form-control upper"}},on:{"update:placeholder":function(e){t.$set(t.producto,"ProductoModelo",e)}}})],1)],1),t._v(" "),o("b-form-group",[o("label",[t._v("Colores:")]),t._v(" "),o("autocomplete",{ref:"inputColor",attrs:{required:"required",url:t.API+"productos/colores",anchor:"Color",label:"writer",placeholder:t.producto.Color,"on-select":function(e){return t.producto.Color=e.Color&&e.Color.toUpperCase()},onInput:function(e){return t.producto.Color=e&&e.toUpperCase()},onFocus:t.focusAutocomplete.bind(null,"inputColor"),classes:{input:"form-control upper"}},on:{"update:placeholder":function(e){t.$set(t.producto,"Color",e)}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"6"}},[o("b-form-group",[o("label",[t._v("Medición:")]),t._v(" "),o("autocomplete",{ref:"inputMedicion",attrs:{required:"required",url:t.API+"mediciones",initValue:"UNIDAD",anchor:"ProductoMedicion",label:"writer",placeholder:t.producto.medicion.ProductoMedicion,"on-select":t.setMedicion,classes:{input:"form-control"}},on:{"update:placeholder":function(e){t.$set(t.producto.medicion,"ProductoMedicion",e)}}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Talla:")]),t._v(" "),o("b-input-group",[o("autocomplete",{ref:"inputTalla",attrs:{required:"required",url:t.API+"tallas",anchor:"ProductoTalla",label:"writer",placeholder:t.producto.talla.ProductoTalla,"on-select":t.setTalla,onFocus:t.focusAutocomplete.bind(null,"inputTalla"),classes:{input:"form-control upper"}},on:{"update:placeholder":function(e){t.$set(t.producto.talla,"ProductoTalla",e)}}}),t._v(" "),o("b-input-group-append",[o("b-btn",{attrs:{variant:"primary"},on:{click:t.crearTalla}},[o("b",[t._v("Guardar")])])],1)],1)],1),t._v(" "),o("b-form-group",[o("label",[t._v("Genero:")]),t._v(" "),o("b-form-select",{attrs:{required:"required",options:t.generos},model:{value:t.producto.Genero,callback:function(e){t.$set(t.producto,"Genero",e)},expression:"producto.Genero"}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Botapie/Manga:")]),t._v(" "),o("autocomplete",{ref:"inputBotapie",attrs:{required:"required",url:t.API+"productos/botapies",anchor:"Botapie",label:"writer",placeholder:t.producto.Botapie,"on-select":function(e){return t.producto.Botapie=e.Botapie&&e.Botapie.toUpperCase()},onInput:function(e){return t.producto.Botapie=e&&e.toUpperCase()},onFocus:t.focusAutocomplete.bind(null,"inputBotapie"),classes:{input:"form-control upper"}},on:{"update:placeholder":function(e){t.$set(t.producto,"Botapie",e)}}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Porcentaje Utilidad:")]),t._v(" "),o("b-form-input",{attrs:{required:"required",type:"number"},nativeOn:{input:function(e){return t.actualizarPrecioContado(e)}},model:{value:t.producto.PorcentajeUtilidad,callback:function(e){t.$set(t.producto,"PorcentajeUtilidad",e)},expression:"producto.PorcentajeUtilidad"}})],1)],1)],1),t._v(" "),t.producto.IdProducto?o("hr"):t._e(),t._v(" "),t.producto.IdProducto?o("b-row",[o("b-col",{attrs:{md:"6"}},[o("b-form-group",[o("label",[t._v("Precio de Costo:")]),t._v(" "),o("b-form-input",{attrs:{readonly:"readonly",type:"number"},model:{value:t.producto.PrecioCosto,callback:function(e){t.$set(t.producto,"PrecioCosto",e)},expression:"producto.PrecioCosto"}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"6"}},[o("b-form-group",[o("label",[t._v("Precio de Venta:")]),t._v(" "),o("b-form-input",{attrs:{type:"number"},model:{value:t.producto.PrecioContado,callback:function(e){t.$set(t.producto,"PrecioContado",e)},expression:"producto.PrecioContado"}}),t._v(" "),t.producto.precioContadoNormal?o("b-form-text",[t._v("\n              Original - "+t._s(t._f("redondear")(t.producto.precioContadoNormal))+"\n            ")]):t._e()],1)],1)],1):t._e(),t._v(" "),o("div",{attrs:{slot:"modal-footer"},slot:"modal-footer"},[t.producto.IdProducto?o("div",{staticStyle:{left:"1rem",position:"absolute"}},[o("b-input-group",[o("b-form-input",{staticStyle:{width:"80px"},attrs:{type:"number"},model:{value:t.cantidadCodigoBarra,callback:function(e){t.cantidadCodigoBarra=e},expression:"cantidadCodigoBarra"}}),t._v(" "),o("b-input-group-append",[o("b-btn",{attrs:{variant:"info",target:"_blank",href:"/views/codigoBarra.php?idProducto="+t.producto.IdProducto+"&cantidad="+t.cantidadCodigoBarra}},[t._v("Código de barra")])],1)],1)],1):t._e(),t._v(" "),t.producto.IdProducto?t._e():o("b-btn",{attrs:{variant:"warning"},on:{click:t.clearForm}},[t._v("\n        Limpiar\n      ")]),t._v(" "),o("b-btn",{attrs:{variant:"primary",type:"submit"}},[t._v("\n         Guardar\n       ")]),t._v(" "),o("b-btn",{attrs:{variant:"secondary"},on:{click:function(e){t.show=!1}}},[t._v("\n         Close\n       ")])],1)],1)],1)],1)},staticRenderFns:[]};var k=o("VU/8")(_,C,!1,function(t){o("2ira")},null,null).exports,A={mounted:function(){},data:function(){return{API:m.a.API,loadCode:"",pasteCode:!1,producto:{},items:[],handleKeyDown:!1}},props:{setPrecio:Boolean,igvTotal:Boolean,onSetProducto:{type:Function,default:function(t){return t}},showButton:{default:!0,type:Boolean},fields:{default:function(){return[{key:"Producto"},{key:"ProductoModelo",label:"Modelo"},{key:"ProductoMarca",label:"Marca"},{key:"ProductoTalla",label:"Talla"},{key:"Genero"},{key:"cantidad"},{key:"precio",label:"P/U"},{key:"subtotal",label:"SubTotal",variant:"success"},{key:"igv",label:"IGV"},{key:"precioVenta",label:"Precio venta"},{key:"total",label:"Total",variant:"danger"},{key:"acciones",label:""}]},type:Array}},computed:c()({},Object(d.c)({productos:function(t){return t.cart.productos},filtrados:function(t){return t.cart.productosFiltrados}}),{sumatoriaSubTotal:function(){var t=0;return this.igvTotal?t=this.sumatoriaTotal-this.sumatoriaIgv:this.productos.map(function(e){t+=parseFloat(e.subtotal),e.descuento&&(t-=e.descuento)}),this.$options.filters.redondear(t)},sumatoriaTotal:function(){var t=0;return this.productos.map(function(e){t+=parseFloat(e.total)}),this.actualizarTotal(t),this.$options.filters.redondear(t)},sumatoriaIgv:function(){var t=0;return this.igvTotal?(t=this.sumatoriaTotal,t*=.18):this.productos.map(function(e){t+=parseFloat(e.igv)}),this.$options.filters.redondear(t)},sumatoriaDescuento:function(){var t=0;return this.productos.map(function(e){t+=parseFloat(e.descuento||0)}),this.$options.filters.redondear(t)}}),methods:c()({},Object(d.b)({add:"agregarProducto",buscar:"buscarProductos",eliminar:"eliminarProducto",actualizarTotal:"actualizarTotalCart"}),{loadBarcode:function(t){var e=this;t.preventDefault();var o=this.loadCode.substring(2,this.loadCode.length-2);o&&this.add([o,function(t){t?(e.$emit("onAddProducto"),e.$toasted.show("Producto añadido correctamente")):e.$toasted.show("No se encontró ningun producto"),e.loadCode=""},{setPrecio:this.setPrecio}])},focusAutocomplete:function(t){this.$refs[t].type="",this.$refs[t].handleDoubleClick()},setProducto:function(t){var e=this;this.$refs.autocompleteProducto.setValue(""),t.precio=0,t.cantidad=0,t.descuento=0,t.nuevoPrecioContado=0,t=this.onSetProducto(t),this.add([t,function(){e.$emit("onAddProducto",t)}])},renderChild:function(t){return"\n        <b>"+t.Producto+"</b> / "+t.ProductoCategoria+" / "+t.ProductoMarca+" / "+t.ProductoModelo+" / "+t.ProductoTalla+"\n      "},setNuevoPrecioContado:function(t){var e=parseFloat(this.productos[t].precio);this.productos[t].TieneIgv&&(e+=.18*e),e+=e*(this.productos[t].PorcentajeUtilidad/100);var o=this.$options.filters.redondear(e),r=this.$options.filters.redondeoMayor(e);Vue.set(this.productos[t],"normalPrecioContado",o),Vue.set(this.productos[t],"nuevoPrecioContado",r)},getSubtotal:function(t){var e=this.$options.filters.redondear(this.productos[t].cantidad*this.productos[t].precio);return Vue.set(this.productos[t],"subtotal",e),e},getIgv:function(t){var e=0;return this.productos[t].TieneIgv&&(e=this.$options.filters.redondear(.18*this.productos[t].subtotal)),Vue.set(this.productos[t],"igv",e),e},getTotal:function(t){var e=parseFloat(this.productos[t].subtotal);return this.productos[t].FLETE&&(e+=parseFloat(this.productos[t].FLETE)),this.productos[t].TieneIgv&&(e+=parseFloat(this.productos[t].igv)),this.productos[t].descuento&&(e-=parseFloat(this.productos[t].descuento)),e=this.$options.filters.redondear(e),Vue.set(this.productos[t],"total",e),e},getData:function(t){this.buscar(t)},quitarProducto:function(t){this.eliminar(t),this.$emit("onRemoveProducto",t),this.$toasted.show("Producto quitado del listado")}}),components:{ProductoForm:k}},I={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("b-row",[o("b-col",{attrs:{md:"12"}},[o("b-form-group",[o("label",[t._v("Agregar Productos:")]),t._v(" "),o("b-input-group",[o("autocomplete",{ref:"autocompleteProducto",attrs:{url:t.API+"productos",onShouldRenderChild:t.renderChild,anchor:"Producto",label:"writer",placeholder:"Agregar Producto","on-select":t.setProducto,onFocus:t.focusAutocomplete.bind(null,"autocompleteProducto"),classes:{input:"form-control"}}}),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.loadCode,expression:"loadCode"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Codigo de Barra"},domProps:{value:t.loadCode},on:{keydown:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?(e.preventDefault(),t.loadBarcode(e)):null},input:function(e){e.target.composing||(t.loadCode=e.target.value)}}}),t._v(" "),o("b-input-group-append",[o("producto-form",{attrs:{showButton:t.showButton,cbGuardar:function(e){return t.add([e])}}})],1)],1)],1),t._v(" "),o("b-table",{ref:"tablaCarrito",attrs:{small:"",responsive:"",striped:"",hover:"",items:t.productos,fields:t.fields},scopedSlots:t._u([{key:"cantidad",fn:function(e){return[o("b-form-input",{attrs:{type:"number",min:"0",placeholder:"Cantidad"},on:{input:function(e){return t.$emit("onInputCantidad",e)}},model:{value:t.productos[e.index].cantidad,callback:function(o){t.$set(t.productos[e.index],"cantidad",o)},expression:"productos[data.index].cantidad"}})]}},{key:"precio",fn:function(e){return[o("b-form-input",{attrs:{type:"number",min:"0",step:"0.01",placeholder:"Precio"},on:{input:function(o){t.setNuevoPrecioContado(e.index)}},model:{value:t.productos[e.index].precio,callback:function(o){t.$set(t.productos[e.index],"precio",o)},expression:"productos[data.index].precio"}})]}},{key:"subtotal",fn:function(e){return[t._v("\n        "+t._s(t.getSubtotal(e.index))+"\n      ")]}},{key:"igv",fn:function(e){return[o("b-form-checkbox",{attrs:{value:1,"unchecked-value":0},on:{input:function(o){t.setNuevoPrecioContado(e.index)}},model:{value:t.productos[e.index].TieneIgv,callback:function(o){t.$set(t.productos[e.index],"TieneIgv",o)},expression:"productos[data.index].TieneIgv"}},[o("div",[t._v(t._s(t.getIgv(e.index)))])])]}},{key:"precioVenta",fn:function(e){return[o("b-form-input",{staticStyle:{width:"80px"},attrs:{type:"number",min:"0",step:"0.01",placeholder:"Precio Venta"},model:{value:t.productos[e.index].nuevoPrecioContado,callback:function(o){t.$set(t.productos[e.index],"nuevoPrecioContado",o)},expression:"productos[data.index].nuevoPrecioContado"}}),t._v(" "),o("b-form-text",[o("strike",[t._v(" "+t._s(t.productos[e.index].normalPrecioContado)+" ")])],1)]}},{key:"descuento",fn:function(e){return[o("b-form-input",{attrs:{type:"number",min:"0",step:"0.01",value:0},model:{value:t.productos[e.index].descuento,callback:function(o){t.$set(t.productos[e.index],"descuento",o)},expression:"productos[data.index].descuento"}}),t._v(" "),o("b-form-text")]}},{key:"total",fn:function(e){return[t._v("\n        "+t._s(t.getTotal(e.index))+"\n      ")]}},{key:"acciones",fn:function(e){return[o("b-button",{attrs:{variant:"danger",size:"sm"},on:{click:function(o){t.quitarProducto(e.index)}}},[t._v("X")])]}},{key:"show_details",fn:function(e){return[o("b-button",{attrs:{size:"sm",variant:"info"},on:{click:function(t){return t.stopPropagation(),e.toggleDetails(t)}}},[t._v(">")])]}},{key:"row-details",fn:function(t){}}])})],1),t._v(" "),o("b-col",{attrs:{md:"3"}},[t._t("operaciones")],2),t._v(" "),o("b-col",{attrs:{md:"4"}},[t._t("metodopago")],2),t._v(" "),o("b-col",{attrs:{md:"3","offset-md":"2"}},[o("table",{staticClass:"table b-table border table-footer"},[o("tbody",[t.sumatoriaDescuento>0?o("tr",[o("td",{staticClass:"table-success"},[t._v("SubTotal")]),t._v(" "),o("td",{staticClass:"table-success"},[t._v(t._s(t._f("redondear")(parseFloat(t.sumatoriaSubTotal)+parseFloat(t.sumatoriaDescuento))))])]):t._e(),t._v(" "),t.sumatoriaDescuento>0?o("tr",[o("td",{staticClass:"table-danger"},[t._v("Descuento")]),t._v(" "),o("td",{staticClass:"table-danger"},[t._v("- "+t._s(t.sumatoriaDescuento))])]):t._e(),t._v(" "),o("tr",[o("td",[o("b",[t._v("SubTotal")])]),t._v(" "),o("td",{staticClass:"table-danger"},[t._v(t._s(t.sumatoriaSubTotal))])]),t._v(" "),t.sumatoriaIgv>0?o("tr",[o("td",[o("b",[t._v("IGV")])]),t._v(" "),o("td",{staticClass:"table-danger"},[t._v(t._s(t.sumatoriaIgv))])]):t._e(),t._v(" "),o("tr",[o("td",[o("b",[t._v("TOTAL")])]),t._v(" "),o("td",{staticClass:"table-danger"},[t._v(t._s(t.sumatoriaTotal))])])])])]),t._v(" "),o("br"),o("br")],1)},staticRenderFns:[]};var w=o("VU/8")(A,I,!1,function(t){o("UiDO")},null,null).exports,y={data:function(){return{API:m.a.API,show:!1,proveedor:{Proveedor:"",Ruc:"",Direccion:"",Observacion:"",FechaReg:null}}},props:["newRuc"],methods:{shownProveedorForm:function(){this.proveedor.Ruc=this.$parent.$parent.newRuc,this.proveedor.Direccion="",this.proveedor.Proveedor=""},consultarRUC:function(){var t=this;this.axios.get(this.API+"consultarRUC",{params:{type:"RUC",numero:this.proveedor.Ruc}}).then(function(e){t.$toasted.show("Proveedor encontrado, se llenarán sus datos");var o=e.data.result;t.proveedor.Proveedor=o.RazonSocial,t.proveedor.Direccion=o.Direccion}).catch(function(e){t.$toasted.show("No se encontró el RUC"),console.log(e)})},guardarProveedor:function(){var t=this;this.axios.post(this.API+"proveedores",this.proveedor).then(function(e){t.$toasted.show("Proveedor guardado correctamente"),t.$refs.proveedorForm.hide()}).catch(function(e){t.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})}}},x={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-btn",{directives:[{name:"b-modal",rawName:"v-b-modal.modal1",modifiers:{modal1:!0}}],attrs:{variant:"primary"}},[t._v("Nuevo")]),t._v(" "),o("b-modal",{ref:"proveedorForm",attrs:{id:"modal1",title:"Nuevo Proveedor",size:"lg"},on:{shown:t.shownProveedorForm},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("b-row",[o("b-col",{attrs:{md:"12"}},[o("b-form-group",[o("label",[t._v("RUC:")]),t._v(" "),o("b-input-group",[o("b-form-input",{model:{value:t.proveedor.Ruc,callback:function(e){t.$set(t.proveedor,"Ruc",e)},expression:"proveedor.Ruc"}}),t._v(" "),o("b-input-group-append",[o("b-btn",{attrs:{variant:"info"},on:{click:t.consultarRUC}},[t._v("Buscar RUC")])],1)],1)],1),t._v(" "),o("b-form-group",[o("label",[t._v("Nombre del Proveedor:")]),t._v(" "),o("b-form-input",{attrs:{type:"text"},model:{value:t.proveedor.Proveedor,callback:function(e){t.$set(t.proveedor,"Proveedor",e)},expression:"proveedor.Proveedor"}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Dirección:")]),t._v(" "),o("b-form-input",{attrs:{type:"text"},model:{value:t.proveedor.Direccion,callback:function(e){t.$set(t.proveedor,"Direccion",e)},expression:"proveedor.Direccion"}})],1)],1)],1),t._v(" "),o("div",{attrs:{slot:"modal-footer"},slot:"modal-footer"},[o("b-btn",{attrs:{variant:"primary"},on:{click:t.guardarProveedor}},[t._v("\n         Guardar\n       ")]),t._v(" "),o("b-btn",{attrs:{variant:"secondary"},on:{click:function(e){t.show=!1}}},[t._v("\n         Close\n       ")])],1)],1)],1)},staticRenderFns:[]};var M=o("VU/8")(y,x,!1,function(t){o("9eGC")},null,null).exports,F={mounted:function(){},data:function(){return{inProgress:!1,newRuc:"",API:m.a.API,ultimoMovimiento:"",movimiento:this.initMovimiento()}},computed:c()({},Object(d.c)({proveedoresFiltrados:function(t){return t.proveedoresFiltrados},almacenes:function(t){return t.almacenesFiltrados},productos:function(t){return t.cart.productos}})),methods:c()({},Object(d.b)({buscarProveedores:"buscarProveedores",buscarAlmacenes:"buscarAlmacenes",limpiar:"limpiarCarrito"}),{cargarNumero:function(){var t=this;this.axios.get(this.API+"movimientos/numero",{params:{serie:this.movimiento.Serie,idMovimientoTipo:this.movimiento.movimientoTipo.IdMovimientoTipo}}).then(function(e){Vue.set(t.movimiento,"Numero",e.data.NuevoNumero||"0001")}).catch(function(t){console.log(t)})},initMovimiento:function(){var t=this.$moment().month()+1;return t=t<10?"0"+t:t,{EsCredito:0,alterarProductos:1,FechaVenCredito:"",Moneda:"PEN",FechaPeriodoTributario:this.$moment().year()+""+t,MovimientoFecha:"chrome"==this.$browser.name?this.$moment().format("YYYY-MM-DDThh:mm:ss"):this.$moment().format("YYYY-MM-DD hh:mm:ss"),FechaStock:this.$moment().format("YYYY-MM-DD"),TipoCambio:1,proveedor:{IdProveedor:0},movimientoTipo:{},almacenOrigen:{IdAlmacen:-1},almacenDestino:{IdAlmacen:-1}}},onReset:function(t){t.preventDefault()},setTipoMovimiento:function(t){0==t.Tipo?(this.movimiento.almacenOrigen={IdAlmacen:-1},this.movimiento.almacenDestino={IdAlmacen:1}):1==t.Tipo?(this.movimiento.almacenDestino={IdAlmacen:-1},this.movimiento.almacenOrigen={IdAlmacen:1}):(this.movimiento.almacenDestino={IdAlmacen:1},this.movimiento.almacenOrigen={IdAlmacen:1}),this.movimiento.movimientoTipo=t,this.cargarNumero()},setProveedor:function(t){this.movimiento.proveedor=t},setAlmacenOrigen:function(t){this.movimiento.almacenOrigen=t},setAlmacenDestino:function(t){this.movimiento.almacenDestino=t},setMoneda:function(t){this.movimiento.Moneda=t.Moneda},getProveedores:function(t){this.buscarProveedores(t)},getAlmacenes:function(t){this.buscarAlmacenes(t)},guardarMovimiento:function(t){var e=this;if(t.preventDefault(),this.inProgress=!0,!this.productos.length)return this.$toasted.show("No ha seleccionado ningun producto"),void(this.inProgress=!1);var o=!1;if(this.productos.forEach(function(t,e){t.total<=0&&(o=!0)}),o&&this.movimiento.alterarProductos)return this.$toasted.show("Falta llenar cantidad / precio"),void(this.inProgress=!1);this.axios.post(this.API+"movimientos",{movimiento:this.movimiento,productos:this.productos}).then(function(t){t.data.error?e.$toasted.show(t.data.error):(e.ultimoMovimiento=t.data.hash,e.movimiento=e.initMovimiento(),e.limpiar(),e.$refs.inputMovimiento.setValue(""),e.$refs.inputProveedor.setValue(""),e.$toasted.show("Movimiento guardado correctamente ")),e.inProgress=!1}).catch(function(t){e.$toasted.show("Ha ocurrido un error, vuelva a intentarlo"),e.inProgress=!1})},focusAutocomplete:function(t){this.$refs[t].handleDoubleClick()}}),components:{Menu:u,ProductosCarrito:w,ProveedoresForm:M}},T={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[t._e(),t._v(" "),o("br"),t._v(" "),o("b-form",{attrs:{validated:""},on:{submit:t.guardarMovimiento,reset:t.onReset}},[o("b-container",{staticClass:"bv-example-row"},[o("b-row",[o("b-col",{attrs:{md:"8"}},[o("b-row",[o("b-col",{attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Tipo de Movimiento:")]),t._v(" "),o("autocomplete",{ref:"inputMovimiento",attrs:{required:"required",url:t.API+"movimientos/tipos",anchor:"TipoMovimiento",label:"writer",placeholder:"","on-select":t.setTipoMovimiento,onFocus:t.focusAutocomplete.bind(null,"inputMovimiento"),classes:{input:"form-control"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"8"}},[o("b-form-group",[o("label",[t._v("Proveedor:")]),t._v(" "),o("b-input-group",[o("autocomplete",{ref:"inputProveedor",attrs:{required:"required",url:t.API+"proveedores",anchor:"ProveedorRuc",label:"writer",placeholder:"",onInput:function(e){return t.newRuc=e},"on-select":t.setProveedor,onFocus:t.focusAutocomplete.bind(null,"inputProveedor"),classes:{input:"form-control"}}}),t._v(" "),o("b-input-group-append",[o("proveedores-form",{attrs:{ruc:t.newRuc}})],1)],1)],1)],1)],1),t._v(" "),o("b-row",[o("b-col",{attrs:{md:"3"}},[o("b-form-group",[o("label",[t._v("Periodo Tributario:")]),t._v(" "),o("b-form-input",{attrs:{type:"text",readonly:"readonly",placeholder:"Periodo Tributario"},model:{value:t.movimiento.FechaPeriodoTributario,callback:function(e){t.$set(t.movimiento,"FechaPeriodoTributario",e)},expression:"movimiento.FechaPeriodoTributario"}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"3"}},[1==t.movimiento.movimientoTipo.Tipo||2==t.movimiento.movimientoTipo.Tipo?o("b-form-group",[o("label",[t._v("Almacen Origen:")]),t._v(" "),o("autocomplete",{ref:"inputAlmacenOrigen",attrs:{required:"required",initValue:"VENTA",url:t.API+"almacenes",anchor:"Almacen",label:"writer",placeholder:"","on-select":t.setAlmacenOrigen,onFocus:t.focusAutocomplete.bind(null,"inputAlmacenOrigen"),classes:{input:"form-control"}}})],1):t._e()],1),t._v(" "),o("b-col",{attrs:{md:"3"}},[0==t.movimiento.movimientoTipo.Tipo||2==t.movimiento.movimientoTipo.Tipo?o("b-form-group",[o("label",[t._v("Almacen Destino:")]),t._v(" "),o("autocomplete",{ref:"inputAlmacenDestino",attrs:{required:"required",initValue:"VENTA",url:t.API+"almacenes",anchor:"Almacen",label:"writer",placeholder:"","on-select":t.setAlmacenDestino,onFocus:t.focusAutocomplete.bind(null,"inputAlmacenDestino"),classes:{input:"form-control"}}})],1):t._e()],1),t._v(" "),o("b-col",{attrs:{md:"3"}},[o("b-form-group",{attrs:{label:"Credito: "}},[o("b-form-checkbox",{attrs:{id:"checkbox1",value:1,"unchecked-value":0},model:{value:t.movimiento.EsCredito,callback:function(e){t.$set(t.movimiento,"EsCredito",e)},expression:"movimiento.EsCredito"}},[t._v("\n                      Pago pendiente\n                    ")]),t._v(" "),t.movimiento.EsCredito?o("b-form-input",{attrs:{type:"date",placeholder:"Fecha Vencimiento"},model:{value:t.movimiento.FechaVenCredito,callback:function(e){t.$set(t.movimiento,"FechaVenCredito",e)},expression:"movimiento.FechaVenCredito"}}):t._e()],1)],1)],1),t._v(" "),o("b-row",[o("b-col",{attrs:{md:"6"}},[o("b-form-group",[o("b-form-checkbox",{attrs:{id:"alterar-productos",value:1,"unchecked-value":0},model:{value:t.movimiento.alterarProductos,callback:function(e){t.$set(t.movimiento,"alterarProductos",e)},expression:"movimiento.alterarProductos"}},[t._v("\n                      Alterar precio productos\n                    ")])],1)],1)],1)],1),t._v(" "),o("b-col",{attrs:{md:"4"}},[o("b-row",[o("b-col",{attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Serie:")]),t._v(" "),o("b-form-input",{attrs:{required:"required",type:"text",placeholder:""},on:{input:t.cargarNumero},model:{value:t.movimiento.Serie,callback:function(e){t.$set(t.movimiento,"Serie",e)},expression:"movimiento.Serie"}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Número:")]),t._v(" "),o("b-form-input",{attrs:{required:"required",type:"text",placeholder:""},model:{value:t.movimiento.Numero,callback:function(e){t.$set(t.movimiento,"Numero",e)},expression:"movimiento.Numero"}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Moneda:")]),t._v(" "),o("autocomplete",{attrs:{url:t.API+"monedas",initValue:"PEN",anchor:"Moneda",label:"writer",placeholder:"Moneda","on-select":t.setMoneda,classes:{input:"form-control"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"8"}},[o("b-form-group",[o("label",[t._v("Fecha Contable:")]),t._v(" "),o("b-form-input",{attrs:{type:"datetime-local",step:"1",placeholder:"Fecha Contable",disabled:"disabled"},model:{value:t.movimiento.MovimientoFecha,callback:function(e){t.$set(t.movimiento,"MovimientoFecha",e)},expression:"movimiento.MovimientoFecha"}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Fecha Stock:")]),t._v(" "),o("b-form-input",{attrs:{type:"date",placeholder:"Fecha Stock",disabled:"disabled"},model:{value:t.movimiento.FechaStock,callback:function(e){t.$set(t.movimiento,"FechaStock",e)},expression:"movimiento.FechaStock"}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Tipo de cambio:")]),t._v(" "),o("b-form-input",{attrs:{type:"number",placeholder:"Tipo de cambio"},model:{value:t.movimiento.TipoCambio,callback:function(e){t.$set(t.movimiento,"TipoCambio",e)},expression:"movimiento.TipoCambio"}})],1)],1)],1)],1)],1),t._v(" "),o("b-row",[o("b-col",[o("productos-carrito",{ref:"carrito"})],1)],1),t._v(" "),o("b-row",{staticClass:"text-center",attrs:{"align-h":"center"}},[o("b-col",{attrs:{cols:"4"}},[o("b-button",{attrs:{variant:"success",size:"lg",type:"submit",disabled:t.inProgress}},[t._v("Guardar")]),t._v(" "),t.ultimoMovimiento?o("b-button",{attrs:{target:"_blank",variant:"info",size:"lg",href:"/views/codigoBarra.php?hash="+t.ultimoMovimiento}},[t._v("Código de Barra")]):t._e()],1)],1)],1),t._v(" "),o("br"),o("br")],1)],1)},staticRenderFns:[]};var D=o("VU/8")(F,T,!1,function(t){o("zWhM")},null,null).exports,$={mounted:function(){var t=this;this.axios.get(this.API+"productos/count").then(function(e){t.totalRows=e.data.total})},data:function(){return{API:m.a.API,pageOptions:[5,10,15,50,100],filter:null,sortBy:"IdProducto",sortDesc:!1,productoSelect:{},items:[],isBusy:!1,fields:[{key:"CodigoBarra",label:"Codigo",sortable:!0},{key:"Producto",sortable:!0},{key:"ProductoCategoria",label:"Categoría",sortable:!0},{key:"ProductoMarca",label:"Marca",sortable:!0},{key:"ProductoModelo",label:"Modelo",sortable:!0},{key:"Color",sortable:!0},{key:"ProductoTalla",label:"Talla",sortable:!0},{key:"Genero",sortable:!0},{key:"Botapie",sortable:!0}],totalRows:50,perPage:10,currentPage:1}},methods:{rowClick:function(t,e){this.productoSelect=t,this.$refs.productoForm.show=!0},actualizarTabla:function(){this.$refs.tablaProductos.refresh()},nuevoProducto:function(){this.productoSelect={},this.$refs.productoForm.show=!0},myProvider:function(t){var e=this,o=this.API+"productos?limit="+t.perPage+"&page="+t.currentPage+"&filter="+(t.filter||"")+"&sortBy="+t.sortBy;return o+="&sortDesc="+(t.sortDesc?1:0),this.axios.get(o).then(function(t){return e.items=t.data,e.items}).catch(function(t){return[]})}},components:{ProductoForm:k}},V={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-container",{staticClass:"bv-example-row"},[o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"6"}},[o("b-form-group",{staticClass:"mb-0",attrs:{horizontal:"",label:"Buscar"}},[o("b-input-group",[o("b-form-input",{attrs:{placeholder:"Buscar"},on:{input:function(e){t.currentPage=1}},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),t._v(" "),o("b-input-group-append",[o("b-btn",{attrs:{disabled:!t.filter},on:{click:function(e){t.filter=""}}},[t._v("Limpiar")])],1)],1)],1),t._v(" "),o("br")],1),t._v(" "),o("b-col",{staticClass:"my-1",attrs:{md:"6"}},[o("b-form-group",{staticClass:"mb-0",attrs:{horizontal:"",label:"Mostrar"}},[o("b-form-select",{attrs:{options:t.pageOptions},on:{input:function(e){t.currentPage=1}},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1)],1),t._v(" "),o("b-table",{ref:"tablaProductos",attrs:{small:"",filter:t.filter,"sort-by":t.sortBy,"sort-desc":t.sortDesc,striped:"",hover:"",id:"my-table",busy:t.isBusy,items:t.myProvider,fields:t.fields,"per-page":t.perPage,"current-page":t.currentPage},on:{"update:sortBy":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"row-clicked":t.rowClick,"update:busy":function(e){t.isBusy=e}}}),t._v(" "),o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"6"}},[o("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)],1),t._v(" "),o("producto-form",{ref:"productoForm",attrs:{"producto-update":t.productoSelect,cbGuardar:t.actualizarTabla}}),t._v(" "),o("br"),t._v(" "),o("b-row",{staticClass:"text-center",attrs:{"align-h":"center"}},[o("b-col",{attrs:{cols:"4"}},[o("b-button",{attrs:{variant:"success",size:"lg"},on:{click:t.nuevoProducto}},[t._v("Nuevo")])],1)],1),t._v(" "),o("br"),o("br")],1)],1)},staticRenderFns:[]};var j=o("VU/8")($,V,!1,function(t){o("LDza")},null,null).exports,S=o("fZjL"),R=o.n(S),E={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"table-responsive"},[o("table",{staticClass:"table b-table table-sm"},[t._m(0),t._v(" "),o("tbody",t._l(t.kardexSaldo,function(e,r){return o("tr",{key:r},[o("td",[t._v(t._s(e.Fecha))]),t._v(" "),o("td",[t._v(t._s(e.Detalle)+" - "+t._s(e.Serie)+" - "+t._s(e.Numero))]),t._v(" "),o("td",[t._v(t._s(e.Nombres))]),t._v(" "),o("td",{class:{"table-warning":e.IngresoCantidad>0}},[t._v(t._s(e.IngresoCantidad))]),t._v(" "),o("td",{class:{"table-warning":e.IngresoPrecio>0}},[t._v(t._s(t._f("redondear")(e.IngresoPrecio)))]),t._v(" "),o("td",{class:{"table-warning":e.SalidaCantidad>0}},[t._v(t._s(e.SalidaCantidad))]),t._v(" "),o("td",{class:{"table-warning":e.SalidaPrecio>0}},[t._v(t._s(t._f("redondear")(e.SalidaPrecio)))]),t._v(" "),o("td",{staticClass:"table-danger"},[t._v(t._s(e.saldo))])])}))])])},staticRenderFns:[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("thead",[o("tr",[o("th",{attrs:{rowspan:"2"}},[t._v("FECHA")]),t._v(" "),o("th",{attrs:{rowspan:"2"}},[t._v("COMPROBANTE")]),t._v(" "),o("th",{attrs:{rowspan:"2"}},[t._v("PROVEEDOR/CLIENTE")]),t._v(" "),o("th",{attrs:{colspan:"2"}},[t._v("INGRESOS")]),t._v(" "),o("th",{attrs:{colspan:"2"}},[t._v("SALIDAS")]),t._v(" "),o("th",{staticClass:"table-danger",attrs:{rowspan:"2"}},[t._v("SALDO")])]),t._v(" "),o("tr",[o("th",[t._v("Cant.")]),t._v(" "),o("th",[t._v("Precio.")]),t._v(" "),o("th",[t._v("Cant.")]),t._v(" "),o("th",[t._v("Precio.")])])])}]};var N=o("VU/8")({mounted:function(){},data:function(){return{saldo:0}},props:["producto","kardex"],methods:{getSaldo:function(t){var e=0;return e+10}},computed:{kardexSaldo:function(){var t=0;return this.kardex.map(function(e){return t+=e.IngresoCantidad-e.SalidaCantidad,e.saldo=t,e})}}},E,!1,function(t){o("9n3c")},"data-v-dd077a08",null).exports,O={mounted:function(){var t=this;this.axios.get(this.API+"productos/count").then(function(e){t.totalRows=e.data.total})},data:function(){return{API:m.a.API,APISTOCK:"productos",tipoStock:"",showKardex:!1,almacen:{IdAlmacen:1,Almacen:"VENTA"},pageOptions:[5,10,15,50,100],filters:{},filter:"",sortBy:"IdProducto",sortDesc:!1,productoSelect:{},kardexSelect:[],items:[],itemsStock:[],isBusy:!1,fields:[{key:"CodigoBarra",label:"Código",sortable:!0},{key:"ProductoCategoria",label:"Categoría",sortable:!0},{key:"Producto",sortable:!0},{key:"ProductoMarca",label:"Marca",sortable:!0},{key:"ProductoModelo",label:"Modelo",sortable:!0},{key:"Color",sortable:!0},{key:"ProductoTalla",label:"Talla",sortable:!0},{key:"Genero",sortable:!0},{key:"Botapie",sortable:!0},{key:"stock",sortable:!1,variant:"",class:"text-center"}],totalRows:50,perPage:10,currentPage:1}},watch:{items:function(t){var e=this;this.axios.get(this.API+"productos/stock",{params:{idProductos:t.map(function(t){return t.IdProducto}),idAlmacen:this.almacen.IdAlmacen}}).then(function(t){console.log(t),e.itemsStock=t.data}).catch(function(t){console.log(t)})}},computed:{titleKardex:function(){return"KARDEX - / "+this.productoSelect.CodigoBarra+" / "+this.productoSelect.Producto+" / "+this.productoSelect.ProductoMarca+" / "+this.productoSelect.ProductoModelo+" / "+this.productoSelect.Color}},methods:{getStock:function(t){var e=this.itemsStock.findIndex(function(e){return e.IdProducto==t});return this.itemsStock[e]&&this.itemsStock[e].stock},focusAutocomplete:function(t){this.$refs[t].handleDoubleClick()},limpiarClassRows:function(){var t=this.$refs.tablaProductos.$el.rows;R()(t).forEach(function(e){t[e].classList.remove("table-info")})},setAlmacen:function(t){var e=this;this.almacen=t,this.limpiarFiltros(),console.log(this.filter),Vue.nextTick(function(){return e.$refs.tablaProductos.refresh()})},rowClick:function(t,e,o){this.limpiarClassRows(),o.target.parentNode.classList.add("table-info"),this.productoSelect=t},rowDblClick:function(t){var e=this;this.productoSelect=t,this.showKardex=!0,this.axios.get(this.API+"productos/kardex/"+this.productoSelect.IdProducto+"?limit=0",{params:{idAlmacen:this.almacen.IdAlmacen,fechaHasta:this.$moment().format("YYYY-MM-DDTH:mm:ss")}}).then(function(t){e.kardexSelect=t.data})},actualizarTabla:function(){this.$refs.tablaProductos.refresh()},myProvider:function(t){var e=this,o=this.API+this.APISTOCK+"?idAlmacen="+this.almacen.IdAlmacen+"&limit="+t.perPage+"&page="+t.currentPage+"&filter="+(t.filter||"")+"&sortBy="+t.sortBy;return console.log(o),o+="&sortDesc="+(t.sortDesc?1:0),this.axios.get(o).then(function(t){return e.items=t.data,e.items}).catch(function(t){return[]})},limpiarFiltros:function(){this.APISTOCK="productos",this.tipoStock="",this.filters={},this.filter="",this.$refs.inputCategoria.setValue(""),this.$refs.inputProducto.setValue(""),this.$refs.inputMarca.setValue(""),this.$refs.inputModelo.setValue(""),this.$refs.inputColor.setValue(""),this.$refs.inputTalla.setValue(""),this.$refs.inputGenero.setValue(""),this.$refs.inputBotapie.setValue(""),this.productoSelect={},this.limpiarClassRows(),console.log(this.filter)},generateFilter:function(t,e){this.filters[t]=e;var o="";for(var t in this.filters)o+="&filter["+t+"]="+this.filters[t],"stock"==t&&(this.APISTOCK="productos/stock");this.filter=o},exportarProductos:function(){}},components:{ProductoKardex:N}},B={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-container",{staticClass:"bv-example-row",attrs:{fluid:""}},[o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"7","offset-md":"5"}},[o("b-row",[o("b-col",{attrs:{md:"3"}},[o("b-form-group",[o("label",[t._v("Almacen:")]),t._v(" "),o("autocomplete",{ref:"inputAlmacen",attrs:{required:"required",url:t.API+"almacenes",anchor:"Almacen",initValue:"VENTA",label:"writer",placeholder:"","on-select":t.setAlmacen,onFocus:t.focusAutocomplete.bind(null,"inputAlmacen"),classes:{input:"form-control"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"3"}},[o("b-form-group",{attrs:{label:"Tipo de Muestra"}},[o("b-form-radio-group",{attrs:{"button-variant":"primary",buttons:"",name:"butons1",options:[{text:"Stock > 0",value:"mayor"},{text:"Stock <= 0",value:"menor"}]},on:{change:function(e){return t.generateFilter("stock",e)}},model:{value:t.tipoStock,callback:function(e){t.tipoStock=e},expression:"tipoStock"}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"3"}},[o("b-form-group",{attrs:{label:"Limpiar Filtros"}},[o("b-button",{attrs:{disabled:!t.filter},on:{click:t.limpiarFiltros}},[t._v("Limpiar")])],1),t._v(" "),o("br")],1),t._v(" "),o("b-col",{attrs:{md:"3"}},[o("b-form-group",{attrs:{label:"Mostrar"}},[o("b-form-select",{attrs:{options:t.pageOptions},on:{input:function(e){t.currentPage=1}},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1)],1)],1)],1)],1),t._v(" "),o("b-row",[o("b-col",{attrs:{md:"6"}},[o("b-row",[o("b-col",{attrs:{md:"3"}},[o("b-form-group",[o("label",[t._v("Categoría:")]),t._v(" "),o("autocomplete",{ref:"inputCategoria",attrs:{url:t.API+"categorias",anchor:"ProductoCategoria",label:"writer","on-select":function(e){return t.generateFilter("categoria",e.ProductoCategoria)},onInput:function(e){return!e&&t.generateFilter("categoria",e)},classes:{input:"form-control upper"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"3"}},[o("b-form-group",[o("label",[t._v("Producto:")]),t._v(" "),o("autocomplete",{ref:"inputProducto",attrs:{url:t.API+"productos",anchor:"Producto",label:"writer","on-select":function(e){return t.generateFilter("producto",e.Producto)},onInput:function(e){return t.generateFilter("producto",e)},classes:{input:"form-control upper"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"3"}},[o("b-form-group",[o("label",[t._v("Marca:")]),t._v(" "),o("autocomplete",{ref:"inputMarca",attrs:{url:t.API+"marcas",anchor:"ProductoMarca",label:"writer","on-select":function(e){return t.generateFilter("marca",e.ProductoMarca)},onInput:function(e){return!e&&t.generateFilter("marca",e)},classes:{input:"form-control upper"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"3"}},[o("b-form-group",[o("label",[t._v("Modelo:")]),t._v(" "),o("autocomplete",{ref:"inputModelo",attrs:{url:t.API+"productos/modelos",anchor:"ProductoModelo",label:"writer","on-select":function(e){return t.generateFilter("modelo",e.ProductoModelo)},onInput:function(e){return!e&&t.generateFilter("modelo",e)},classes:{input:"form-control upper"}}})],1)],1)],1)],1),t._v(" "),o("b-col",{attrs:{md:"6"}},[o("b-row",[o("b-col",{attrs:{md:"3"}},[o("b-form-group",[o("label",[t._v("Color:")]),t._v(" "),o("autocomplete",{ref:"inputColor",attrs:{url:t.API+"productos/colores",anchor:"Color",label:"writer","on-select":function(e){return t.generateFilter("color",e.Color)},onInput:function(e){return!e&&t.generateFilter("color",e)},classes:{input:"form-control upper"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"3"}},[o("b-form-group",[o("label",[t._v("Talla:")]),t._v(" "),o("autocomplete",{ref:"inputTalla",attrs:{url:t.API+"tallas",anchor:"ProductoTalla",label:"writer","on-select":function(e){return t.generateFilter("talla",e.ProductoTalla)},onInput:function(e){return!e&&t.generateFilter("talla",e)},classes:{input:"form-control upper"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"3"}},[o("b-form-group",[o("label",[t._v("Genero:")]),t._v(" "),o("autocomplete",{ref:"inputGenero",attrs:{url:t.API+"productos/generos",anchor:"Genero",label:"writer","on-select":function(e){return t.generateFilter("genero",e.Genero)},onInput:function(e){return!e&&t.generateFilter("genero",e)},classes:{input:"form-control upper"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"3"}},[o("b-form-group",[o("label",[t._v("Botapie/Manga:")]),t._v(" "),o("autocomplete",{ref:"inputBotapie",attrs:{url:t.API+"productos/botapies",anchor:"Botapie",label:"writer","on-select":function(e){return t.generateFilter("botapie",e.Botapie)},onInput:function(e){return!e&&t.generateFilter("botapie",e)},classes:{input:"form-control upper"}}})],1)],1)],1)],1)],1),t._v(" "),o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"12"}},[o("table",{staticClass:"table border b-table table-footer table-sm table-detalle"},[o("thead",[o("tr",[o("th",[t._v("Producto")]),t._v(" "),o("th",{staticClass:"text-center"},[t._v("Precio de compra")]),t._v(" "),o("th",{staticClass:"text-center"},[t._v("Precio de venta")]),t._v(" "),o("th",{staticClass:"text-center"},[t._v("Stock")])])]),t._v(" "),o("tbody",[o("tr",[o("td",[t._v(t._s(t.productoSelect.Producto))]),t._v(" "),o("td",{staticClass:"text-center"},[t._v(t._s(t.productoSelect.PrecioCosto))]),t._v(" "),o("td",{staticClass:"text-center"},[t._v(t._s(t.productoSelect.PrecioContado))]),t._v(" "),o("td",{staticClass:"text-center table-info"},[t._v(t._s(t.getStock(t.productoSelect.IdProducto)))])])])])]),t._v(" "),o("b-col",{attrs:{md:"12"}},[o("b-table",{ref:"tablaProductos",attrs:{small:"",filter:t.filter,"sort-by":t.sortBy,"sort-desc":t.sortDesc,striped:"",hover:"",id:"tabla-productos",busy:t.isBusy,items:t.myProvider,fields:t.fields,"per-page":t.perPage,"current-page":t.currentPage},on:{"update:sortBy":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"row-clicked":t.rowClick,"row-dblclicked":t.rowDblClick,"update:busy":function(e){t.isBusy=e}},scopedSlots:t._u([{key:"stock",fn:function(e){return[o("div",{class:t.getStock(e.item.IdProducto)>0?"table-success":"table-danger",on:{click:function(t){return t.stopPropagation(),!1}}},[t._v("\n                  "+t._s(t.getStock(e.item.IdProducto))+"\n                ")])]}}])})],1),t._v(" "),o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"6"}},[o("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)],1),t._v(" "),o("br"),t._v(" "),o("b-row",{staticClass:"text-center",attrs:{"align-h":"center"}},[o("b-col",{attrs:{cols:"4"}},[o("b-button",{attrs:{variant:"success",size:"lg",href:"/api/index.php/reporte/stock?idAlmacen="+t.almacen.IdAlmacen,target:"_blank"}},[t._v("Exportar")])],1)],1),t._v(" "),o("br"),o("br")],1),t._v(" "),o("b-modal",{attrs:{id:"kardex",size:"lg","modal-class":"modal-xl",title:"Kardex de producto"},model:{value:t.showKardex,callback:function(e){t.showKardex=e},expression:"showKardex"}},[o("b-alert",{attrs:{show:"",variant:"warning"}},[t._v(t._s(t.titleKardex))]),t._v(" "),o("producto-kardex",{attrs:{producto:t.productoSelect,kardex:t.kardexSelect}})],1)],1)},staticRenderFns:[]};var U=o("VU/8")(O,B,!1,function(t){o("1lvo")},null,null).exports,z=o("pFYg"),q=o.n(z),G={data:function(){return{API:m.a.API,show:!1,cliente:{Cliente:"",DniRuc:"",Direccion:"",Telefono:"",Email:""}}},props:["newDniRuc"],methods:{shownClienteForm:function(){this.cliente.DniRuc=this.$parent.$parent.newDniRuc,this.cliente.Direccion="",this.cliente.Cliente="",this.cliente.Telefono="",this.cliente.Email=""},consultarDNIRUC:function(){var t=this,e=this.cliente.DniRuc.length>8?"RUC":"DNI";this.axios.get(this.API+"consultarRUC",{params:{type:e,numero:this.cliente.DniRuc}}).then(function(o){if(o.data){t.$toasted.show("Cliente encontrado, se llenarán sus datos");var r=o.data.result;"DNI"==e?t.cliente.Cliente=r.Nombre+" "+r.Paterno+" "+r.Materno:(t.cliente.Cliente=r.RazonSocial,t.cliente.Direccion=r.Direccion,t.cliente.Telefono=r.Telefono)}else t.$toasted.show("No se encontró el Usuario")}).catch(function(e){t.$toasted.show("No se encontró el Usuario"),console.log(e)})},guardarCliente:function(t){var e=this;t.preventDefault(),this.axios.post(this.API+"clientes",this.cliente).then(function(t){e.$emit("onAddCliente",t.data),e.$toasted.show("Cliente guardado correctamente"),e.$refs.clienteForm.hide()}).catch(function(t){e.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})}}},L={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-btn",{directives:[{name:"b-modal",rawName:"v-b-modal.modal1",modifiers:{modal1:!0}}],attrs:{variant:"primary"}},[t._v("Nuevo")]),t._v(" "),o("b-form",{on:{submit:t.guardarCliente}},[o("b-modal",{ref:"clienteForm",attrs:{id:"modal1",title:"Nuevo Cliente",size:"lg"},on:{shown:t.shownClienteForm},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("b-row",[o("b-col",{attrs:{md:"12"}},[o("b-form-group",[o("label",[t._v("DNI / RUC:")]),t._v(" "),o("b-input-group",[o("b-form-input",{attrs:{required:"required"},model:{value:t.cliente.DniRuc,callback:function(e){t.$set(t.cliente,"DniRuc",e)},expression:"cliente.DniRuc"}}),t._v(" "),o("b-input-group-append",[o("b-btn",{attrs:{variant:"info"},on:{click:t.consultarDNIRUC}},[t._v("Buscar ")])],1)],1)],1),t._v(" "),o("b-form-group",[o("label",[t._v("Nombre del Cliente:")]),t._v(" "),o("b-form-input",{attrs:{required:"required",type:"text"},model:{value:t.cliente.Cliente,callback:function(e){t.$set(t.cliente,"Cliente",e)},expression:"cliente.Cliente"}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Dirección:")]),t._v(" "),o("b-form-input",{attrs:{type:"text"},model:{value:t.cliente.Direccion,callback:function(e){t.$set(t.cliente,"Direccion",e)},expression:"cliente.Direccion"}})],1)],1)],1),t._v(" "),o("b-row",[o("b-col",[o("b-form-group",[o("label",[t._v("Teléfono:")]),t._v(" "),o("b-form-input",{attrs:{type:"text"},model:{value:t.cliente.Telefono,callback:function(e){t.$set(t.cliente,"Telefono",e)},expression:"cliente.Telefono"}})],1)],1),t._v(" "),o("b-col",[o("b-form-group",[o("label",[t._v("Correo Electrónico:")]),t._v(" "),o("b-form-input",{attrs:{type:"email"},model:{value:t.cliente.Email,callback:function(e){t.$set(t.cliente,"Email",e)},expression:"cliente.Email"}})],1)],1)],1),t._v(" "),o("div",{attrs:{slot:"modal-footer"},slot:"modal-footer"},[o("b-btn",{attrs:{variant:"primary",type:"submit"}},[t._v("\n         Guardar\n       ")]),t._v(" "),o("b-btn",{attrs:{variant:"secondary"},on:{click:function(e){t.show=!1}}},[t._v("\n         Close\n       ")])],1)],1)],1)],1)},staticRenderFns:[]};var Y=o("VU/8")(G,L,!1,function(t){o("lkyL")},null,null).exports,H={mounted:function(){this.obtenerDescuento()},data:function(){return{API:m.a.API,show:!1,porCada:20,puntos:1,valorPunto:1}},methods:{obtenerDescuento:function(){var t=this;this.axios.get(this.API+"ventas/descuento").then(function(e){t.porCada=e.data.PorCada,t.puntos=e.data.Puntos,t.valorPunto=e.data.ValorPunto}).catch(function(e){console.log(e),t.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})},guardarConfigVenta:function(t){var e=this;t.preventDefault(),this.axios.post(this.API+"ventas/descuento",{porCada:this.porCada,puntos:this.puntos,valorPunto:this.valorPunto}).then(function(t){e.$emit("onUpdateConfig",t.data),e.obtenerDescuento(),e.$toasted.show("Se actualizó la configuración"),e.show=!1}).catch(function(t){console.log(t),e.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})}}},K={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){t.show=!0}}},[t._v("Configurar")]),t._v(" "),o("b-form",{on:{submit:t.guardarConfigVenta}},[o("b-modal",{attrs:{id:"modalConfigVenta",title:"Configurar Venta",size:"md","header-bg-variant":"dark",headerTextVariant:"light","body-bg-variant":"light","body-text-variant":"dark"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("b-row",{staticClass:"mb-1"},[o("b-col",[o("label",{attrs:{for:"input-porcada"}},[t._v("Por la compra de:")])]),t._v(" "),o("b-col",[o("b-input-group",{attrs:{size:"sm",prepend:"S/. "}},[o("b-form-input",{attrs:{id:"input-porcada",type:"number",min:"0",step:"0.1",placeholder:""},model:{value:t.porCada,callback:function(e){t.porCada=e},expression:"porCada"}})],1)],1)],1),t._v(" "),o("b-row",{staticClass:"mb-1"},[o("b-col",[o("label",{attrs:{for:"input-porcada"}},[t._v("El cliente gana:")])]),t._v(" "),o("b-col",[o("b-input-group",{attrs:{size:"sm",append:"punto(s)"}},[o("b-form-input",{attrs:{id:"input-porcada",type:"number",min:"0",step:"1",placeholder:""},model:{value:t.puntos,callback:function(e){t.puntos=e},expression:"puntos"}})],1)],1)],1),t._v(" "),o("b-row",{staticClass:"mb-1"},[o("b-col",[o("label",{attrs:{for:"input-porcada"}},[t._v("Cada punto vale:")])]),t._v(" "),o("b-col",[o("b-input-group",{attrs:{size:"sm",prepend:"S/. "}},[o("b-form-input",{attrs:{id:"input-porcada",type:"number",min:"0",step:"0.1",placeholder:""},model:{value:t.valorPunto,callback:function(e){t.valorPunto=e},expression:"valorPunto"}})],1)],1)],1),t._v(" "),o("div",{attrs:{slot:"modal-footer"},slot:"modal-footer"},[o("b-btn",{attrs:{size:"sm",variant:"success",type:"submit"}},[t._v("\n                    Guardar\n                ")]),t._v(" "),o("b-btn",{attrs:{size:"sm",variant:"secondary"},on:{click:function(e){t.show=!1}}},[t._v("\n                    Cerrar\n                ")])],1)],1)],1)],1)},staticRenderFns:[]};var X=o("VU/8")(H,K,!1,function(t){o("SiCT")},null,null).exports,W={mounted:function(){var t=this;this.axios.get(this.API+"preorden/count").then(function(e){t.totalRows=e.data.total})},data:function(){return{API:m.a.API,show:!1,filter:"",items:[],isBusy:!1,fields:["IdPreOrden","FechaReg","Cliente","DniRuc"],totalRows:50,perPage:5,currentPage:1}},props:["idAlmacen"],methods:c()({},Object(d.b)({add:"agregarProducto",obtenerStok:"obtenerStock"}),{selectPreOrden:function(t){var e=this;console.log(t),this.axios.get(this.API+"preorden/detalle",{params:{idPreOrden:t.IdPreOrden}}).then(function(o){o.data.map(function(t){e.add([t.IdProducto,function(){e.obtenerStok({IdAlmacen:e.idAlmacen})},{setPrecio:!0,cantidad:t.Cantidad}]),e.filter="",e.show=!1}),e.$emit("onSelectPreOrden",t.IdCliente)})},myProvider:function(t){var e=this;return this.axios.get(this.API+"preorden?limit="+t.perPage+"&page="+t.currentPage+"&filter="+t.filter).then(function(t){return e.items=t.data,e.items}).catch(function(t){return[]})}})},J={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-button",{attrs:{variant:"outline-success"},on:{click:function(e){t.show=!0}}},[t._v("Cargar Pre Orden")]),t._v(" "),o("b-form",[o("b-modal",{attrs:{id:"modalPreOrden",title:"Seleccionar Pre Orden",size:"lg","header-bg-variant":"dark",headerTextVariant:"light","body-bg-variant":"light","body-text-variant":"dark"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("b-form-input",{attrs:{placeholder:"Buscar"},on:{input:function(e){t.currentPage=1}},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),t._v(" "),o("b-table",{attrs:{id:"my-table",striped:"",hover:"",busy:t.isBusy,filter:t.filter,items:t.myProvider,fields:t.fields,"per-page":t.perPage,"current-page":t.currentPage},on:{"update:busy":function(e){t.isBusy=e},"row-clicked":t.selectPreOrden}}),t._v(" "),o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"6"}},[o("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1),t._v(" "),o("div",{attrs:{slot:"modal-footer"},slot:"modal-footer"},[o("b-btn",{attrs:{size:"sm",variant:"secondary"},on:{click:function(e){t.show=!1}}},[t._v("\n                    Cerrar\n                ")])],1)],1)],1)],1)},staticRenderFns:[]};var Z=o("VU/8")(W,J,!1,function(t){o("lMqM")},null,null).exports,Q={beforeMount:function(){this.initForm()},mounted:function(){this.getNumeroVenta()},data:function(){return{newDniRuc:"",ultimaVenta:"",inProgress:!1,API:m.a.API,puntosAplicados:0,descuentoPuntos:{},descuentoGeneral:0,tieneIgv:!1,venta:{},carrito:{fields:[{key:"stock",label:"Stock",variant:"info",class:"text-center"},{key:"Producto"},{key:"ProductoModelo",label:"Modelo"},{key:"ProductoMarca",label:"Marca"},{key:"ProductoTalla",label:"Talla"},{key:"Genero"},{key:"cantidad"},{key:"precio",label:"Precio"},{key:"subtotal",label:"SubTotal",variant:"success",class:"text-center"},{key:"descuento",label:"Descuento"},{key:"total",label:"Total",variant:"danger",class:"text-center"},{key:"acciones",label:""}]}}},watch:{totalCart:function(t){this.venta.pago.efectivo.monto=t-(parseFloat(this.venta.pago.visa.monto)+parseFloat(this.venta.pago.mastercard.monto))}},computed:c()({},Object(d.c)({productos:function(t){return t.cart.productos},totalCart:function(t){return t.cart.totalCart}})),methods:c()({},Object(d.b)({aplicarDescuento:"aplicarDescuentoGeneral",limpiarCart:"limpiarCarrito",obtenerStok:"obtenerStock"}),{focusAutocomplete:function(t){this.$refs[t].handleDoubleClick()},initForm:function(){this.venta={EsCredito:0,Serie:"",Numero:"",cliente:{},tipoVenta:{IdTipoDoc:3,TipoDoc:"TICKET",LimitItems:0},almacen:{IdAlmacen:1,Almacen:"VENTA"},puntoVenta:{IdDocVentaPuntoVenta:1,PuntoVenta:"CAJA1"},vendedor:{},FechaCredito:this.$moment().format("YYYY-MM-DD"),FechaDoc:this.$moment().format("YYYY-MM-DDTH:mm:ss"),pago:{efectivo:{IdMetodoPago:1,monto:0},visa:{IdMetodoPago:2,monto:0},mastercard:{IdMetodoPago:3,monto:0}}}},setTipoVenta:function(t){t.TieneIgv?this.tieneIgv=!0:this.tieneIgv=!1,this.venta.tipoVenta=t,this.getNumeroVenta()},setAlmacen:function(t){this.venta.almacen=t,this.obtenerStok({IdAlmacen:this.venta.almacen.IdAlmacen})},setPuntoVenta:function(t){this.venta.puntoVenta=t,this.getNumeroVenta()},setVendedor:function(t){this.venta.vendedor=t},setCliente:function(t){var e=this;"object"===(void 0===t?"undefined":q()(t))?(this.$refs.inputCliente.setValue(t.Cliente),this.venta.cliente=t):this.axios.get(this.API+"cliente",{params:{idCliente:t}}).then(function(t){e.$refs.inputCliente.setValue(t.data.Cliente),e.venta.cliente=t.data}).catch(function(t){console.log(t)})},onSetProducto:function(t){return t.cantidad=1,t.precio=t.PrecioContado||0,t},onAddProducto:function(t){this.actualizarDescuento(),this.obtenerStok({IdAlmacen:this.venta.almacen.IdAlmacen})},actualizarDescuento:function(){this.puntosAplicados>0&&this.aplicarPuntos(this.puntosAplicados),this.descuentoGeneral>0&&this.aplicarDescuentoGeneral(this.descuentoGeneral)},aplicarPuntos:function(t){var e=this;parseFloat(t)>this.venta.cliente.Puntos&&(this.puntosAplicados=this.venta.cliente.Puntos),this.axios.get(this.API+"ventas/descuento/"+this.puntosAplicados).then(function(t){e.descuentoPuntos=t.data,e.aplicarDescuento(t.data.descuento)}).catch(function(t){console.log(t),e.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})},aplicarDescuentoGeneral:function(t){this.puntosAplicados=0,this.aplicarDescuento(t)},getNumeroVenta:function(){var t=this;this.axios.get(this.API+"ventas/numero",{params:{idPuntoVenta:this.venta.puntoVenta.IdDocVentaPuntoVenta,idTipoDoc:this.venta.tipoVenta.IdTipoDoc}}).then(function(e){t.venta.Serie=e.data.serie,t.venta.Numero=e.data.numero}).catch(function(e){console.log(e),t.$toasted.show("Ha ocurrido un error, vuelva a intentarlo")})},updateTime:function(){this.venta.FechaDoc=this.$moment().format("YYYY-MM-DDTH:mm:ss")},guardarVenta:function(t){var e=this;t.preventDefault(),this.inProgress=!0;var o=0;return o+=parseFloat(this.venta.pago.efectivo.monto),o+=parseFloat(this.venta.pago.visa.monto),o+=parseFloat(this.venta.pago.mastercard.monto),this.venta.EsCredito||this.totalCart==o?this.productos.length?(this.venta.productos=this.productos,this.venta.puntosAplicados=this.puntosAplicados||0,this.venta.totalCart=this.totalCart||0,void this.axios.post(this.API+"ventas",this.venta).then(function(t){e.$toasted.show("Venta realizada con exito"),e.inProgress=!1,e.ultimaVenta=t.data.insertId,e.initForm(),e.limpiarCart(),e.getNumeroVenta(),e.$refs.inputCliente.setValue(""),e.$refs.inputVendedor.setValue(""),window.open("/imprimir/index.php?IdDocVenta="+t.data.insertId,"_blank")}).catch(function(t){console.log(t),e.$toasted.show("Ha ocurrido un error, vuelva a intentarlo"),e.inProgress=!1})):(this.$toasted.show("No hay productos para vender"),void(this.inProgress=!1)):(this.$toasted.show("Los pagos no coinciden con la venta"),void(this.inProgress=!1))},eliminarCliente:function(){this.$refs.inputCliente.setValue(""),this.venta.cliente={}}}),components:{ProductosCarrito:w,ClientesForm:Y,ConfigVenta:X,PreOrdenLista:Z}},tt={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[t._e(),t._v(" "),o("br"),t._v(" "),o("b-container",{staticClass:"bv-example-row"},[o("div",[o("div",{staticClass:"float-right"},[o("b-button-group",{attrs:{size:"sm"}},[o("pre-orden-lista",{attrs:{idAlmacen:t.venta.almacen.IdAlmacen},on:{onSelectPreOrden:t.setCliente}})],1),t._v(" "),o("b-button-group",{attrs:{size:"sm"}},[o("config-venta",{on:{onUpdateConfig:t.eliminarCliente}})],1)],1)]),t._v(" "),o("br"),o("br"),t._v(" "),o("b-form",{on:{submit:t.guardarVenta}},[o("b-row",[o("b-col",{attrs:{md:"7"}},[o("b-row",[o("b-col",{attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Tipo de Venta:")]),t._v(" "),o("autocomplete",{ref:"inputTipoVenta",attrs:{required:"required",url:t.API+"ventas/tipos",anchor:"TipoDoc",initValue:"TICKET",label:"writer",placeholder:"","on-select":t.setTipoVenta,onFocus:t.focusAutocomplete.bind(null,"inputTipoVenta"),classes:{input:"form-control"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Almacen:")]),t._v(" "),o("autocomplete",{ref:"inputAlmacen",attrs:{required:"required",url:t.API+"almacenes",anchor:"Almacen",initValue:"VENTA",label:"writer",placeholder:"","on-select":t.setAlmacen,onFocus:t.focusAutocomplete.bind(null,"inputAlmacen"),classes:{input:"form-control"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Punto de Venta:")]),t._v(" "),o("autocomplete",{ref:"inputPuntoVenta",attrs:{required:"required",url:t.API+"ventas/puntos",anchor:"PuntoVenta",initValue:"CAJA1",label:"writer",placeholder:"","on-select":t.setPuntoVenta,onFocus:t.focusAutocomplete.bind(null,"inputPuntoVenta"),classes:{input:"form-control"}}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"12"}},[o("b-form-group",[o("label",[t._v("Cliente:")]),t._v(" "),o("b-input-group",[o("autocomplete",{ref:"inputCliente",attrs:{required:"required",url:t.API+"clientes",anchor:"ClienteDniRuc",label:"writer",placeholder:"",onInput:function(e){return t.newDniRuc=e},"on-select":t.setCliente,onFocus:t.focusAutocomplete.bind(null,"inputCliente"),classes:{input:"form-control"}}}),t._v(" "),o("b-input-group-append",[o("clientes-form",{attrs:{ruc:t.newDniRuc},on:{onAddCliente:t.setCliente}})],1)],1)],1)],1)],1)],1),t._v(" "),o("b-col",{attrs:{md:"3"}},[t.venta.cliente.Cliente?o("b-form-group",{staticClass:"text-center"},[o("div",{staticClass:"puntos"},[t._v("\n                            "+t._s(t._f("redondeoMenor")(t.venta.cliente.Puntos||0))+"\n                        ")]),t._v("\n                        Puntos del cliente\n                    ")]):t._e(),t._v(" "),t.venta.cliente.Puntos&&0==t.descuentoGeneral?o("b-input-group",{attrs:{prepend:"Puntos",append:t._f("redondear")(t.descuentoPuntos.descuento)}},[o("b-form-input",{attrs:{min:"0",max:t.venta.cliente.Puntos,type:"number"},on:{input:t.aplicarPuntos},model:{value:t.puntosAplicados,callback:function(e){t.puntosAplicados=e},expression:"puntosAplicados"}})],1):t._e(),t._v(" "),t.descuentoPuntos.ValorPunto?o("b-form-text",[t._v("\n                       1 Punto equivale a: S/ "+t._s(t._f("redondear")(t.descuentoPuntos.ValorPunto))+"\n                    ")]):t._e()],1),t._v(" "),o("b-col",{attrs:{md:"2"}},[o("b-form-group",{staticClass:"text-center"},[o("div",{staticClass:"big-text"},[t._v("\n                            "+t._s(t.venta.Serie)+" - "),o("b",[t._v(t._s(t.venta.Numero))])]),t._v("\n                        "+t._s(t.venta.FechaDoc)+"\n                    ")]),t._v(" "),o("b-form-group",[o("label",[t._v("Vendedor:")]),t._v(" "),o("autocomplete",{ref:"inputVendedor",attrs:{required:"required",url:t.API+"usuarios",anchor:"NombreUsuario",label:"writer","on-select":t.setVendedor,onFocus:t.focusAutocomplete.bind(null,"inputVendedor"),classes:{input:"form-control"}}})],1)],1)],1),t._v(" "),o("b-row",[o("b-col",[o("productos-carrito",{ref:"carrito",attrs:{igvTotal:t.tieneIgv,setPrecio:!0,showButton:!1,fields:t.carrito.fields,onSetProducto:t.onSetProducto},on:{onInputCantidad:t.actualizarDescuento,onAddProducto:t.onAddProducto,onRemoveProducto:t.actualizarDescuento}},[o("template",{slot:"operaciones"},[o("table",{staticClass:"table b-table border table-footer"},[o("tbody",[o("tr",[o("td",{staticClass:"text-center"},[t._v("Opciones")])]),t._v(" "),0==t.puntosAplicados?o("tr",[o("td",[o("b-input-group",{attrs:{prepend:"S/",append:"Descuento"}},[o("b-form-input",{attrs:{min:"0",value:"0",type:"number"},on:{input:t.aplicarDescuentoGeneral},model:{value:t.descuentoGeneral,callback:function(e){t.descuentoGeneral=e},expression:"descuentoGeneral"}})],1),t._v(" "),o("b-form-text",[t._v("\n                                                Descuento general a toda la venta.\n                                            ")])],1)]):t._e(),t._v(" "),o("tr",[o("td",[o("b-form-checkbox",{attrs:{id:"checkbox1",value:1,"unchecked-value":0},model:{value:t.venta.EsCredito,callback:function(e){t.$set(t.venta,"EsCredito",e)},expression:"venta.EsCredito"}},[t._v("\n                                                Venta a credito\n                                            ")]),t._v(" "),t.venta.EsCredito?o("b-form-input",{attrs:{type:"date"},model:{value:t.venta.FechaCredito,callback:function(e){t.$set(t.venta,"FechaCredito",e)},expression:"venta.FechaCredito"}}):t._e()],1)])])])]),t._v(" "),t.venta.EsCredito?t._e():o("template",{slot:"metodopago"},[o("table",{staticClass:"table b-table border table-footer table-sm"},[o("tbody",[o("tr",[o("td",{staticClass:"text-center",attrs:{colspan:"3"}},[t._v("Metodo de Pago")])]),t._v(" "),o("tr",[o("td",[t._v("Efectivo")]),t._v(" "),o("td",[o("b-form-input",{attrs:{type:"text",placeholder:"Descripcion"},model:{value:t.venta.pago.efectivo.descripcion,callback:function(e){t.$set(t.venta.pago.efectivo,"descripcion",e)},expression:"venta.pago.efectivo.descripcion"}})],1),t._v(" "),o("td",[o("b-form-input",{attrs:{min:"0",type:"number",placeholder:"S/."},model:{value:t.venta.pago.efectivo.monto,callback:function(e){t.$set(t.venta.pago.efectivo,"monto",e)},expression:"venta.pago.efectivo.monto"}})],1)]),t._v(" "),o("tr",[o("td",[t._v("Visa")]),t._v(" "),o("td",[o("b-form-input",{attrs:{min:"0",type:"text",placeholder:"Descripcion"},model:{value:t.venta.pago.visa.descripcion,callback:function(e){t.$set(t.venta.pago.visa,"descripcion",e)},expression:"venta.pago.visa.descripcion"}})],1),t._v(" "),o("td",[o("b-form-input",{attrs:{min:"0",type:"number",placeholder:"S/."},model:{value:t.venta.pago.visa.monto,callback:function(e){t.$set(t.venta.pago.visa,"monto",e)},expression:"venta.pago.visa.monto"}})],1)]),t._v(" "),o("tr",[o("td",[t._v("Mastercard")]),t._v(" "),o("td",[o("b-form-input",{attrs:{min:"0",type:"text",placeholder:"Descripcion"},model:{value:t.venta.pago.mastercard.descripcion,callback:function(e){t.$set(t.venta.pago.mastercard,"descripcion",e)},expression:"venta.pago.mastercard.descripcion"}})],1),t._v(" "),o("td",[o("b-form-input",{attrs:{min:"0",type:"number",placeholder:"S/."},model:{value:t.venta.pago.mastercard.monto,callback:function(e){t.$set(t.venta.pago.mastercard,"monto",e)},expression:"venta.pago.mastercard.monto"}})],1)])])])])],2)],1)],1),t._v(" "),o("b-row",{staticClass:"text-center",attrs:{"align-h":"center"}},[o("b-col",{attrs:{cols:"8"}},[o("br"),t._v(" "),o("b-button",{attrs:{type:"submit",disabled:t.inProgress,variant:"success",size:"lg"}},[t._v("Efectuar Venta")]),t._v(" "),t.ultimaVenta?o("b-button",{attrs:{target:"_blank",variant:"info",size:"lg",href:"/imprimir/index.php?IdDocVenta="+t.ultimaVenta}},[t._v("Imprimir última Venta")]):t._e(),t._v(" "),o("br"),t._v(" "),o("br")],1)],1)],1)],1)],1)},staticRenderFns:[]};var et=o("VU/8")(Q,tt,!1,function(t){o("bvUj")},null,null).exports,ot={mounted:function(){var t=this;this.axios.get(this.API+"ventas/count",{params:{idAlmacen:this.almacen.IdAlmacen}}).then(function(e){t.totalRows=e.data.total}),this.getVentasAcumuladas()},data:function(){return{API:m.a.API,vendedor:"",fechaInicio:this.$moment().format("YYYY-MM-DD"),fechaFin:this.$moment().format("YYYY-MM-DD"),declarado:1,filters:{},filter:"",sortBy:"FechaDoc",sortDesc:!1,ventasAcumuladas:0,almacen:{IdAlmacen:1,Almacen:"VENTA"},pageOptions:[5,10,15,50,100],ventaSelect:{},ventaDetalleSelect:[],items:[],showVenta:!1,isBusy:!1,fields:[{key:"idDocVenta",label:"ID",sortable:!0},{key:"FechaDoc",label:"Fecha",sortable:!0},{key:"TipoDoc",label:"Documento",sortable:!0},{key:"Serie",label:"Serie",sortable:!0},{key:"Numero",sortable:!0},{key:"Cliente",sortable:!0},{key:"Anulado",label:"Anulado",sortable:!0},{key:"UsuarioReg",label:"Vendedor",sortable:!0},{key:"Total",sortable:!1,variant:"success",class:"text-center"}],totalRows:50,perPage:10,currentPage:1}},computed:{},methods:{setVendedor:function(t){this.currentPage=1,this.vendedor=t,this.generateFilter("vendedor",t.Usuario)},getVentasAcumuladas:function(){var t=this;this.filters.vendedor?this.axios.get(this.API+"ventas/usuario",{params:{usuario:this.vendedor.Usuario,fechaInicio:this.fechaInicio,fechaFin:this.fechaFin}}).then(function(e){t.ventasAcumuladas=e.data.total}):this.axios.get(this.API+"ventas/total",{params:{fechaInicio:this.fechaInicio,fechaFin:this.fechaFin}}).then(function(e){t.ventasAcumuladas=e.data.total})},focusAutocomplete:function(t){this.$refs[t].handleDoubleClick()},setAlmacen:function(t){var e=this;this.almacen=t,this.limpiarFiltros(),Vue.nextTick(function(){return e.$refs.tablaVentas.refresh()})},rowClick:function(t){var e=this;this.ventaSelect=t,this.showKardex=!0,this.axios.get(this.API+"productos/kardex/10?limit=0",{params:{idAlmacen:this.almacen.IdAlmacen,fechaHasta:this.$moment().format("YYYY-MM-DDTH:mm:ss")}}).then(function(t){e.ventaDetalleSelect=t.data})},actualizarTabla:function(){this.$refs.tablaVentas.refresh()},myProvider:function(t){var e=this,o=this.API+"ventas?idAlmacen="+this.almacen.IdAlmacen+"&limit="+t.perPage+"&page="+t.currentPage+"&filter="+(t.filter||"")+"&sortBy="+t.sortBy;return o+="&sortDesc="+(t.sortDesc?1:0),console.log(o),this.axios.get(o).then(function(t){return e.items=t.data,e.items}).catch(function(t){return[]})},limpiarFiltros:function(){this.filters={},this.filter="",this.$refs.inputVendedor.setValue("")},generateFilter:function(t,e){this.filters[t]=e;var o="";for(var t in this.filters)o+="&filter["+t+"]="+this.filters[t];this.filter=o,this.getVentasAcumuladas()},exportarProductos:function(){}},components:{ProductoKardex:N}},rt={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-container",{staticClass:"bv-example-row"},[o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"10"}},[o("b-row",[o("b-col",{attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Almacen:")]),t._v(" "),o("autocomplete",{ref:"inputAlmacen",attrs:{required:"required",url:t.API+"almacenes",anchor:"Almacen",initValue:"VENTA",label:"writer",placeholder:"","on-select":t.setAlmacen,onFocus:t.focusAutocomplete.bind(null,"inputAlmacen"),classes:{input:"form-control"}}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Fecha Inicio:")]),t._v(" "),o("b-form-input",{attrs:{type:"date",placeholder:""},on:{input:function(e){return t.generateFilter("fechaInicio",e)}},model:{value:t.fechaInicio,callback:function(e){t.fechaInicio=e},expression:"fechaInicio"}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"4"}},[o("b-form-group",{attrs:{label:"Declarado"}},[o("b-form-radio-group",{attrs:{id:"btnradios1",buttons:"",options:[{text:"SI",value:1},{text:"NO",value:0}],name:"radiosBtnDefault"},on:{input:function(e){return t.generateFilter("declarado",e)}},model:{value:t.declarado,callback:function(e){t.declarado=e},expression:"declarado"}})],1),t._v(" "),o("b-form-group",[o("label",[t._v("Fecha Fin:")]),t._v(" "),o("b-form-input",{attrs:{type:"date",placeholder:""},on:{input:function(e){return t.generateFilter("fechaFin",e)}},model:{value:t.fechaFin,callback:function(e){t.fechaFin=e},expression:"fechaFin"}})],1)],1),t._v(" "),o("b-col",{attrs:{md:"4"}},[o("b-form-group",[o("label",[t._v("Vendedor:")]),t._v(" "),o("autocomplete",{ref:"inputVendedor",attrs:{required:"required",url:t.API+"usuarios",anchor:"NombreUsuario",label:"writer","on-select":t.setVendedor,onInput:function(e){return!e&&t.generateFilter("vendedor",e)},onFocus:t.focusAutocomplete.bind(null,"inputVendedor"),classes:{input:"form-control"}}})],1),t._v(" "),o("div",{staticClass:"total-ventas"},[t._v("\n                S/ "+t._s(t.ventasAcumuladas||"0.00")+"\n              ")])],1)],1)],1),t._v(" "),o("b-col",{staticClass:"my-1",attrs:{md:"2"}},[o("b-row",[o("b-col",{attrs:{md:"12"}},[o("b-form-group",{attrs:{label:"Limpiar Filtros"}},[o("b-button",{attrs:{disabled:!t.filter},on:{click:t.limpiarFiltros}},[t._v("Limpiar")])],1),t._v(" "),o("b-form-group",{attrs:{label:"Mostrar"}},[o("b-form-select",{attrs:{options:t.pageOptions},on:{input:function(e){t.currentPage=1}},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1),t._v(" "),o("br")],1)],1)],1)],1),t._v(" "),o("b-row",[o("b-col",{attrs:{md:"12"}},[o("b-table",{ref:"tablaVentas",attrs:{small:"",filter:t.filter,"sort-by":t.sortBy,"sort-desc":t.sortDesc,striped:"",hover:"",id:"tabla-ventas",busy:t.isBusy,items:t.myProvider,fields:t.fields,"per-page":t.perPage,"current-page":t.currentPage},on:{"update:sortBy":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"row-clicked":t.rowClick,"update:busy":function(e){t.isBusy=e}},scopedSlots:t._u([{key:"stock",fn:function(e){return[o("div",{class:t.getStock(e.item.IdProducto)>0?"table-success":"table-danger",on:{click:function(t){return t.stopPropagation(),!1}}},[t._v("\n                  "+t._s(t.getStock(e.item.IdProducto))+"\n                ")])]}}])})],1),t._v(" "),o("b-row",[o("b-col",{staticClass:"my-1",attrs:{md:"6"}},[o("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)],1),t._v(" "),o("br"),t._v(" "),o("b-row",{staticClass:"text-center",attrs:{"align-h":"center"}},[o("b-col",{attrs:{cols:"4"}},[o("b-button",{attrs:{variant:"success",size:"lg",href:"/api/index.php/reporte/stock?idAlmacen="+t.almacen.IdAlmacen,target:"_blank"}},[t._v("Exportar")])],1)],1),t._v(" "),o("br"),o("br")],1),t._v(" "),o("b-modal",{attrs:{id:"kardex",size:"lg","modal-class":"modal-xl",title:"Kardex de producto"},model:{value:t.showVenta,callback:function(e){t.showVenta=e},expression:"showVenta"}},[o("b-alert",{attrs:{show:"",variant:"warning"}},[t._v("titulo")])],1)],1)},staticRenderFns:[]};var at=o("VU/8")(ot,rt,!1,function(t){o("Z4X0")},null,null).exports;r.a.use(i.a);var nt=new i.a({routes:[{path:"/",name:"Movimiento",component:D},{path:"/productos",name:"Productos",component:j},{path:"/almacen",name:"Almacen",component:U},{path:"/ventas",name:"Ventas",component:et},{path:"/reportes/ventas",name:"ReporteVentas",component:at}]}),it=o("d7EF"),st=o.n(it),ct=o("mtWM"),lt=o.n(ct),ut={state:{productos:[],productosFiltrados:[],totalCart:0},mutations:{AGREGAR_PRODUCTO:function(t,e){var o=t.productos;o.find(function(t){return t.IdProducto===e.IdProducto})||o.push(e)},ELIMINAR_PRODUCTO:function(t,e){t.productos.splice(e,1)},LLENAR_PRODUCTOS_FILTRADOS:function(t,e){t.productosFiltrados=e},LIMPIAR_CART:function(t){t.productos=[]},APLICAR_DESCUENTO:function(t,e){var o=0;t.productos.forEach(function(t,e){o+=parseFloat(t.cantidad)}),t.productos=t.productos.map(function(t){return t.descuento=(e/o*t.cantidad).toFixed(2),t})},ACTUALIZAR_TOTAL:function(t,e){t.totalCart=e},OBTENER_STOCK:function(t,e){t.productos=t.productos.map(function(t){var o=e.findIndex(function(e){return e.IdProducto==t.IdProducto});return t.stock=e[o]&&e[o].stock,t})}},actions:{agregarProducto:function(t,e){var o=t.commit,r=st()(e,3),a=r[0],n=r[1],i=r[2],s=!1,c=!1;i&&(s=i.setPrecio,c=i.cantidad),"object"===(void 0===a?"undefined":q()(a))?(o("AGREGAR_PRODUCTO",a),n&&n(a)):lt.a.get(p.API+"productos/id/"+a).then(function(t){if(t.data){var e=t.data;s?(e.cantidad=1,e.precio=e.PrecioContado||0):(e.cantidad=0,e.precio=0),c&&(e.cantidad=c),e.descuento=0,e.nuevoPrecioContado=0,o("AGREGAR_PRODUCTO",e),n&&n(e)}else n&&n(!1)})},eliminarProducto:function(t,e){(0,t.commit)("ELIMINAR_PRODUCTO",e)},buscarProductos:function(t,e){var o=t.commit;lt.a.get(p.API+"productos?limit=10&q="+e).then(function(t){o("LLENAR_PRODUCTOS_FILTRADOS",t.data)})},limpiarCarrito:function(t){(0,t.commit)("LIMPIAR_CART")},aplicarDescuentoGeneral:function(t,e){(0,t.commit)("APLICAR_DESCUENTO",e)},actualizarTotalCart:function(t,e){(0,t.commit)("ACTUALIZAR_TOTAL",e)},obtenerStock:function(t,e){var o=t.commit,r=t.state;lt.a.get(p.API+"productos/stock",{params:{idProductos:r.productos.map(function(t){return t.IdProducto}),idAlmacen:e.IdAlmacen}}).then(function(t){o("OBTENER_STOCK",t.data)}).catch(function(t){console.log(t)})}}},dt={buscarProveedores:function(t,e){var o=t.commit;lt.a.get(p.API+"proveedores?limit=10&q="+e).then(function(t){o("LLENAR_PROVEEDORES_FILTRADOS",t.data)})},buscarAlmacenes:function(t,e){var o=t.commit;lt.a.get(p.API+"almacenes?q="+e).then(function(t){o("LLENAR_ALMACENES_FILTRADOS",t.data)})}};r.a.use(d.a);var pt=new d.a.Store({state:{proveedoresFiltrados:[],almacenesFiltrados:[]},actions:dt,mutations:{LLENAR_PROVEEDORES_FILTRADOS:function(t,e){t.proveedoresFiltrados=e},LLENAR_ALMACENES_FILTRADOS:function(t,e){t.almacenesFiltrados=e}},modules:{cart:ut}}),mt=o("e6fC"),vt=o("9XJu"),ft=o.n(vt),bt=o("Rf8U"),ht=o.n(bt),gt=o("IZMb"),Pt=o.n(gt),_t=o("mjDs"),Ct=o.n(_t),kt=o("+9Dj");o("Jmt5"),o("9M+g"),o("imi0"),o("ux0l"),Object(kt.detect)();r.a.prototype.$browser=Object(kt.detect)(),r.a.config.productionTip=!1,r.a.use(ht.a,lt.a),r.a.use(Pt.a,{theme:"bubble",position:"top-center",duration:3e3}),r.a.use(mt.a),r.a.use(Ct.a),r.a.component("autocomplete",ft.a),r.a.component("editable",{template:'<div contenteditable="true" @input="update"></div>',props:["content"],mounted:function(){this.$el.innerText=this.content},methods:{update:function(t){this.$emit("update",t.target.innerText)}}}),r.a.filter("redondear",function(t){return parseFloat(t||0).toFixed(2)}),r.a.filter("redondeoMayor",function(t){return Math.ceil(t||0)}),r.a.filter("redondeoMenor",function(t){return Math.floor(t||0)}),window.Vue=r.a,new r.a({el:"#app",router:nt,store:pt,components:{App:n},template:"<App/>"})},SiCT:function(t,e){},UdTa:function(t,e){t.exports={API:"http://rojas.neurosystemperu.com/api/index.php/"}},UiDO:function(t,e){},Vv6i:function(t,e){},Z4X0:function(t,e){},bvUj:function(t,e){},"gt/p":function(t,e){},imi0:function(t,e){},lMqM:function(t,e){},lkyL:function(t,e){},uslO:function(t,e,o){var r={"./af":"3CJN","./af.js":"3CJN","./ar":"3MVc","./ar-dz":"tkWw","./ar-dz.js":"tkWw","./ar-kw":"j8cJ","./ar-kw.js":"j8cJ","./ar-ly":"wPpW","./ar-ly.js":"wPpW","./ar-ma":"dURR","./ar-ma.js":"dURR","./ar-sa":"7OnE","./ar-sa.js":"7OnE","./ar-tn":"BEem","./ar-tn.js":"BEem","./ar.js":"3MVc","./az":"eHwN","./az.js":"eHwN","./be":"3hfc","./be.js":"3hfc","./bg":"lOED","./bg.js":"lOED","./bm":"hng5","./bm.js":"hng5","./bn":"aM0x","./bn.js":"aM0x","./bo":"w2Hs","./bo.js":"w2Hs","./br":"OSsP","./br.js":"OSsP","./bs":"aqvp","./bs.js":"aqvp","./ca":"wIgY","./ca.js":"wIgY","./cs":"ssxj","./cs.js":"ssxj","./cv":"N3vo","./cv.js":"N3vo","./cy":"ZFGz","./cy.js":"ZFGz","./da":"YBA/","./da.js":"YBA/","./de":"DOkx","./de-at":"8v14","./de-at.js":"8v14","./de-ch":"Frex","./de-ch.js":"Frex","./de.js":"DOkx","./dv":"rIuo","./dv.js":"rIuo","./el":"CFqe","./el.js":"CFqe","./en-au":"Sjoy","./en-au.js":"Sjoy","./en-ca":"Tqun","./en-ca.js":"Tqun","./en-gb":"hPuz","./en-gb.js":"hPuz","./en-ie":"ALEw","./en-ie.js":"ALEw","./en-il":"QZk1","./en-il.js":"QZk1","./en-nz":"dyB6","./en-nz.js":"dyB6","./eo":"Nd3h","./eo.js":"Nd3h","./es":"LT9G","./es-do":"7MHZ","./es-do.js":"7MHZ","./es-us":"INcR","./es-us.js":"INcR","./es.js":"LT9G","./et":"XlWM","./et.js":"XlWM","./eu":"sqLM","./eu.js":"sqLM","./fa":"2pmY","./fa.js":"2pmY","./fi":"nS2h","./fi.js":"nS2h","./fo":"OVPi","./fo.js":"OVPi","./fr":"tzHd","./fr-ca":"bXQP","./fr-ca.js":"bXQP","./fr-ch":"VK9h","./fr-ch.js":"VK9h","./fr.js":"tzHd","./fy":"g7KF","./fy.js":"g7KF","./gd":"nLOz","./gd.js":"nLOz","./gl":"FuaP","./gl.js":"FuaP","./gom-latn":"+27R","./gom-latn.js":"+27R","./gu":"rtsW","./gu.js":"rtsW","./he":"Nzt2","./he.js":"Nzt2","./hi":"ETHv","./hi.js":"ETHv","./hr":"V4qH","./hr.js":"V4qH","./hu":"xne+","./hu.js":"xne+","./hy-am":"GrS7","./hy-am.js":"GrS7","./id":"yRTJ","./id.js":"yRTJ","./is":"upln","./is.js":"upln","./it":"FKXc","./it.js":"FKXc","./ja":"ORgI","./ja.js":"ORgI","./jv":"JwiF","./jv.js":"JwiF","./ka":"RnJI","./ka.js":"RnJI","./kk":"j+vx","./kk.js":"j+vx","./km":"5j66","./km.js":"5j66","./kn":"gEQe","./kn.js":"gEQe","./ko":"eBB/","./ko.js":"eBB/","./ky":"6cf8","./ky.js":"6cf8","./lb":"z3hR","./lb.js":"z3hR","./lo":"nE8X","./lo.js":"nE8X","./lt":"/6P1","./lt.js":"/6P1","./lv":"jxEH","./lv.js":"jxEH","./me":"svD2","./me.js":"svD2","./mi":"gEU3","./mi.js":"gEU3","./mk":"Ab7C","./mk.js":"Ab7C","./ml":"oo1B","./ml.js":"oo1B","./mn":"CqHt","./mn.js":"CqHt","./mr":"5vPg","./mr.js":"5vPg","./ms":"ooba","./ms-my":"G++c","./ms-my.js":"G++c","./ms.js":"ooba","./mt":"oCzW","./mt.js":"oCzW","./my":"F+2e","./my.js":"F+2e","./nb":"FlzV","./nb.js":"FlzV","./ne":"/mhn","./ne.js":"/mhn","./nl":"3K28","./nl-be":"Bp2f","./nl-be.js":"Bp2f","./nl.js":"3K28","./nn":"C7av","./nn.js":"C7av","./pa-in":"pfs9","./pa-in.js":"pfs9","./pl":"7LV+","./pl.js":"7LV+","./pt":"ZoSI","./pt-br":"AoDM","./pt-br.js":"AoDM","./pt.js":"ZoSI","./ro":"wT5f","./ro.js":"wT5f","./ru":"ulq9","./ru.js":"ulq9","./sd":"fW1y","./sd.js":"fW1y","./se":"5Omq","./se.js":"5Omq","./si":"Lgqo","./si.js":"Lgqo","./sk":"OUMt","./sk.js":"OUMt","./sl":"2s1U","./sl.js":"2s1U","./sq":"V0td","./sq.js":"V0td","./sr":"f4W3","./sr-cyrl":"c1x4","./sr-cyrl.js":"c1x4","./sr.js":"f4W3","./ss":"7Q8x","./ss.js":"7Q8x","./sv":"Fpqq","./sv.js":"Fpqq","./sw":"DSXN","./sw.js":"DSXN","./ta":"+7/x","./ta.js":"+7/x","./te":"Nlnz","./te.js":"Nlnz","./tet":"gUgh","./tet.js":"gUgh","./tg":"5SNd","./tg.js":"5SNd","./th":"XzD+","./th.js":"XzD+","./tl-ph":"3LKG","./tl-ph.js":"3LKG","./tlh":"m7yE","./tlh.js":"m7yE","./tr":"k+5o","./tr.js":"k+5o","./tzl":"iNtv","./tzl.js":"iNtv","./tzm":"FRPF","./tzm-latn":"krPU","./tzm-latn.js":"krPU","./tzm.js":"FRPF","./ug-cn":"To0v","./ug-cn.js":"To0v","./uk":"ntHu","./uk.js":"ntHu","./ur":"uSe8","./ur.js":"uSe8","./uz":"XU1s","./uz-latn":"/bsm","./uz-latn.js":"/bsm","./uz.js":"XU1s","./vi":"0X8Q","./vi.js":"0X8Q","./x-pseudo":"e/KL","./x-pseudo.js":"e/KL","./yo":"YXlc","./yo.js":"YXlc","./zh-cn":"Vz2w","./zh-cn.js":"Vz2w","./zh-hk":"ZUyn","./zh-hk.js":"ZUyn","./zh-tw":"BbgG","./zh-tw.js":"BbgG"};function a(t){return o(n(t))}function n(t){var e=r[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}a.keys=function(){return Object.keys(r)},a.resolve=n,t.exports=a,a.id="uslO"},ux0l:function(t,e){},yGYl:function(t,e){},zWhM:function(t,e){},zj2Q:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.1818431a48bac3a56bf1.js.map